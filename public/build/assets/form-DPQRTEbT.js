import{r as E,u as G,j as e}from"./app-nYBTD1fo.js";import{F as L,a as i,b as l,c as n,d as c,e as x}from"./form-B2JPCxtq.js";import{z as t,t as P}from"./index-C4FlvXrp.js";import{B}from"./button-CA57fXNi.js";import{u as O,b as U}from"./index.esm-CzPujvt0.js";import{T as Y}from"./textarea-DW1UyNdV.js";import{S as _}from"./scroll-area-B3JJXvHI.js";import{S as h,a as j,b as m,c as u,d as o}from"./select-BuyTLcdg.js";import{I as g}from"./input-CIuB1FEo.js";import{a as f}from"./axiosInstance-DMOvDrDW.js";import{R as C,a as p,C as D}from"./api-BVbhmU0-.js";import{M as k}from"./MultiSelect-DoGaWrOq.js";import{a as z}from"./api-BySVmGlY.js";import"./app-wnGHkkFm.js";import"./index-BSuWIByC.js";import"./react-icons.esm-BAorqhyx.js";import"./index-DNwV2EHT.js";import"./Combination-BAhh-Owy.js";import"./index-DH1bLLJk.js";import"./index-DeE_HkxL.js";import"./index-LyRivJHJ.js";var W=(d=>(d[d.create=0]="create",d[d.edit=1]="edit",d[d.update=2]="update",d))(W||{});function pe({onSuccess:d,type:y=0,id:$,listCurrency:N,listAllowanceCategory:b,listGrade:w,listMaterial:H,listMaterialGroup:V}){var I=t.object({code:t.string().min(1,"Code is required"),name:t.string().min(1,"Name is required"),type:t.string().min(1,"Type is required"),material_number:t.string().min(1,"Material number required"),material_group:t.string().min(1,"Material number required"),currency_id:t.string().min(1,"Currency is required"),formula:t.string().min(1,"Formula is required"),allowance_category_id:t.string().min(1,"Allowance Category is required"),request_value:t.string().min(1,"Required"),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string()}))});const[M,F]=E.useState([]);let S={code:"",name:"",type:"",currency_id:"",formula:"",allowance_category_id:"",request_value:"unlimited",grade_option:"all",grade_all_price:"0",grades:[]};const a=O({resolver:P(I),defaultValues:S}),{fields:A}=U({control:a.control,name:"grades"}),{showToast:v}=G(),q=async s=>{console.log(s);try{const r=await f.post(D,s);v("success","success"),d==null||d(!0)}catch{d==null||d(!1),v("Please Check the input","error")}};async function T(s){try{let r=await f.get(z(s));a.setValue("material_group",s),console.log(r),F(r.data.data),console.log("response",r.data)}catch(r){console.log(r)}}return e.jsx(_,{className:"h-[600px] w-full",children:e.jsx(L,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(q),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(i,{control:a.control,disabled:y==1,name:"code",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(g,{type:"text",placeholder:"Insert code",...s,value:s.value||"",onChange:r=>s.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(g,{type:"text",...s,value:s.value||"",onChange:r=>s.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"type",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(h,{onValueChange:r=>s.onChange(r),value:s.value,children:[e.jsx(j,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select type"})}),e.jsxs(u,{children:[e.jsx(o,{value:"daily",children:"DAILY"},"DAILY"),e.jsx(o,{value:"total",children:"Total"},"TOTAL")]})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"material_group",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(h,{onValueChange:r=>{T(r)},value:s.value,children:[e.jsx(j,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select Material Number"})}),e.jsx(u,{children:V.map(r=>e.jsx(o,{value:r,children:r},r))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"material_number",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(h,{onValueChange:r=>s.onChange(r),value:s.value,children:[e.jsx(j,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select Material Number"})}),e.jsx(u,{children:M.map(r=>e.jsx(o,{value:r.material_number,children:r.material_number},r.material_number))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"currency_id",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(h,{onValueChange:r=>s.onChange(r),value:s.value,children:[e.jsx(j,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select Currency"})}),e.jsx(u,{children:N.map(r=>e.jsxs(o,{value:r.code,children:[r.name," ",r.code]},r.code))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Allowance Category"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"allowance_category_id",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(h,{onValueChange:r=>s.onChange(r),value:s.value,children:[e.jsx(j,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select Allowance Category"})}),e.jsx(u,{children:b.map(r=>e.jsx(o,{value:r.id.toString(),children:r.name},r.id))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purpose Type"}),e.jsx("td",{children:e.jsx(_,{className:"h-[250px] border rounded-lg p-6 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Formula"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"formula",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(Y,{placeholder:"Insert formula",...s})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(i,{control:a.control,name:"grade_option",render:({field:s})=>e.jsx(l,{children:e.jsx(n,{children:e.jsxs(C,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(p,{value:"all"})}),e.jsx(x,{className:"text-xs",children:"All"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(p,{value:"grade"})}),e.jsx(x,{className:"text-xs",children:"Grade"})]})]})})})}),a.getValues("grade_option")=="all"?e.jsx("div",{children:e.jsx(i,{control:a.control,name:"grade_all_price",render:({field:s})=>e.jsx(l,{children:e.jsx(n,{children:e.jsx(g,{...s})})})})}):e.jsx("div",{children:e.jsx(k,{label:"grade",id:"id",options:w,value:a.getValues("grades"),onSelect:s=>{a.setValue("grades",s.map(r=>({id:r.id,grade:r.grade,price:0})))}})}),a.getValues("grade_option")=="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:A.map((s,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Grade ",s.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(i,{control:a.control,name:`grades.${r}.plafon`,render:({field:R})=>e.jsx(l,{children:e.jsx(n,{children:e.jsx(g,{...R})})})})})})]}))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request Value"}),e.jsx("td",{children:e.jsx(i,{control:a.control,name:"request_value",render:({field:s})=>e.jsx(l,{children:e.jsx(n,{children:e.jsxs(C,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(p,{value:"unlimited"})}),e.jsx(x,{className:"text-xs",children:"Unlimited"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(p,{value:"up to max value"})}),e.jsx(x,{className:"text-xs",children:"Up To Max Value"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(p,{value:"fixed value"})}),e.jsx(x,{className:"text-xs",children:"Fixed Value"})]})]})})})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(B,{type:"submit",children:"Save"})})]})})})}export{W as AllowanceType,pe as default};
