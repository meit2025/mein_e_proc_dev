import{u as E,r as V,j as e}from"./app-fns7tIxo.js";import{d as _,F as c,a as d,b as m,c as p}from"./form-DWBbaDxZ.js";import{B}from"./button-DV-0oZWC.js";import{o as O,s as x,a as P,b as q,n as M,t as D}from"./types-voUu1phk.js";import{u as L}from"./index.esm-CQ92W87T.js";import{S as R}from"./scroll-area-DeJEsnml.js";import{S as f,a as g,b as y,c as w,d as h}from"./select-D2p2qsuM.js";import{I as T}from"./input-fKhJGi6G.js";import{a as j}from"./axiosInstance-D4Pnf9nn.js";import{c as U}from"./api-BG2DVmVj.js";import{F as o}from"./utils-BzAEVh0z.js";import{M as k}from"./MultiSelect-CbkJs_UK.js";import"./app-DGQxOE2s.js";import"./index-bb3Z5sOF.js";import"./index-CRDSUKhN.js";import"./index-VhH87cog.js";import"./index-QERSnn4N.js";import"./createLucideIcon-zy6RN5iN.js";import"./index-D6pQ_aLq.js";import"./index-poipIpKA.js";import"./index-BXg1mer4.js";import"./index-BdQq_4o_.js";import"./index-g7UsOrf2.js";import"./index-B8qm8eD9.js";import"./index-BRORt89Q.js";import"./index-BbpQqGhz.js";import"./index-CMDqOssR.js";import"./index-Ju_IVqdJ.js";import"./checkbox-8E9vnduV.js";function ye({onSuccess:r,type:l=o.create,editUrl:C,detailUrl:v,createUrl:N,id:H,listAllowanceModel:S}){const b=O({code:x().min(1,"Code is required"),name:x().min(1,"Name is required"),all:q().optional(),allowances:P(M()).optional(),attedance_status:x().min(1,"Attedance Status is required"),type:x().min(1,"Type is required")}),F={code:"",name:"",all:!1,allowances:[],attedance_status:"",type:""};async function I(){try{const t=await j.get(v??""),a=t.data.data.purpose,i=t.data.data.allowances;console.log("allowances",i),s.reset({code:a.code,name:a.name,attedance_status:a.attedance_status,type:a.type,allowances:i.map(n=>parseInt(n))})}catch{}}const s=L({resolver:D(b),defaultValues:F}),{showToast:u}=E(),A=async t=>{console.log(t);try{const a=U(t.code);let i=await j.get(a),n=null;if(l===o.create){if(i.data.msg=="already"){u("Code purpose type already used","error");return}n=await j.post(N??"",t)}else n=await j.put(C??"",t);console.log(n,"response"),u("success","success"),r==null||r(!0)}catch{r==null||r(!1),u("Please Check the input","error")}};return V.useEffect(()=>{(l===o.detail||l===o.edit)&&I()},[l]),e.jsx(R,{className:"h-[600px] w-full",children:e.jsx(_,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(A),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(c,{control:s.control,name:"code",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(T,{type:"text",readOnly:l===o.edit,placeholder:"Insert code",...t,value:t.value||"",onChange:a=>t.onChange(a.target.value)})}),e.jsx(p,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(c,{control:s.control,name:"name",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(T,{type:"text",...t,value:t.value||"",onChange:a=>t.onChange(a.target.value)})}),e.jsx(p,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Allowances ",s.getValues("allowances").length]}),e.jsx("td",{children:e.jsx(k,{value:s.getValues("allowances"),id:"id",label:"name",options:S,onSelect:t=>{s.setValue("allowances",t.map(a=>a.id))}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Attendance Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(c,{control:s.control,name:"attedance_status",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(f,{onValueChange:a=>t.onChange(a),value:t.value,children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(y,{placeholder:"Select Attedance status"})}),e.jsx(w,{children:e.jsx(h,{value:"Business Trip",children:"Business Trip (BST)"},"BST")})]})}),e.jsx(p,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(c,{control:s.control,name:"type",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(f,{onValueChange:a=>t.onChange(a),value:t.value,children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(y,{placeholder:"Select Type"})}),e.jsxs(w,{children:[e.jsx(h,{value:"international",children:"INTERNATIONAL"},"international"),e.jsx(h,{value:"domestic",children:"DOMESTIC"},"domestic"),e.jsx(h,{value:"local",children:"LOCAL"},"local")]})]})}),e.jsx(p,{})]})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(B,{type:"submit",children:"Save"})})]})})})}export{ye as default};
