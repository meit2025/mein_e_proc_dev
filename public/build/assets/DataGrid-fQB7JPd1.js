import{j as e,r as n,u as fe,q as ue,a as v,b as we}from"./app-CxTA7Glv.js";import{a as V}from"./axiosInstance-o1uEpFkd.js";import{D as ve,b as ye,c as ke}from"./dialog-CHOOPV_W.js";import{B as F}from"./button-D7nLMexi.js";import{L as Ce}from"./LoadingSpin-DVuFnsmi.js";import{D as Se,a as be,b as $e,c as Ne,d as U,e as W}from"./dropdown-menu-CEhsWDUa.js";import{D as Me}from"./index-Df9ohyhm.js";import{c as J}from"./createLucideIcon-CuqW1WvK.js";import{B as $}from"./Box-B3WzOxVo.js";import{T as De,a as G}from"./Tabs-Bdzb2SpB.js";import{B as Ue}from"./Button-DpIgoO02.js";import{D as Fe}from"./DataGrid-CRf8mr6C.js";const ze=({open:m,onOpenChange:z,onDelete:j,onClose:t,children:B,className:r,isLoading:h,title:d,description:g})=>e.jsx(ve,{open:m,onOpenChange:t,children:e.jsxs(ye,{className:r||"md:max-w-[768px]",children:[g||"Are you sure delete this item?",e.jsxs(ke,{children:[t?e.jsx(F,{variant:"outline",onClick:t,children:"Close"}):null,j?e.jsx(e.Fragment,{children:h?e.jsx(Ce,{}):e.jsx(F,{type:"submit",onClick:j,children:"Delete"})}):null]})]})});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),X=m=>({id:`simple-tab-${m}`,"aria-controls":`simple-tabpanel-${m}`}),Je=({columns:m,buttonCustome:z,onExport:j,url:t,labelFilter:B="Search",onEdit:r,onDelete:h,onDetail:d,onCreate:g,onClone:y,defaultSearch:T,actionType:K,buttonActionCustome:L,deleteConfirmationText:Q,titleConfirmationText:Le,isHistory:Y=!1,role:s})=>{var O,_,q;const[Z,E]=n.useState([]),[ee,A]=n.useState(!1),[l,se]=n.useState({page:0,pageSize:10}),[f,te]=n.useState([]),[u,ae]=n.useState({items:[]}),[I,N]=n.useState(null),[ie,k]=n.useState(!1),[C,ne]=n.useState(0),[re,de]=n.useState(0),[w,le]=n.useState(""),[ce,oe]=n.useState(""),{showToast:M}=fe(),{props:P}=ue(),c=((O=P.auth)==null?void 0:O.permission)||[],S=n.useCallback(async(a,i,b,p,o,D)=>{A(!0);const me=p.length>0?p[0].field:"id",ge=p.length>0?p[0].sort:"desc",je=o.items.map(x=>`${x.field}=${x.operator},${x.value}`).join("&");try{const x=`${T||"?"}page=${a+1}&per_page=${i}&search=${b}&sort_by=${me}&sort_direction=${ge}&approval=${D}&${je}`;oe(x);const H=await V.get(`${t.url}${x}`);E(H.data.data.data),de(H.data.data.total)}catch(x){console.error("Error fetching data:",x)}finally{A(!1)}},[t]);n.useEffect(()=>{S(l.page,l.pageSize,w,f,u,0)},[S,u,l,w,f]);const R=async a=>{var i,b,p;k(!0);try{const o=await V.delete(`${t.deleteUrl}/${a}`);M(((i=o==null?void 0:o.data)==null?void 0:i.message)||"Record deleted successfully","success"),k(!1),N(null),h&&await h(a),S(l.page,l.pageSize,w,f,u,0)}catch(o){if(k(!1),we.isAxiosError(o)){const D=((p=(b=o.response)==null?void 0:b.data)==null?void 0:p.message)||"Failed to delete record";M(D,"error")}else M("An unexpected error occurred","error");k(!1)}},xe=a=>{N(a)},he=r||h||d||t.detailUrl||t.editUrl||t.deleteUrl||L?[{field:"actions",headerName:"Actions",width:150,renderCell:a=>e.jsx(e.Fragment,{children:K==="dropdown"?e.jsxs(Se,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(F,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"..."}),e.jsx(Me,{className:"h-4 w-4"})]})}),e.jsxs($e,{align:"end",children:[e.jsx(Ne,{children:"Actions"}),(r||t.editUrl)&&C===0&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.update)??""))&&e.jsx(U,{onClick:()=>r&&r(a.row.id),children:e.jsxs("span",{className:"flex items-center text-sm space-x-2",children:[e.jsx("span",{children:"Edit"}),e.jsx(Be,{size:14})]})})}),e.jsx(W,{}),(t.deleteUrl||h)&&C===0&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.delete)??""))&&e.jsx(U,{className:"bg-red-400 text-white hover:!bg-red-500 hover:!text-white transition-all duration-300",onClick:()=>xe(a.row.id),children:e.jsxs("span",{className:"flex items-center  text-sm space-x-2",children:[e.jsx("span",{children:"Delete"}),e.jsx(Te,{size:14})]})})}),e.jsx(W,{}),(d||t.detailUrl)&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.detail)??""))&&e.jsx(U,{onClick:()=>{d&&d(a.row.id),t.detailUrl&&(window.location.href=`${t.detailUrl}/${a.row.id}`)},children:"View details"})})]})]}):e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(d||t.detailUrl)&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.detail)??""))&&e.jsx(v,{href:t.detailUrl===""?"#":`${t.detailUrl}/${a.row.id}`,onClick:i=>{d&&(i.preventDefault(),d&&d(a.row.id))},alt:"detail",children:e.jsx("i",{className:" ki-duotone ki-size text-info text-2xl"})})}),(y||t.clone)&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.create)??""))&&e.jsx(v,{href:t.clone===""?"#":`${t.clone}/${a.row.id}`,onClick:i=>{y&&(i.preventDefault(),y&&y(a.row.id))},alt:"detail",children:e.jsx("i",{className:" ki-filled ki-copy text-warning text-2xl"})})}),(r||t.editUrl)&&C===0&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.update)??""))&&e.jsx(v,{href:t.editUrl===""?"#":`${t.editUrl}/${a.row.id}`,onClick:i=>{r&&(i.preventDefault(),r&&r(a.row.id))},alt:"edit",children:e.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})})}),(t.deleteUrl||h)&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.delete)??""))&&e.jsx(v,{href:"",onClick:()=>R(a.row.id),alt:"delete",children:e.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})}),L]})})}]:[],pe=(a,i)=>{ne(i),S(l.page,l.pageSize,w,f,u,i)};return e.jsx($,{children:e.jsx($,{sx:{height:"45rem",width:"100%",overflowX:"auto"},children:e.jsxs($,{sx:{width:"100%"},children:[Y&&((q=(_=P.auth)==null?void 0:_.user)==null?void 0:q.is_approval)&&e.jsx($,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(De,{value:C,onChange:pe,"aria-label":"dynamic tabs example",children:[e.jsx(G,{label:"List",...X(0)},0),e.jsx(G,{label:"Approval",...X(0)},1)]})}),e.jsx("div",{className:"lg:col-span-2 mt-2",children:e.jsx("div",{className:"grid",children:e.jsxs("div",{className:"card card-grid h-full min-w-full",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:e.jsxs("div",{className:"input input-sm max-w-48",children:[e.jsx("i",{className:"ki-filled ki-magnifier"}),e.jsx("input",{placeholder:B,type:"text",value:w,onChange:a=>le(a.target.value),style:{width:"100%",maxWidth:"200px",marginBottom:"10p"}})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(g||t.addUrl)&&e.jsx(e.Fragment,{children:(!s||c.includes((s==null?void 0:s.create)??""))&&e.jsxs(v,{href:t.addUrl??"#",className:"btn btn-success",onClick:a=>{g&&(a.preventDefault(),g())},style:{marginRight:"10px",marginBottom:"10px"},children:[e.jsx("i",{className:"ki-filled ki-additem"}),"Add New"]})}),j&&e.jsx(Ue,{className:"btn",variant:"contained",onClick:()=>j(ce),color:"primary",startIcon:e.jsx("i",{className:"ki-filled ki-folder-down"}),style:{marginBottom:"10px"},children:"Export TXT"}),z]})]}),e.jsxs("div",{className:"card-body",children:[e.jsx(ze,{isLoading:ie,description:Q,open:I!==null,onClose:()=>{N(null)},onDelete:()=>R(I??0)}),e.jsx("div",{"data-datatable":"true","data-datatable-page-size":l.pageSize,children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx(Fe,{rows:Z,columns:[...m,...he],loading:ee,paginationMode:"server",rowCount:re,paginationModel:l,onPaginationModelChange:se,pageSizeOptions:[10,20],sortingMode:"server",sortModel:f,onSortModelChange:a=>te(a),filterMode:"server",filterModel:u,onFilterModelChange:a=>ae(a)})})})]})]})})})]})})})};export{ze as C,Je as D};
