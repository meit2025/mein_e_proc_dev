import{r as g,j as e}from"./app-C8mMVcAG.js";import{z as d,t as T,F as I,b as o,d as c,f as i,g as h,I as w,B as E}from"./index-DHDOsiiN.js";import{d as v}from"./index-CxmqpwI6.js";import{u as A}from"./index.esm-CZ1PGA0n.js";import{S as B,j as y,a as j,b as x,c as m,d as u,e as p,f as D,T as P,g as K,h as O,i as X,C as f}from"./CustomDatePicker-D6ZxR58-.js";/* empty css            */const U=({reimbursement:l,reimburses:b,currencies:S,types:_,periods:N,users:k,csrf_token:C})=>{const[z,F]=g.useState(1);g.useState(b);const R=d.object({remark_group:d.string().nonempty("Remark is required"),requester:d.string().nonempty("Requester is required"),forms:d.array(d.object({rn:d.string(),type:d.string().nonempty("Type is required"),period:d.string().nonempty("Period is required"),remark:d.string().nonempty("Remark is required"),balance:d.number().min(1,"Balance must be at least 1"),receipt_date:d.date(),start_date:d.date(),end_date:d.date(),currency:d.string().nonempty("Currency is required")})),formCount:d.string().nonempty("Currency is required")}),t=A({resolver:T(R),defaultValues:{formCount:"1",remark_group:"",requester:"",forms:Array.from({length:1}).map(()=>({rn:"",type:"",remark:"",period:"",balance:0,receipt_date:new Date,start_date:new Date,end_date:new Date,currency:"IDR"}))}});g.useEffect(()=>{l&&(t.setValue("remark_group",l.remark),t.setValue("requester",l.users.nip),t.setValue("formCount",l.reimburses.length.toString()),t.setValue("forms",l.reimburses.map(a=>({rn:a.rn,type:a.type,remark:a.remark,balance:Number(a.balance),currency:a.currency,period:a.period,receipt_date:new Date(a.receipt_date),start_date:new Date(a.start_date),end_date:new Date(a.end_date)}))))},[l]);const q=a=>{F(a);const n=t.getValues("forms"),r=Array.from({length:a}).map((s,$)=>n[$]||{rn:"",type:"",remark:"",period:"",balance:0,receipt_date:new Date,start_date:new Date,end_date:new Date,currency:"IDR"});t.setValue("forms",r),t.setValue("formCount",a.toString())},V=a=>{l?v.Inertia.put(`/reimburse/${l.id}`,a,{headers:{"X-CSRF-TOKEN":C}}):v.Inertia.post("/reimburse",a,{headers:{"X-CSRF-TOKEN":C}})};return e.jsx(B,{className:"h-[600px] w-full",children:e.jsx(I,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(V),children:[e.jsx("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Reimburse Request No."}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request Status"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:"remark_group",render:({field:a})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(y,{disabled:l!==null,placeholder:"Insert remark",...a})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Employee"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:"requester",render:({field:a})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(j,{disabled:l!==null,onValueChange:n=>a.onChange(n),value:a.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Requester"})}),e.jsx(u,{children:k.map(n=>e.jsxs(p,{value:n.nip,children:[n.name," (",n.nip,")"]},n.id))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Number of Forms"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:"formCount",render:({field:a})=>{var n;return e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(j,{disabled:l!==null,onValueChange:r=>q(r),value:(n=a.value)==null?void 0:n.toString(),children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select number of forms"})}),e.jsx(u,{children:Array.from({length:20},(r,s)=>s+1).map(r=>e.jsx(p,{value:r.toString(),children:r},r))})]})}),e.jsx(h,{})]})}})})]})]})}),e.jsx(D,{className:"my-4"}),Array.from({length:t.watch("formCount")||1}).map((a,n)=>e.jsxs(P,{defaultValue:`form${n+1}`,className:"w-full",children:[e.jsx(K,{className:"grid w-full grid-cols-2",children:e.jsxs(O,{value:`form${n+1}`,children:["Form ",n+1]})}),e.jsxs(X,{value:`form${n+1}`,children:[e.jsx(o,{control:t.control,name:`forms.${n}.rn`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(w,{className:"sr-only",value:r.value,onChange:r.onChange})}),e.jsx(h,{})]})}),e.jsx("div",{children:e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type of Reimbursement"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.type`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(j,{disabled:l!==null,onValueChange:s=>r.onChange(s),value:r.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"-"})}),e.jsx(u,{children:_.map(s=>e.jsxs(p,{value:s.code,children:[s.name," (",s.code,")"]},s.code))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Period Date"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.period`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(j,{disabled:l!==null,onValueChange:s=>r.onChange(s),value:r.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"-"})}),e.jsx(u,{children:N.map(s=>e.jsxs(p,{value:s.code,children:[s.start," - ",s.end," (",s.code,")"]},s.code))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Balance"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.balance`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(w,{disabled:l!==null,type:"number",placeholder:"0.0",...r,onChange:s=>r.onChange(Number(s.target.value)),value:r.value||0})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Start Date"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.start_date`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(f,{disabled:l!==null,initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:s=>r.onChange(s)})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"End Date"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.end_date`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(f,{disabled:l!==null,initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:s=>r.onChange(s)})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Receipt Date"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.receipt_date`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(f,{disabled:l!==null,initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:s=>r.onChange(s)})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.currency`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(j,{disabled:l!==null,onValueChange:s=>r.onChange(s),value:r.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"-"})}),e.jsx(u,{children:S.map(s=>e.jsxs(p,{value:s.code,children:[s.name," (",s.code,")"]},s.code))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(o,{control:t.control,name:`forms.${n}.remark`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(y,{placeholder:"Insert remark",...r})}),e.jsx(h,{})]})})})]})]})})})]})]},n)),e.jsx(D,{className:"my-4"}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(E,{type:"submit",className:"w-32",children:"Save"})})]})})})};export{U as ReimburseForm};
