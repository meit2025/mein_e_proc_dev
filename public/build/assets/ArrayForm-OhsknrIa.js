import{u as ne,r as C,j as t,a as v}from"./app-Cryykuuk.js";import{F as o}from"./formDropdown-8jVuOnnN.js";import{F as x}from"./formInput-DesTntpC.js";import{u as m}from"./getDropdown-BQsGf-3J.js";import{a as ae,c as j}from"./index.esm-C4uPTy3l.js";import{F as oe}from"./formSwitch-BQOHDHP4.js";import{F as me}from"./formTextArea-CCmHVBJj.js";import{columnsItem as le}from"./listModel-DmitMEKA.js";import{B as $}from"./Button-CITneTpC.js";import{B as de}from"./Box-B0x6ucX6.js";import{D as ce}from"./DataGrid-BQEZp7D7.js";import"./app-DQK4SJPx.js";import"./TextField-DoIrE0Am.js";import"./createSvgIcon-B_9770j1.js";import"./DefaultPropsProvider-BntITcnX.js";import"./useSlot-BuBReBQM.js";import"./createSimplePaletteValueFilter-C6c2OVnv.js";import"./useControlled-D-Z0w_AE.js";import"./FormHelperText-C-rWdEae.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./axiosInstance-B2bBfAq6.js";import"./index-CxYns1nG.js";import"./Switch-CdX2UutP.js";import"./SwitchBase-CSUqA7e1.js";import"./Typography-CULotNnS.js";import"./CustomStatus-BphZEa27.js";import"./utils-U6JX5Pki.js";import"./createLucideIcon-JHqb-2qI.js";import"./page-DB73t_G4.js";import"./moment-C5S46NFB.js";import"./index-MCmpABjf.js";import"./ListItemText-CKYV76DO.js";import"./FormControlLabel-DfQJGBrv.js";import"./KeyboardArrowRight-CcEsV2-P.js";const Qe=({dataIndex:s,subAsset:R,FetchDataValue:L,disable:i})=>{const{getValues:d,setValue:r,watch:c}=ae(),{dataDropdown:V,getDropdown:F}=m(),{dataDropdown:k,getDropdown:S}=m(),{dataDropdown:E,getDropdown:T}=m(),{dataDropdown:I,getDropdown:U}=m(),{dataDropdown:Z,getDropdown:G}=m(),{dataDropdown:O,getDropdown:B}=m(),{dataDropdown:P,getDropdown:Q}=m(),{dataDropdown:W,getDropdown:z}=m(),{dataDropdown:K,getDropdown:X}=m();ne();const q=c(`vendors[${s}].units`);console.log("dataArrayItems",q);const u=j({name:"item_account_assignment_categories"}),A=j({name:"document_type"});C.useEffect(()=>{S("",{name:"desc",id:"cost_center",tabel:"master_cost_centers",hiddenZero:!0,isMapping:!0}),F("",{name:"name_one",id:"id",tabel:"master_business_partners",hiddenZero:!0,isMapping:!0}),U("",{name:"material_group_desc",id:"material_group",tabel:"material_groups",hiddenZero:!0,isMapping:!0}),B("",{name:"description",id:"mwszkz",tabel:"pajaks",hiddenZero:!0,isMapping:!0}),Q("",{name:"unit_of_measurement_text",id:"commercial",tabel:"uoms",hiddenZero:!0,isMapping:!0}),z("",{name:"desc",id:"order_number",tabel:"master_orders",hiddenZero:!0,isMapping:!0}),X("",{name:"desc",id:"asset",tabel:"master_assets",where:{groupBy:"asset,desc"},hiddenZero:!0,isMapping:!0})},[]),C.useEffect(()=>{T("",{name:"description",id:"account",tabel:"account_assignment_categories",attribut:A,hiddenZero:!0,isMapping:!0})},[A]);const w=async e=>{G("",{name:"material_description",id:"material_number",tabel:"master_materials",attribut:e,isMapping:!0,hiddenZero:!0,where:{key:"material_group",parameter:e}})},Y=async()=>{const e=d(),a={id:e.item_id!==void 0&&e.item_id!==null&&e.item_id!==""?e.item_id:`random-generated-id-${Math.random().toString(36).substr(2,9)}`,qty:e.item_qty,unit_price:e.item_unit_price,total_amount:e.item_qty*e.item_unit_price,account_assignment_categories:e.item_account_assignment_categories,cost_center:e.item_cost_center,material_group:e.item_material_group,material_number:e.item_material_number,uom:e.item_uom,tax:e.item_tax,short_text:e.item_short_text,order_number:e.item_order_number,asset_number:e.item_asset_number,sub_asset_number:e.item_sub_asset_number};console.log(e.action,a),console.log(e.id,a);const _=d(`vendors[${s}].units`)||[];let p=[];e.action==="edit"?p=_.map((l,h)=>l.id===e.indexEdit?a:l):p=[..._,a],r(`vendors[${s}].units`,p),r("indexEdit",0),r("item_id",null);const b=d("vendors").filter(l=>(l.winner||!1)===!0),g=b.length>0?b[0]:null;if(g!==null){const h=(g.units||[]).reduce((y,N)=>y+N.total_amount,0);r("total_all_amount",h);const f=parseInt(c("cash_advance_purchases.dp"))/100*parseInt(h);r("cash_advance_purchases.nominal",f)}D()},D=()=>{r("indexEdit",""),r("action","create"),r("item_account_assignment_categories",""),r("item_asset_number",""),r("item_cost_center",""),r("item_id",""),r("item_is_cashAdvance",""),r("item_material_group",""),r("item_material_number",""),r("item_order_number",""),r("item_qty",""),r("item_short_text",""),r("item_sub_asset_number",""),r("item_tax",""),r("item_unit_price",""),r("item_uom","")},H=async(e,n)=>{const a=e.id||`random-generated-id-${Math.random().toString(36).substr(2,9)}`;await w(e.material_group),r("indexEdit",a),r("action","edit"),r("item_account_assignment_categories",e.account_assignment_categories??""),r("item_asset_number",e.asset_number??""),r("item_cost_center",e.cost_center??""),r("item_id",a),r("item_material_group",e.material_group??""),r("item_material_number",e.material_number??""),r("item_order_number",e.order_number??""),r("item_qty",e.qty??"0"),r("item_short_text",e.short_text??""),r("item_sub_asset_number",e.sub_asset_number??""),r("item_tax",e.tax??""),r("item_unit_price",e.unit_price??"0"),r("item_uom",e.uom??"")},J=async(e,n)=>{const a=`random-generated-id-${Math.random().toString(36).substr(2,9)}`;await w(e.material_group);const _={id:a,qty:e.qty??"0",unit_price:e.unit_price??"0",total_amount:parseInt(e.qty)*parseInt(e.unit_price),account_assignment_categories:e.account_assignment_categories,cost_center:e.cost_center??"",material_group:e.material_group??"",material_number:e.material_number??"",uom:e.uom??"",tax:e.tax??"",short_text:e.short_text??"",order_number:e.order_number??"",asset_number:e.asset_number??"",sub_asset_number:e.sub_asset_number??""},b=[...d(`vendors[${s}].units`)||[],_];r(`vendors[${s}].units`,b);const g=d("vendors").filter(h=>(h.winner||!1)===!0),l=g.length>0?g[0]:null;if(l!==null){const f=(l.units||[]).reduce((N,ie)=>N+ie.total_amount,0);r("total_all_amount",f);const y=parseInt(c("cash_advance_purchases.dp"))/100*parseInt(f);r("cash_advance_purchases.nominal",y)}D()},ee=(e,n)=>{const a=d(`vendors[${s}].units`)||[];console.log("currentItems",a);const _=a.filter((p,b)=>p.id!==e.id);r(`vendors[${s}].units`,_)},M=j({name:"total_vendor"}),te=M>0?M:1,re=e=>{const n=d(`vendors[${s}].units`)||[];r(`vendors[${e}].units`,n)},se=[{field:"actions",headerName:"Actions",width:150,renderCell:e=>t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[t.jsx(v,{type:"button",onClick:n=>{n.preventDefault(),J(e.row)},href:"#",children:t.jsx("i",{className:"ki-filled ki-copy text-warning text-2xl"})}),t.jsx(v,{type:"button",onClick:n=>{n.preventDefault(),H(e.row)},href:"#",children:t.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})}),t.jsx(v,{type:"button",onClick:n=>{n.preventDefault(),ee(e.row)},href:"#",children:t.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})]})}];return t.jsxs("div",{children:[t.jsx(o,{options:[{label:"Existing",value:"existing"},{label:"New",value:"new"}],fieldLabel:"Select Type Vendor",fieldName:`vendors[${s}].type_vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:i}),c(`vendors[${s}].type_vendor`)==="existing"&&t.jsxs(t.Fragment,{children:[t.jsx(o,{options:V,fieldLabel:"Select Vendor",fieldName:`vendors[${s}].vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:i}),t.jsx(oe,{fieldLabel:"Propose Vendor",fieldName:`vendors[${s}].winner`,isRequired:!1,disabled:i})]}),c(`vendors[${s}].winner`)&&t.jsx(x,{fieldLabel:"Number Quotation",fieldName:`vendors[${s}].quotation`,isRequired:!1,type:"text",placeholder:"Number Quotation",disabled:i}),c(`vendors[${s}].type_vendor`)==="new"&&t.jsx(t.Fragment,{children:t.jsx(x,{fieldLabel:"Vendor Name",fieldName:`vendors[${s}].vendor_name_text`,isRequired:!1,type:"text",placeholder:"Enter your vendor",disabled:i})}),!i&&t.jsxs("div",{className:"card mt-2",children:[t.jsx("div",{className:"card-header",children:t.jsx("p",{children:"item"})}),t.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[t.jsx(x,{fieldLabel:"Qty",fieldName:"item_qty",isRequired:!1,type:"number",placeholder:"Enter your qty",disabled:i}),t.jsx(x,{fieldLabel:"Unit Price",fieldName:"item_unit_price",isRequired:!1,disabled:i,type:"number",placeholder:"Unit Price"}),t.jsx(o,{options:E,fieldLabel:"Account Assignment",fieldName:"item_account_assignment_categories",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Account Assignment",classNames:"mt-2"}),(u==="K"||u==="V"||u==="W"||u==="Y")&&t.jsx(o,{options:k,fieldLabel:"Cost Center",fieldName:"item_cost_center",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Cost Center",classNames:"mt-2"}),t.jsx(o,{options:I,fieldLabel:"Material Group",fieldName:"item_material_group",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Material Group",classNames:"mt-2",onChangeOutside:async(e,n)=>{await w(e)}}),t.jsx(o,{options:Z,fieldLabel:"Material Number",fieldName:"item_material_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Material Number",classNames:"mt-2"}),t.jsx(o,{options:P,fieldLabel:"Uom",fieldName:"item_uom",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Purchase requisition unit of measure",classNames:"mt-2"}),t.jsx(o,{options:O,fieldLabel:"Tax On Sales",fieldName:"item_tax",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Tax on sales",classNames:"mt-2"}),t.jsx(me,{fieldLabel:"Short Text",fieldName:"item_short_text",isRequired:!1,disabled:i,maxLength:40,classNames:"mt-4",style:{width:"56.5rem"}}),u==="F"&&t.jsx(o,{options:W,fieldLabel:"Order Number",fieldName:"item_order_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Order Number",classNames:"mt-2"}),u==="A"&&t.jsxs(t.Fragment,{children:[t.jsx(o,{options:K,fieldLabel:"Main Asset Number",fieldName:"item_asset_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Main Asset",classNames:"mt-2",onChangeOutside:(e,n)=>{L(e,s)}}),t.jsx(o,{options:R[s],fieldLabel:"Sub Asset",fieldName:"item_sub_asset_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Sub Asset Number",classNames:"mt-2"})]})]}),t.jsx("div",{className:"card-footer",children:t.jsx($,{type:"button",variant:"contained",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await Y(),children:"Add Item"})})]}),t.jsx(de,{sx:{width:"100%",overflowX:"auto",marginTop:"1rem"},children:t.jsx("div",{className:"lg:col-span-2",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"card card-grid h-full min-w-full",children:t.jsx("div",{className:"card-body",children:t.jsx("div",{"data-datatable":"true",children:t.jsx("div",{className:"scrollable-x-auto",children:t.jsx(ce,{columns:[...i?[]:se,...le],rows:q,hideFooterPagination:!0})})})})})})})}),Array.from({length:te},(e,n)=>t.jsx(t.Fragment,{children:n!==s&&t.jsxs($,{type:"button",variant:"contained",style:{marginTop:"1rem",marginRight:"1rem"},className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await re(n),children:["Copy To Vendor ",n+1]},n)}))]})};export{Qe as default};
