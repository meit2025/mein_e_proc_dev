import{q as x,r,j as a}from"./app-D8_ugKZr.js";import{a as w}from"./axiosInstance-BOcwyyW0.js";import{L as M}from"./Loading-DL9d3Z-w.js";import{F as _}from"./FormMapping-C4XDnRW1.js";import{F as k}from"./formTextArea-BGlfdpaS.js";import{u as q}from"./index.esm-ePfZJIWt.js";import{D as B}from"./detailApproval-G4ptyMit.js";import{h as D}from"./moment-C5S46NFB.js";import{B as h}from"./Button-1wv37nkl.js";import{M as I}from"./TextField-dH5uYu21.js";import{B as Y}from"./Box-BIAOulpk.js";const E={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",pt:2,px:4,pb:3},U=({id:l,children:j,type:p,status_id:m})=>{x();const{auth:i}=x().props,e=q({mode:"onChange",reValidateMode:"onChange"}),[g,d]=r.useState(!1),[b,y]=r.useState(!1),[V,u]=r.useState(!1),c=r.useCallback(async()=>{var n;d(!0);try{const s=(await w.get("/api/approval/route/getApproval?id="+l+"&type="+p)).data;e.reset(s.data.data);const L=(s.data??[]).map(t=>{var v;return((v=t.user.divisions)==null?void 0:v.name)||null}),F=(s.data??[]).map(t=>t.user.name),o=(s.data??[]).find(t=>t.is_status===!1);m!==4&&(o==null?void 0:o.user_id)===((n=i==null?void 0:i.user)==null?void 0:n.id)&&y(!0);const R=(s.data??[]).map(t=>({status:t.status,name:t.user.name,dateApproved:D(t.updated_at).format("YYYY-MM-DD")}));e.setValue("approvalFromStatusRoute",R),e.setValue("approvalRequest",L),e.setValue("approvalFrom",F),e.setValue("approvalId",o==null?void 0:o.id),e.setValue("function_name",p.toLowerCase()),e.setValue("id",l)}catch{d(!1)}finally{d(!1)}},[e,l,p,m]);r.useEffect(()=>{c()},[c]);const C=()=>{u(!1),e.setValue("note",""),e.setValue("id_approval",""),e.setValue("status",""),e.setValue("type","")},f=n=>{u(!0),e.setValue("status",n)};return a.jsxs(a.Fragment,{children:[a.jsx(M,{isLoading:g}),a.jsxs("div",{className:"card card-grid h-full min-w-full p-4",children:[b&&a.jsx("div",{className:"card-header",children:a.jsxs("div",{children:[a.jsx(h,{variant:"contained",onClick:()=>f("Approved"),color:"primary",type:"button",children:"Approval"}),a.jsx(h,{onClick:()=>f("Rejected"),style:{marginLeft:"1rem"},variant:"contained",color:"error",type:"button",children:"Rejectd"})]})}),j,a.jsx(B,{methods:e}),a.jsx(I,{open:V,onClose:C,"aria-labelledby":"parent-modal-title","aria-describedby":"parent-modal-description",children:a.jsx(Y,{sx:{...E,width:900},children:a.jsx(_,{isCustom:!0,formCustom:a.jsx(a.Fragment,{children:a.jsx(k,{fieldLabel:"note",fieldName:"note",isRequired:!0,requiredMessage:"",rows:20,style:{width:"100%"}})}),methods:e,url:"api/approval/approval_or_rejceted"})})})]})]})};export{U as L};
