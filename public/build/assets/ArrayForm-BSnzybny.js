import{u as ae,r as $,j as t,a as q}from"./app-DC1eTvcV.js";import{F as o}from"./formDropdown-svwW_aPv.js";import{F as N}from"./formInput-IFrMu8Ko.js";import{u as d}from"./getDropdown-D2ncukU5.js";import{a as oe,c as A}from"./index.esm-DbOL0ucH.js";import{F as me}from"./formSwitch-DtNuRRp-.js";import{F as le}from"./formTextArea-BUwpLT78.js";import{columnsItem as de}from"./listModel-fEIU11lH.js";import{B as R}from"./Button-MR2jfyYQ.js";import{B as ce}from"./Box-B9ytsqvT.js";import{D as ue}from"./DataGrid-CwihmGNS.js";import"./TextField-yGsIo_a7.js";import"./createSvgIcon-C5nJej1B.js";import"./DefaultPropsProvider-C_hsECaF.js";import"./useSlot-CBGyxtNl.js";import"./createSimplePaletteValueFilter-CNX6bbgJ.js";import"./useControlled-BMa1ovqm.js";import"./FormHelperText-BCXrO_py.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./axiosInstance-BWnXhIOE.js";import"./index-Lo2pji3U.js";import"./Switch-C6QUM_J0.js";import"./SwitchBase-B5RJMf22.js";import"./Typography-D6HRn7TI.js";import"./CustomStatus-C5OX7ecd.js";import"./utils-BRz3so7u.js";import"./createLucideIcon-1ao7Abhy.js";import"./page-DB73t_G4.js";import"./moment-C5S46NFB.js";import"./index-uKjbCf6-.js";import"./ListItemText-CHi0rePv.js";import"./FormControlLabel-FNpYxDcA.js";import"./KeyboardArrowRight-CL_kPq0y.js";const Qe=({dataIndex:s,subAsset:L,FetchDataValue:V,disable:i})=>{const{getValues:u,setValue:r,watch:_}=oe(),{dataDropdown:F,getDropdown:k}=d(),{dataDropdown:S,getDropdown:I}=d(),{dataDropdown:E,getDropdown:T}=d(),{dataDropdown:Z,getDropdown:U}=d(),{dataDropdown:G,getDropdown:O}=d(),{dataDropdown:B,getDropdown:P}=d(),{dataDropdown:Q,getDropdown:W}=d(),{dataDropdown:z,getDropdown:K}=d(),{dataDropdown:X,getDropdown:Y}=d();ae();const H=_(`vendors[${s}].units`),p=A({name:"item_account_assignment_categories"}),D=A({name:"document_type"});$.useEffect(()=>{I("",{name:"desc",id:"cost_center",tabel:"master_cost_centers",hiddenZero:!0,isMapping:!0}),k("",{name:"name_one",id:"id",tabel:"master_business_partners",hiddenZero:!0,isMapping:!0}),U("",{name:"material_group_desc",id:"material_group",tabel:"material_groups",hiddenZero:!0,isMapping:!0}),P("",{name:"description",id:"mwszkz",tabel:"pajaks",hiddenZero:!0,isMapping:!0}),W("",{name:"unit_of_measurement_text",id:"commercial",tabel:"uoms",hiddenZero:!0,isMapping:!0}),K("",{name:"desc",id:"order_number",tabel:"master_orders",hiddenZero:!0,isMapping:!0}),Y("",{name:"desc",id:"asset",tabel:"master_assets",where:{groupBy:"asset,desc"},hiddenZero:!0,isMapping:!0})},[]),$.useEffect(()=>{T("",{name:"description",id:"account",tabel:"account_assignment_categories",attribut:D,hiddenZero:!0,isMapping:!0})},[D]);const v=async e=>{O("",{name:"material_description",id:"material_number",tabel:"master_materials",attribut:e,isMapping:!0,hiddenZero:!0,where:{key:"material_group",parameter:e}})},J=async()=>{const e=u(),a={id:e.item_id!==void 0&&e.item_id!==null&&e.item_id!==""?e.item_id:`random-generated-id-${Math.random().toString(36).substr(2,9)}`,qty:e.item_qty,unit_price:e.item_unit_price,total_amount:e.item_qty*e.item_unit_price,account_assignment_categories:e.item_account_assignment_categories,cost_center:e.item_cost_center,material_group:e.item_material_group,material_number:e.item_material_number,uom:e.item_uom,tax:e.item_tax,short_text:e.item_short_text,order_number:e.item_order_number,asset_number:e.item_asset_number,sub_asset_number:e.item_sub_asset_number};console.log(e.action,a),console.log(e.id,a);const h=u(`vendors[${s}].units`)||[];let b=[];e.action==="edit"?b=h.map((m,c)=>m.id===e.indexEdit?a:m):b=[...h,a],r(`vendors[${s}].units`,b),r("indexEdit",0),r("item_id",null);const f=u("vendors").filter(m=>(m.winner||!1)===!0),x=f.length>0?f[0]:null;if(x!==null){const m=x.units||[],c=m.reduce((g,l)=>g+parseInt(l.total_amount),0);r("total_all_amount",c);const w=m.reduce((g,l)=>l.unit_price>g?parseInt(l.unit_price):g,0);r("amount_max",w);const j=parseInt(_("cash_advance_purchases.dp"))/100*parseInt(c);r("cash_advance_purchases.nominal",j)}M()},M=()=>{r("indexEdit",""),r("action","create"),r("item_account_assignment_categories",""),r("item_asset_number",""),r("item_cost_center",""),r("item_id",""),r("item_is_cashAdvance",""),r("item_material_group",""),r("item_material_number",""),r("item_order_number",""),r("item_qty",""),r("item_short_text",""),r("item_sub_asset_number",""),r("item_tax",""),r("item_unit_price",""),r("item_uom","")},ee=async(e,n)=>{const a=e.id||`random-generated-id-${Math.random().toString(36).substr(2,9)}`;await v(e.material_group),r("indexEdit",a),r("action","edit"),r("item_account_assignment_categories",e.account_assignment_categories??""),r("item_asset_number",e.asset_number??""),r("item_cost_center",e.cost_center??""),r("item_id",a),r("item_material_group",e.material_group??""),r("item_material_number",e.material_number??""),r("item_order_number",e.order_number??""),r("item_qty",e.qty??"0"),r("item_short_text",e.short_text??""),r("item_sub_asset_number",e.sub_asset_number??""),r("item_tax",e.tax??""),r("item_unit_price",e.unit_price??"0"),r("item_uom",e.uom??"")},te=async(e,n)=>{const a=`random-generated-id-${Math.random().toString(36).substr(2,9)}`;await v(e.material_group);const h={id:a,qty:e.qty??"0",unit_price:e.unit_price??"0",total_amount:parseInt(e.qty)*parseInt(e.unit_price),account_assignment_categories:e.account_assignment_categories,cost_center:e.cost_center??"",material_group:e.material_group??"",material_number:e.material_number??"",uom:e.uom??"",tax:e.tax??"",short_text:e.short_text??"",order_number:e.order_number??"",asset_number:e.asset_number??"",sub_asset_number:e.sub_asset_number??""},f=[...u(`vendors[${s}].units`)||[],h];r(`vendors[${s}].units`,f);const x=u("vendors").filter(c=>(c.winner||!1)===!0),m=x.length>0?x[0]:null;if(m!==null){const c=m.units||[],w=c.reduce((l,y)=>l+parseInt(y.total_amount),0);r("total_all_amount",w);const j=c.reduce((l,y)=>y.unit_price>l?parseInt(y.unit_price):l,0);r("amount_max",j);const g=parseInt(_("cash_advance_purchases.dp"))/100*parseInt(w);r("cash_advance_purchases.nominal",g)}M()},re=(e,n)=>{const a=u(`vendors[${s}].units`)||[];console.log("currentItems",a);const h=a.filter((b,f)=>b.id!==e.id);r(`vendors[${s}].units`,h)},C=A({name:"total_vendor"}),se=C>0?C:1,ie=e=>{const n=u(`vendors[${s}].units`)||[];r(`vendors[${e}].units`,n)},ne=[{field:"actions",headerName:"Actions",width:150,renderCell:e=>t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[t.jsx(q,{type:"button",onClick:n=>{n.preventDefault(),te(e.row)},href:"#",children:t.jsx("i",{className:"ki-filled ki-copy text-warning text-2xl"})}),t.jsx(q,{type:"button",onClick:n=>{n.preventDefault(),ee(e.row)},href:"#",children:t.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})}),t.jsx(q,{type:"button",onClick:n=>{n.preventDefault(),re(e.row)},href:"#",children:t.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})]})}];return t.jsxs("div",{children:[t.jsx(o,{options:[{label:"Existing",value:"existing"},{label:"New",value:"new"}],fieldLabel:"Select Type Vendor",fieldName:`vendors[${s}].type_vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:i}),_(`vendors[${s}].type_vendor`)==="existing"&&t.jsxs(t.Fragment,{children:[t.jsx(o,{options:F,fieldLabel:"Select Vendor",fieldName:`vendors[${s}].vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:i}),t.jsx(me,{fieldLabel:"Propose Vendor",fieldName:`vendors[${s}].winner`,isRequired:!1,disabled:i})]}),_(`vendors[${s}].winner`)&&t.jsx(N,{fieldLabel:"Number Quotation",fieldName:`vendors[${s}].quotation`,isRequired:!1,type:"text",placeholder:"Number Quotation",disabled:i}),_(`vendors[${s}].type_vendor`)==="new"&&t.jsx(t.Fragment,{children:t.jsx(N,{fieldLabel:"Vendor Name",fieldName:`vendors[${s}].vendor_name_text`,isRequired:!1,type:"text",placeholder:"Enter your vendor",disabled:i})}),!i&&t.jsxs("div",{className:"card mt-2",children:[t.jsx("div",{className:"card-header",children:t.jsx("p",{children:"item"})}),t.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[t.jsx(N,{fieldLabel:"Qty",fieldName:"item_qty",isRequired:!1,type:"number",placeholder:"Enter your qty",disabled:i}),t.jsx(N,{fieldLabel:"Unit Price",fieldName:"item_unit_price",isRequired:!1,disabled:i,type:"number",placeholder:"Unit Price"}),t.jsx(o,{options:E,fieldLabel:"Account Assignment",fieldName:"item_account_assignment_categories",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Account Assignment",classNames:"mt-2"}),(p==="K"||p==="V"||p==="W"||p==="Y")&&t.jsx(o,{options:S,fieldLabel:"Cost Center",fieldName:"item_cost_center",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Cost Center",classNames:"mt-2"}),t.jsx(o,{options:Z,fieldLabel:"Material Group",fieldName:"item_material_group",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Material Group",classNames:"mt-2",onChangeOutside:async(e,n)=>{await v(e)}}),t.jsx(o,{options:G,fieldLabel:"Material Number",fieldName:"item_material_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Material Number",classNames:"mt-2"}),t.jsx(o,{options:Q,fieldLabel:"Uom",fieldName:"item_uom",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Purchase requisition unit of measure",classNames:"mt-2"}),t.jsx(o,{options:B,fieldLabel:"Tax On Sales",fieldName:"item_tax",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Tax on sales",classNames:"mt-2"}),t.jsx(le,{fieldLabel:"Short Text",fieldName:"item_short_text",isRequired:!1,disabled:i,maxLength:40,classNames:"mt-4",style:{width:"56.5rem"}}),p==="F"&&t.jsx(o,{options:z,fieldLabel:"Order Number",fieldName:"item_order_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Order Number",classNames:"mt-2"}),p==="A"&&t.jsxs(t.Fragment,{children:[t.jsx(o,{options:X,fieldLabel:"Main Asset Number",fieldName:"item_asset_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Main Asset",classNames:"mt-2",onChangeOutside:(e,n)=>{V(e,s)}}),t.jsx(o,{options:L[s],fieldLabel:"Sub Asset",fieldName:"item_sub_asset_number",isRequired:!1,disabled:i,style:{width:"56.5rem"},placeholder:"Sub Asset Number",classNames:"mt-2"})]})]}),t.jsx("div",{className:"card-footer",children:t.jsx(R,{type:"button",variant:"contained",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await J(),children:"Add Item"})})]}),t.jsx(ce,{sx:{width:"100%",overflowX:"auto",marginTop:"1rem"},children:t.jsx("div",{className:"lg:col-span-2",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"card card-grid h-full min-w-full",children:t.jsx("div",{className:"card-body",children:t.jsx("div",{"data-datatable":"true",children:t.jsx("div",{className:"scrollable-x-auto",children:t.jsx(ue,{columns:[...i?[]:ne,...de],rows:H,hideFooterPagination:!0})})})})})})})}),Array.from({length:se},(e,n)=>t.jsx(t.Fragment,{children:n!==s&&t.jsxs(R,{type:"button",variant:"contained",style:{marginTop:"1rem",marginRight:"1rem"},className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await ie(n),children:["Copy To Vendor ",n+1]},n)}))]})};export{Qe as default};
