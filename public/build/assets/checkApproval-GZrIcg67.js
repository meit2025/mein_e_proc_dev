import{r as s,u as C,j as o}from"./app-_uGhMHct.js";import{a as D}from"./index.esm-C0ovLjwV.js";import{a as S}from"./axiosInstance-Dig4HwFK.js";import{L as P}from"./Loading-c-PoNlFh.js";import{W as T}from"./WorkflowComponent-rW-nvVQP.js";import{F as h}from"./formDropdown-CGkM8YuE.js";import{u as L}from"./getDropdown-BEDummtx.js";import{B as q}from"./Button-CDqmeXNy.js";import"./app-HlhieNAw.js";import"./createSimplePaletteValueFilter-CnCtS2VL.js";import"./DefaultPropsProvider-zjLyjaZU.js";import"./createLucideIcon-BgjsOFdW.js";import"./TextField-DFOQScZD.js";import"./useSlot-CSjBgY14.js";import"./FormHelperText-BLN89EIo.js";const Y=({isDisabled:E})=>{const{getValues:g,watch:i}=D(),[w,e]=s.useState(!1),[y,n]=s.useState(!1),[t,x]=s.useState({approvalRequest:[],approvalFrom:[],acknowledgeFrom:[]}),{dataDropdown:b,getDropdown:k}=L(),{showToast:r}=C(),A=i("document_type"),F=i("metode_approval"),j=async()=>{var m,d,u,c,v,_;try{const a=g();if(console.log(a),a.document_type===null||a.document_type===void 0){e(!1),r("Please input Document Type","error");return}if(a.purchasing_groups===null||a.purchasing_groups===void 0){e(!1),r("Please input purchasing group","error");return}if(a.total_all_amount===null||a.total_all_amount===void 0){e(!1),r("Please input Item","error");return}if(a.user_id===null||a.user_id===void 0){e(!1),r("Please input Item","error");return}if(a.document_type==="ZENT"){if(a.metode_approval===null||a.metode_approval===void 0){e(!1),r("Please select metode approval","error");return}if(a.metode_approval==="chooses_approval"&&(a.chooses_approval_id===null||a.chooses_approval_id===void 0)){e(!1),r("Please select chooses approval","error");return}}const p=await S.get("/check-approval",{params:{document_type_id:a.document_type,purchasing_group_id:a.purchasing_groups,value:a.total_all_amount,user_id:a.user_id,type:"PR",metode_approval:a.metode_approval,chooses_approval_id:a.chooses_approval_id}});if(p.data.status_code===200){const N=(d=(m=p.data)==null?void 0:m.data)==null?void 0:d.approval_route.map(l=>{var f;return((f=l.user.divisions)==null?void 0:f.name)||null}),R=(c=(u=p.data)==null?void 0:u.data)==null?void 0:c.approval_route.map(l=>l.user.name);x({approvalRequest:N,approvalFrom:R,acknowledgeFrom:[]}),n(!0)}e(!1)}catch(a){e(!1),n(!1),r((_=(v=a==null?void 0:a.response)==null?void 0:v.data)==null?void 0:_.message,"error")}};return s.useEffect(()=>{k("",{name:"name",id:"id",tabel:"approval_tracking_number_chooses"})},[]),o.jsx(o.Fragment,{children:o.jsxs("div",{className:"card card-grid h-full min-w-full p-4",children:[o.jsx(P,{isLoading:w}),o.jsxs("div",{className:"card-body",children:[o.jsx("div",{className:"flex justify-start mt-4 mb-2",children:o.jsx(q,{onClick:async()=>await j(),variant:"contained",color:"primary",type:"button",children:"Check Approval"})}),A==="ZENT"&&o.jsxs(o.Fragment,{children:[o.jsx(h,{options:[{label:"Approval",value:"approval"},{label:"Chooses Approval Tracking Number",value:"chooses_approval"},{label:"Automatic Approval Tracking Number",value:"automatic_approval_by_purchasing_group"}],fieldLabel:"Metode Approval",fieldName:"metode_approval",disabled:!1,style:{width:"58.5rem"},placeholder:"Metode Approval",classNames:"mt-2"}),F==="chooses_approval"&&o.jsx(h,{options:b,fieldLabel:"Select Chooses approval",fieldName:"chooses_approval_id",isRequired:!0,disabled:!1,style:{width:"58.5rem"},placeholder:"Select Chooses approval",classNames:"mt-2"})]}),y&&o.jsx(T,{workflowApproval:{approvalRequest:t.approvalRequest,approvalFrom:t.approvalFrom,acknowledgeFrom:t.acknowledgeFrom},workflowApprovalStep:t.approvalFrom,workflowApprovalDiagram:t.approvalFrom})]})]})})};export{Y as default};
