import{r as p,u as V,j as e}from"./app-0WUCDbCG.js";import{F as B,a as d,b as n,c as i,d as x,e as f}from"./form-yRrNK-yL.js";import{z as t,t as U}from"./index-BTBbYnJA.js";import{B as $}from"./button-BtfyTBsg.js";import{u as O,b as Y}from"./index.esm-C13e6e9t.js";import{S as z}from"./scroll-area-Vopxfx6P.js";import{S as k,a as q,b as H,c as J,d as b}from"./select-kcweRagK.js";import{I as c}from"./input-DKauqRkq.js";import{a as j}from"./axiosInstance-CHxE3a7S.js";import{F as u}from"./utils-D2P5ZKHk.js";import{M as K}from"./MultiSelect-BDXB2oIs.js";import{R as Q,a as E}from"./radio-group-B8YxbKA9.js";import{L as W}from"./Loading-CBgl4kib.js";import{F as y}from"./formDropdown-DU3kj-hZ.js";import{u as N}from"./getDropdown-BMetmFQ0.js";const m="/api/master/reimburse-type",je=`${m}/`,X=`${m}/create`,ge=o=>`${m}/edit/${o}`,_e=o=>`${m}/update/${o}`,fe=`${m}/delete`;function Z({onSuccess:o,type:h=u.create,listGrades:v,editURL:S,updateURL:w,id:ee}){const M=t.object({code:t.string(),name:t.string().min(1,"Name is required"),is_employee:t.boolean(),limit:t.number(),material_group:t.number().refine(r=>r>0,{message:"Material Group must be chosen"}),material_number:t.number().refine(r=>r>0,{message:"Material Number must be chosen"}),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string()}))}),[R,g]=p.useState(!1);p.useState("");const{dataDropdown:I,getDropdown:F}=N(),{dataDropdown:T,getDropdown:C}=N(),D={code:"",name:"",material_group:0,material_number:0,is_employee:!0,grade_option:"all",grade_all_price:"0",grades:[],limit:0},s=O({resolver:U(M),defaultValues:D});async function L(){try{const a=(await j.get(S||"")).data.data;s.reset({code:a.code,name:a.name,limit:a.limit,is_employee:a.is_employee,material_group:parseInt(a.material_group),material_number:parseInt(a.material_number),grade_option:a.grade_option,grade_all_price:a.grade_all_price,grades:a.grades})}catch{}}const{fields:A}=Y({control:s.control,name:"grades"}),{showToast:_}=V(),G=async r=>{var a;g(!0);try{let l;h===u.edit?l=await j.put(w??"",r):l=await j.post(X??"",r),o&&o(!0),_((a=l==null?void 0:l.data)==null?void 0:a.message,"success")}catch(l){o&&o(!1),_(l==null?void 0:l.message,"error")}g(!1)},P=async r=>{r.length>0&&C(r,{name:"material_number",id:"id",tabel:"master_materials",where:{key:"material_group",parameter:r}})};return p.useEffect(()=>{F("",{name:"material_group",id:"id",tabel:"material_groups"}),h===u.edit&&L()},[]),e.jsxs(z,{className:"h-[600px] w-full",children:[e.jsx(W,{isLoading:R}),e.jsx(B,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(G),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"code",render:({field:r})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(c,{type:"text",placeholder:"Insert code",...r,value:r.value||"",onChange:a=>r.onChange(a.target.value),disabled:h===u.edit})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"name",render:({field:r})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(c,{type:"text",...r,value:r.value||"",onChange:a=>r.onChange(a.target.value)})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"For"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"is_employee",render:({field:r})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs(k,{onValueChange:a=>r.onChange(a==="true"),value:r.value?"true":"false",children:[e.jsx(q,{className:"w-[200px]",children:e.jsx(H,{placeholder:"-"})}),e.jsxs(J,{children:[e.jsx(b,{value:"true",children:"Employee"},"is_employee"),e.jsx(b,{value:"false",children:"Family"},"is_employee")]})]})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Limit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"limit",render:({field:r})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(c,{onChange:a=>r.onChange(Number(a.target.value)),value:r.value})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(d,{control:s.control,name:"grade_option",render:({field:r})=>e.jsx(n,{children:e.jsx(i,{children:e.jsxs(Q,{onValueChange:r.onChange,defaultValue:r.value,className:"flex flex space-x-1",children:[e.jsxs(n,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(i,{children:e.jsx(E,{value:"all"})}),e.jsx(f,{className:"text-xs",children:"All"})]}),e.jsxs(n,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(i,{children:e.jsx(E,{value:"grade"})}),e.jsx(f,{className:"text-xs",children:"Grade"})]})]})})})}),s.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(d,{control:s.control,name:"grade_all_price",render:({field:r})=>e.jsx(n,{children:e.jsx(i,{children:e.jsx(c,{...r})})})})}):e.jsx("div",{children:e.jsx(K,{label:"grade",id:"id",options:v||[],value:s.getValues("grades").map(r=>r.id),onSelect:r=>{s.setValue("grades",r.map(a=>({id:a.id,grade:a.grade,plafon:0})))}})}),s.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:A.map((r,a)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Balance ",r.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(d,{control:s.control,name:`grades.${a}.plafon`,render:({field:l})=>e.jsx(n,{children:e.jsx(i,{children:e.jsx(c,{...l})})})})})})]},a))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(y,{options:I,fieldName:"material_group",isRequired:!0,disabled:!1,placeholder:"Material Group",classNames:"mt-2 w-full",onChangeOutside:async(r,a)=>{await P(a==null?void 0:a.label)},fieldLabel:""})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(y,{fieldLabel:"",options:T,fieldName:"material_number",isRequired:!0,disabled:!1,placeholder:"Material Number",classNames:"mt-2 w-full"})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx($,{type:"submit",children:"Save"})})]})})]})}const be=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));export{fe as D,ge as E,je as L,Z as R,_e as U,be as f};
