import{u as E,r as V,j as e}from"./app-BCScC8Di.js";import{d as _,F as d,a as m,b as p,c as x}from"./form-Cam9A65a.js";import{z as r,t as B}from"./index-BcMIAfQ9.js";import{B as O}from"./button-TmsmRrZe.js";import{u as P}from"./index.esm-BtiQICoB.js";import{S as q}from"./scroll-area-_C9pSwDm.js";import{S as g,a as f,b as w,c as y,d as h}from"./select-BMY7L5NI.js";import{I as C}from"./input-DkYDgcrj.js";import{a as j}from"./axiosInstance-CPzD6_Jy.js";import{c as M}from"./api-BG2DVmVj.js";import{F as i}from"./utils-CJSrc8NF.js";import{M as D}from"./MultiSelect-BqQhkCP0.js";import"./app-DQK4SJPx.js";import"./index-B-Bb6Tyb.js";import"./index-BdI8w-Rc.js";import"./index-DiBZcsvk.js";import"./index-Bb4qSo10.js";import"./createLucideIcon-DTIH1iA8.js";import"./index-ACeKOifX.js";import"./index-D24i7pJT.js";import"./index-BeQjyrok.js";import"./index-BdQq_4o_.js";import"./index-DIUDyZhg.js";import"./index-CRcGjgu3.js";import"./Combination-Bj0hgcB8.js";import"./index-CdVUL8Xy.js";import"./index-B6BPiGtv.js";import"./index-DLyUjqLd.js";import"./checkbox-CQsdF7Wg.js";function je({onSuccess:n,type:l=i.create,editUrl:v,detailUrl:T,createUrl:N,id:L,listAllowanceModel:S}){const b=r.object({code:r.string().min(1,"Code is required"),name:r.string().min(1,"Name is required"),all:r.boolean().optional(),allowances:r.array(r.number()).optional(),attedance_status:r.string().min(1,"Attedance Status is required"),type:r.string().min(1,"Type is required")}),F={code:"",name:"",all:!1,allowances:[],attedance_status:"",type:""};async function I(){try{const t=await j.get(T??""),s=t.data.data.purpose,c=t.data.data.allowances;console.log("allowances",c),a.reset({code:s.code,name:s.name,attedance_status:s.attedance_status,type:s.type,allowances:c.map(o=>parseInt(o))})}catch{}}const a=P({resolver:B(b),defaultValues:F}),{showToast:u}=E(),A=async t=>{console.log(t);try{const s=M(t.code);let c=await j.get(s),o=null;if(l===i.create){if(c.data.msg=="already"){u("Code purpose type already used","error");return}o=await j.post(N??"",t)}else o=await j.put(v??"",t);console.log(o,"response"),u("success","success"),n==null||n(!0)}catch{n==null||n(!1),u("Please Check the input","error")}};return V.useEffect(()=>{(l===i.detail||l===i.edit)&&I()},[l]),e.jsx(q,{className:"h-[600px] w-full",children:e.jsx(_,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(A),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:a.control,name:"code",render:({field:t})=>e.jsxs(m,{children:[e.jsx(p,{children:e.jsx(C,{type:"text",readOnly:l===i.edit,placeholder:"Insert code",...t,value:t.value||"",onChange:s=>t.onChange(s.target.value)})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(d,{control:a.control,name:"name",render:({field:t})=>e.jsxs(m,{children:[e.jsx(p,{children:e.jsx(C,{type:"text",...t,value:t.value||"",onChange:s=>t.onChange(s.target.value)})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Allowances ",a.getValues("allowances").length]}),e.jsx("td",{children:e.jsx(D,{value:a.getValues("allowances"),id:"id",label:"name",options:S,onSelect:t=>{a.setValue("allowances",t.map(s=>s.id))}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Attendance Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:a.control,name:"attedance_status",render:({field:t})=>e.jsxs(m,{children:[e.jsx(p,{children:e.jsxs(g,{onValueChange:s=>t.onChange(s),value:t.value,children:[e.jsx(f,{className:"w-[200px]",children:e.jsx(w,{placeholder:"Select Attedance status"})}),e.jsx(y,{children:e.jsx(h,{value:"Business Trip",children:"Business Trip (BST)"},"BST")})]})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:a.control,name:"type",render:({field:t})=>e.jsxs(m,{children:[e.jsx(p,{children:e.jsxs(g,{onValueChange:s=>t.onChange(s),value:t.value,children:[e.jsx(f,{className:"w-[200px]",children:e.jsx(w,{placeholder:"Select Type"})}),e.jsxs(y,{children:[e.jsx(h,{value:"international",children:"INTERNATIONAL"},"international"),e.jsx(h,{value:"domestic",children:"DOMESTIC"},"domestic"),e.jsx(h,{value:"local",children:"LOCAL"},"local")]})]})}),e.jsx(x,{})]})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(O,{type:"submit",children:"Save"})})]})})})}export{je as default};
