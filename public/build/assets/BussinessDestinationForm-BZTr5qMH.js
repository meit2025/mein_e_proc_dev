import{j as e}from"./app-uazH96sZ.js";import{F as j,a as f,b as w,c as x}from"./form-BCpw_St1.js";import{B as R}from"./button-D5ZC0bM5.js";import{b}from"./index.esm-BFvOqgYu.js";/* empty css              */import{c as G}from"./tabs-BlK0Fn_B.js";import{C as g}from"./CustomDatePicker-DhknPBzR.js";import{h as p}from"./moment-C5S46NFB.js";import{F as m}from"./formDropdown-CW-Ih2la.js";import{DetailAttedances as T}from"./DetailAttedances-DxEgMth8.js";import{DetailAllowance as L}from"./DetailAllowance-uyzI3xAe.js";import{ResultTotalItem as P}from"./ResultTotalItem-eOaJVxR8.js";import"./app-DQK4SJPx.js";import"./index-CVpW_ph2.js";import"./utils-BXl6L9IK.js";import"./index-YaWFnI5w.js";import"./index-Bb4qSo10.js";import"./index-D6zj9FOA.js";import"./index-DJtdinFK.js";import"./index-4eAr56xi.js";import"./index-DD_-Uh-R.js";import"./index-D4hFLPry.js";import"./index-BxwbJntK.js";import"./index-BHlgo8c9.js";import"./popover-C_2LfEYY.js";import"./Combination-DN8wO7bU.js";import"./createLucideIcon-CcEwBXVu.js";import"./TextField-DPX0tC6x.js";import"./createSvgIcon-BW3sl-3j.js";import"./DefaultPropsProvider-BmxjjS7E.js";import"./useSlot-DXsyv3UX.js";import"./createSimplePaletteValueFilter-BWcetgMF.js";import"./useControlled-DpIBSwco.js";import"./FormHelperText-CYn1dXa8.js";import"./input-Yizr7SDn.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-DYI4eGmw.js";function ke({form:a,index:t,destination:i,updateDestination:d,listAllowances:A,setTotalAllowance:F,pajak:H,purchasingGroup:M,dataTax:D,dataPurchasingGroup:$,dataDestination:C,type:l,btEdit:n}){const{fields:N,update:k,append:I,remove:v}=b({control:a.control,name:`destinations.${t}.detail_attedances`}),{fields:u,update:U,append:z,remove:B,replace:S}=b({control:a.control,name:`destinations.${t}.allowances`});function q(){let r=p(i.business_trip_start_date).startOf("day");const o=p(i.business_trip_end_date).startOf("day");for(v(),B();r.isBefore(o)||r.isSame(o);){const s={date:r.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};I(s),r=r.add(1,"days")}function y(s){let c=p(i.business_trip_start_date).startOf("day");const _=p(i.business_trip_end_date).startOf("day"),h=[];for(;c.isBefore(_)||c.isSame(_);)h.push({date:c.toDate(),request_price:s}),c=c.add(1,"days");return h}const O=A.map(s=>({name:s.name,code:s.code,default_price:parseInt(s.grade_price),type:s.type,subtotal:parseInt(s.grade_price),currency:s.currency_id,request_value:s.request_value,detail:s.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(s.grade_price)}]:y(s.grade_price)}));S(O)}return e.jsxs(G,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",i.destination]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:C,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.destination`):!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,destination:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:D,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.pajak_id`):!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,pajak_id:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:$,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.purchasing_group_id`):!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,purchasing_group_id:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(j,{control:a.control,name:`destinations.${t}.business_trip_start_date`,render:({field:r})=>e.jsxs(f,{children:[e.jsx(w,{children:e.jsx(g,{initialDate:i.business_trip_start_date,onDateChange:o=>{d(t,{...i,business_trip_start_date:o})},disabled:l==n?!!a.watch(`destinations.${t}.business_trip_start_date`):!1})}),e.jsx(x,{})]})}),e.jsx("span",{children:"To"}),e.jsx(j,{control:a.control,name:`destinations.${t}.business_trip_end_date`,render:({field:r})=>e.jsxs(f,{children:[e.jsx(w,{children:e.jsx(g,{initialDate:i.business_trip_end_date,onDateChange:o=>{d(t,{...i,business_trip_end_date:o})},disabled:l==n?!!a.watch(`destinations.${t}.business_trip_end_date`):!1})}),e.jsx(x,{})]})}),e.jsx(R,{type:"button",className:l==n&&a.watch(`destinations.${t}.destination`)?"hidden":"",onClick:()=>q(),children:"Get Detail"})]})]})]}),e.jsx(T,{detailAttedanceFields:N,form:a,updateAttedanceFields:k,destinationIndex:t,type:l,btEdit:n}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(L,{allowanceField:u,destinationIndex:t,form:a,type:l,btEdit:n})]},t),e.jsx(P,{allowanceField:u,destinationIndex:t,form:a,setTotalAllowance:F})]})}export{ke as BussinessDestinationForm};
