import{u as ne,r as M,j as t,a as y}from"./app-Dd2dlN2u.js";import{F as a}from"./formDropdown-DUeNwkpq.js";import{F as N}from"./formInput-Z0AnUdZo.js";import{u as m}from"./getDropdown-Bjw7Diaj.js";import{a as ae,c as v}from"./index.esm-BFAzSaQL.js";import{F as oe}from"./formSwitch-Chq8hC0F.js";import{F as me}from"./formTextArea-Dss1m5f8.js";import{columnsItem as de}from"./listModel-DUDbwWKj.js";import{B as C}from"./Button-DquElond.js";import{B as le}from"./Box-BvpQML_n.js";import{D as ce}from"./DataGrid-R4TClYLY.js";import"./app-DQK4SJPx.js";import"./TextField-BAkpb4w0.js";import"./createSvgIcon-CA6hYm9j.js";import"./DefaultPropsProvider-veLoW-9k.js";import"./useSlot-CW1kY3I5.js";import"./createSimplePaletteValueFilter-CIy_9DDw.js";import"./useControlled-D4uQCTco.js";import"./FormHelperText-BkWYcPXr.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./axiosInstance-C9H9WqCQ.js";import"./index-DAB5glv1.js";import"./Switch-C1xKc1IX.js";import"./SwitchBase-Bs_VVcuT.js";import"./Typography-Dt7htDL-.js";import"./CustomStatus-BRotexMD.js";import"./utils-CAZq41iY.js";import"./createLucideIcon-Bbfnrd4H.js";import"./page-DB73t_G4.js";import"./moment-C5S46NFB.js";import"./index-Dk43lEcq.js";import"./ListItemText-CdK1CQwt.js";import"./FormControlLabel-DuXygWi8.js";import"./KeyboardArrowRight-DsPFg57z.js";const We=({dataIndex:n,subAsset:R,FetchDataValue:V,disable:s})=>{const{getValues:l,setValue:r,watch:h}=ae(),{dataDropdown:$,getDropdown:L}=m(),{dataDropdown:F,getDropdown:k}=m(),{dataDropdown:S,getDropdown:E}=m(),{dataDropdown:I,getDropdown:T}=m(),{dataDropdown:U,getDropdown:Z}=m(),{dataDropdown:G,getDropdown:O}=m(),{dataDropdown:B,getDropdown:P}=m(),{dataDropdown:W,getDropdown:z}=m(),{dataDropdown:K,getDropdown:Q}=m();ne();const j=h(`vendors[${n}].units`);console.log("dataArrayItems",j);const c=v({name:"item_account_assignment_categories"}),q=v({name:"document_type"});M.useEffect(()=>{k("",{name:"desc",id:"cost_center",tabel:"master_cost_centers",hiddenZero:!0,isMapping:!0}),L("",{name:"name_one",id:"id",tabel:"master_business_partners",hiddenZero:!0,isMapping:!0}),T("",{name:"material_group_desc",id:"material_group",tabel:"material_groups",hiddenZero:!0,isMapping:!0}),O("",{name:"description",id:"mwszkz",tabel:"pajaks",hiddenZero:!0,isMapping:!0}),P("",{name:"unit_of_measurement_text",id:"commercial",tabel:"uoms",hiddenZero:!0,isMapping:!0}),z("",{name:"desc",id:"order_number",tabel:"master_orders",hiddenZero:!0,isMapping:!0}),Q("",{name:"desc",id:"asset",tabel:"master_assets",where:{groupBy:"asset,desc"},hiddenZero:!0,isMapping:!0})},[]),M.useEffect(()=>{E("",{name:"description",id:"account",tabel:"account_assignment_categories",attribut:q,hiddenZero:!0,isMapping:!0})},[q]);const X=async e=>{Z("",{name:"material_description",id:"material_number",tabel:"master_materials",attribut:e,isMapping:!0,hiddenZero:!0,where:{key:"material_group",parameter:e}})},Y=async()=>{const e=l(),o={id:e.item_id!==void 0&&e.item_id!==null&&e.item_id!==""?e.item_id:`random-generated-id-${Math.random().toString(36).substr(2,9)}`,qty:e.item_qty,unit_price:e.item_unit_price,total_amount:e.item_qty*e.item_unit_price,account_assignment_categories:e.item_account_assignment_categories,cost_center:e.item_cost_center,material_group:e.item_material_group,material_number:e.item_material_number,uom:e.item_uom,tax:e.item_tax,short_text:e.item_short_text,order_number:e.item_order_number,asset_number:e.item_asset_number,sub_asset_number:e.item_sub_asset_number},u=l(`vendors[${n}].units`)||[];let _=[];e.action==="edit"?_=u.map((d,p)=>d.id===e.indexEdit?o:d):_=[...u,o],r(`vendors[${n}].units`,_),r("indexEdit",0),r("item_id",null);const b=l("vendors").filter(d=>(d.winner||!1)===!0),g=b.length>0?b[0]:null;if(g!==null){const p=(g.units||[]).reduce((x,w)=>x+w.total_amount,0);r("total_all_amount",p);const f=parseInt(h("cash_advance_purchases.dp"))/100*parseInt(p);r("cash_advance_purchases.nominal",f)}A()},A=()=>{r("indexEdit",""),r("action","create"),r("item_account_assignment_categories",""),r("item_asset_number",""),r("item_cost_center",""),r("item_id",""),r("item_is_cashAdvance",""),r("item_material_group",""),r("item_material_number",""),r("item_order_number",""),r("item_qty",""),r("item_short_text",""),r("item_sub_asset_number",""),r("item_tax",""),r("item_unit_price",""),r("item_uom","")},H=(e,i)=>{const o=`random-generated-id-${Math.random().toString(36).substr(2,9)}`;r("indexEdit",o),r("action","edit"),r("item_account_assignment_categories",e.account_assignment_categories??""),r("item_asset_number",e.asset_number??""),r("item_cost_center",e.cost_center??""),r("item_id",o),r("item_material_group",e.material_group??""),r("item_material_number",e.material_number??""),r("item_order_number",e.order_number??""),r("item_qty",e.qty??"0"),r("item_short_text",e.short_text??""),r("item_sub_asset_number",e.sub_asset_number??""),r("item_tax",e.tax??""),r("item_unit_price",e.unit_price??"0"),r("item_uom",e.uom??"")},J=(e,i)=>{const u={id:`random-generated-id-${Math.random().toString(36).substr(2,9)}`,qty:e.qty??"0",unit_price:e.unit_price??"0",total_amount:parseInt(e.qty)*parseInt(e.unit_price),account_assignment_categories:e.account_assignment_categories,cost_center:e.cost_center??"",material_group:e.material_group??"",material_number:e.material_number??"",uom:e.uom??"",tax:e.tax??"",short_text:e.short_text??"",order_number:e.order_number??"",asset_number:e.cost_center??"",sub_asset_number:e.asset_number??""},b=[...l(`vendors[${n}].units`)||[],u];r(`vendors[${n}].units`,b);const g=l("vendors").filter(p=>(p.winner||!1)===!0),d=g.length>0?g[0]:null;if(d!==null){const f=(d.units||[]).reduce((w,ie)=>w+ie.total_amount,0);r("total_all_amount",f);const x=parseInt(h("cash_advance_purchases.dp"))/100*parseInt(f);r("cash_advance_purchases.nominal",x)}A()},ee=(e,i)=>{const o=l(`vendors[${n}].units`)||[];console.log("currentItems",o);const u=o.filter((_,b)=>_.id!==e.id);r(`vendors[${n}].units`,u)},D=v({name:"total_vendor"}),te=D>0?D:1,re=e=>{const i=l(`vendors[${n}].units`)||[];r(`vendors[${e}].units`,i)},se=[{field:"actions",headerName:"Actions",width:150,renderCell:e=>t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[t.jsx(y,{type:"button",onClick:i=>{i.preventDefault(),J(e.row)},href:"#",children:t.jsx("i",{className:"ki-filled ki-copy text-warning text-2xl"})}),t.jsx(y,{type:"button",onClick:i=>{i.preventDefault(),H(e.row)},href:"#",children:t.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})}),t.jsx(y,{type:"button",onClick:i=>{i.preventDefault(),ee(e.row)},href:"#",children:t.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})]})}];return t.jsxs("div",{children:[t.jsx(a,{options:[{label:"Existing",value:"existing"},{label:"New",value:"new"}],fieldLabel:"Select Type Vendor",fieldName:`vendors[${n}].type_vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:s}),h(`vendors[${n}].type_vendor`)==="existing"&&t.jsxs(t.Fragment,{children:[t.jsx(a,{options:$,fieldLabel:"Select Vendor",fieldName:`vendors[${n}].vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:s}),t.jsx(oe,{fieldLabel:"Propose Vendor",fieldName:`vendors[${n}].winner`,isRequired:!1,disabled:s})]}),h(`vendors[${n}].type_vendor`)==="new"&&t.jsx(t.Fragment,{children:t.jsx(N,{fieldLabel:"Vendor Name",fieldName:`vendors[${n}].vendor_name_text`,isRequired:!1,type:"text",placeholder:"Enter your vendor",disabled:s})}),!s&&t.jsxs("div",{className:"card mt-2",children:[t.jsx("div",{className:"card-header",children:t.jsx("p",{children:"item"})}),t.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[t.jsx(N,{fieldLabel:"Qty",fieldName:"item_qty",isRequired:!1,type:"number",placeholder:"Enter your qty",disabled:s}),t.jsx(N,{fieldLabel:"Unit Price",fieldName:"item_unit_price",isRequired:!1,disabled:s,type:"number",placeholder:"Unit Price"}),t.jsx(a,{options:S,fieldLabel:"Account Assignment",fieldName:"item_account_assignment_categories",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Account Assignment",classNames:"mt-2"}),(c==="K"||c==="V"||c==="W"||c==="Y")&&t.jsx(a,{options:F,fieldLabel:"Cost Center",fieldName:"item_cost_center",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Cost Center",classNames:"mt-2"}),t.jsx(a,{options:I,fieldLabel:"Material Group",fieldName:"item_material_group",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Material Group",classNames:"mt-2",onChangeOutside:async(e,i)=>{await X(e)}}),t.jsx(a,{options:U,fieldLabel:"Material Number",fieldName:"item_material_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Material Number",classNames:"mt-2"}),t.jsx(a,{options:B,fieldLabel:"Uom",fieldName:"item_uom",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Purchase requisition unit of measure",classNames:"mt-2"}),t.jsx(a,{options:G,fieldLabel:"Tax On Sales",fieldName:"item_tax",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Tax on sales",classNames:"mt-2"}),t.jsx(me,{fieldLabel:"Short Text",fieldName:"item_short_text",isRequired:!1,disabled:s,maxLength:40,classNames:"mt-4",style:{width:"56.5rem"}}),c==="F"&&t.jsx(a,{options:W,fieldLabel:"Order Number",fieldName:"item_order_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Order Number",classNames:"mt-2"}),c==="A"&&t.jsxs(t.Fragment,{children:[t.jsx(a,{options:K,fieldLabel:"Main Asset Number",fieldName:"item_asset_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Main Asset",classNames:"mt-2",onChangeOutside:(e,i)=>{V(e,n)}}),t.jsx(a,{options:R[n],fieldLabel:"Sub Asset",fieldName:"item_sub_asset_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Sub Asset Number",classNames:"mt-2"})]})]}),t.jsx("div",{className:"card-footer",children:t.jsx(C,{type:"button",variant:"contained",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await Y(),children:"Add Item"})})]}),t.jsx(le,{sx:{width:"100%",overflowX:"auto",marginTop:"1rem"},children:t.jsx("div",{className:"lg:col-span-2",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"card card-grid h-full min-w-full",children:t.jsx("div",{className:"card-body",children:t.jsx("div",{"data-datatable":"true",children:t.jsx("div",{className:"scrollable-x-auto",children:t.jsx(ce,{columns:[...s?[]:se,...de],rows:j,hideFooterPagination:!0})})})})})})})}),Array.from({length:te},(e,i)=>t.jsx(t.Fragment,{children:i!==n&&t.jsxs(C,{type:"button",variant:"contained",style:{marginTop:"1rem",marginRight:"1rem"},className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await re(i),children:["Copy To Vendor ",i+1]},i)}))]})};export{We as default};
