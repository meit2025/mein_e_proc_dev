import{j as e,r as D,b as ae}from"./app-DNuiccyu.js";import{F as ne,a as u,b as j,c as m,d as _,e as re}from"./form-BFacE67e.js";import{z as i,t as le}from"./zod-D9eZXHnj.js";import{d as ie}from"./index-DsszJLLj.js";import{B as W}from"./button-D8tf04qm.js";import{a as oe,C as ce,u as de,b as z,c as G}from"./index.esm-BcJX4rF5.js";import{T as he}from"./textarea-C2glZBZ_.js";/* empty css              */import{S as xe}from"./scroll-area-Bn5SUfz7.js";import{S as pe}from"./separator-cPnQUmYX.js";import{T as ue,a as je,b as me,c as _e}from"./tabs-C6oZImh0.js";import{h as S,C as ge}from"./moment-CGyasSJ5.js";import{S as F,a as Y,b as q,c as V,d as T}from"./select-Dy9DsFSZ.js";import{C as K}from"./CustomDatePicker-Cv__HzPe.js";import{I as $}from"./input-B47TkicD.js";import{G as fe}from"./api-BEQetkWJ.js";import{a as be}from"./axiosInstance-D0MU2t6I.js";import{BusinessTripType as we}from"./models-Cyy9oxPO.js";import{C as ye,G as ve}from"./api-kPGf3tEJ.js";import{S as Ce}from"./Switch-CGFs4oQk.js";import{F as De}from"./FormHelperText-C6oULUD3.js";import"./app-CTy9eNAz.js";import"./index-BkbGbtK4.js";import"./index-Bsjqh-qZ.js";import"./index-DxuuIrXu.js";import"./index-CA_XpnUd.js";import"./index-DRSGIQuX.js";import"./index-BnY2o-Bx.js";import"./createLucideIcon-Bi1dVcSg.js";import"./index-DEnZETA_.js";import"./Combination-jYzjnSHQ.js";import"./index-CkYonrDW.js";import"./createSimplePaletteValueFilter-jyWXRIXu.js";import"./SwitchBase-CL_lxj-V.js";const Se=({fieldLabel:r,fieldName:a,isRequired:l=!1,disabled:x=!1,style:g,requiredMessage:p,classNames:h,defaultChecked:n=!1,note:c,onChanges:b})=>{var f;const{control:C,formState:{errors:d}}=oe();return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[r&&e.jsxs("label",{className:"form-label max-w-32",children:[r," ",e.jsxs("span",{className:"text-red-700",children:[" ",l?"*":""]})]}),e.jsx(ce,{name:a,control:C,rules:{required:l?p??`${r} is required`:!1},render:({field:o})=>e.jsx("div",{style:g,className:h,children:e.jsx(Ce,{...o,checked:!!(o.value??n),onChange:A=>{o.onChange(A),b&&b(A)},disabled:x})})}),e.jsx("span",{children:c})]}),e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label max-w-32",children:""}),d[a]&&e.jsx(De,{error:!0,children:String((f=d[a])==null?void 0:f.message)})]})]})};i.object({remark:i.string().min(1).max(50),reimburse_cost:i.number()});const jt=({users:r,listPurposeType:a,pajak:l,costcenter:x,purchasingGroup:g,type:p,id:h,role:n,idUser:c,listDestination:b=[]})=>{const C=i.object({purpose_type_id:i.string().min(1,"Purpose type required"),request_for:i.string().min(1,"Request for required"),cost_center_id:i.string().min(1,"Cost Center for required"),pajak_id:i.string().min(1,"Pajak for required"),purchasing_group_id:i.string().min(1,"Purchasing Group for required"),remark:i.string().min(1,"Remark is required"),attachment:i.instanceof(File).nullable().optional(),total_destination:i.number().min(1,"Total Destinantion Required"),cash_advance:i.boolean().nullable().optional(),total_percent:i.string().nullable().optional(),total_cash_advance:i.string().nullable().optional(),destinations:i.array(i.object({destination:i.string().min(1,"Destinantion Required"),business_trip_start_date:i.date().optional(),business_trip_end_date:i.date().optional(),detail_attedances:i.array(i.object({date:i.date().optional(),shift_code:i.string().optional(),shift_start:i.string().optional(),shift_end:i.string().optional(),start_time:i.string().optional(),end_time:i.string().optional()})),allowances:i.array(i.object({name:i.string().optional(),code:i.string().optional(),default_price:i.number().optional(),type:i.string().optional(),subtotal:i.number().optional(),currency:i.string().optional(),detail:i.array(i.object({date:i.date().nullish(),request_price:i.any().optional()}))}))}))}),[d,f]=D.useState("1");console.log("list destiantion",b);const o=de({resolver:le(C),defaultValues:{purpose_type_id:"",request_for:"",cost_center_id:"",pajak_id:"",purchasing_group_id:"",remark:"",attachment:null,total_destination:1,cash_advance:!1,total_percent:"0",total_cash_advance:"0",destinations:[{detail_attedances:[],allowances:[],destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date}]}});async function A(){const s=ve(h);try{const t=await ae.get(s);o.reset({purpose_type_id:t.data.data.purpose_type_id,request_for:t.data.data.request_for,remark:t.data.data.remarks,attachment:null,total_destination:t.data.data.total_destination,destinations:[{detail_attedances:t.data.data.destination.detail_attedances,allowances:[],destination:t.data.data.destination.destination,business_trip_start_date:new Date,business_trip_end_date:new Date}]})}catch{}}const[k,R]=D.useState([]);async function N(s){o.setValue("purpose_type_id",s||"");const v=fe(s,c||"");try{const E=await be.get(v);R(E.data.data)}catch{}}const w=s=>{o.setValue("total_destination",parseInt(s,10)),f(s),O()},I=async s=>{try{const t=new FormData;t.append("purpose_type_id",s.purpose_type_id??""),t.append("request_for",s.request_for??""),t.append("cost_center_id",s.cost_center_id??""),t.append("pajak_id",s.pajak_id??""),t.append("purchasing_group_id",s.purchasing_group_id??""),t.append("remark",s.remark??""),t.append("attachment",s.attachment??""),t.append("total_destination",`${s.total_destination}`),t.append("cash_advance",`${s.cash_advance}`),t.append("total_percent",`${s.total_percent}`),t.append("total_cash_advance",`${s.total_cash_advance}`),s.destinations.forEach((v,E)=>{const se={...v,business_trip_start_date:S(v.business_trip_start_date).format("YYYY-MM-DD"),business_trip_end_date:S(v.business_trip_end_date).format("YYYY-MM-DD"),detail_attedances:v.detail_attedances.map(M=>({...M,date:S(M.date).format("YYYY-MM-DD")})),allowances:v.allowances.map(M=>({...M,detail:M.detail.map(B=>({...B,date:(B==null?void 0:B.date)!=null?S(B.date).format("YYYY-MM-DD"):null}))}))};t.append(`destinations[${E}]`,JSON.stringify(se))}),console.log(t," test"),await ie.Inertia.post(ye,t,{headers:{"Content-Type":"multipart/form-data"}}),Ve("succesfully created data","success")}catch{}};function O(){const s=[],t=parseInt(d);for(let v=0;v<t;v++)s.push({destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date,allowances:[],detail_attedances:[]});o.setValue("destinations",s)}const{fields:y,append:P,remove:H,update:L}=z({control:o.control,name:"destinations"});D.useEffect(()=>{O(),h&&p==we.edit&&A()},[d,k,h,p,n,c]);const[Q,X]=D.useState(!1),Z=s=>{X(s)},U=G({control:o.control,name:"total_percent"}),[ee,te]=D.useState(0),J=ee;return D.useEffect(()=>{const t=parseFloat((U||"0").toString())/100*J;o.setValue("total_cash_advance",t.toFixed(0))},[U,J]),e.jsx(xe,{className:"h-[600px] w-full ",children:e.jsx(ne,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(I),children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request No."}),e.jsx("td",{children:"ODR-2023"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussiness Trip Purpose Type"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:o.control,name:"purpose_type_id",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{onValueChange:t=>N(t),value:s.value,children:[e.jsx(Y,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Bussiness Purpose Type --"})}),e.jsx(V,{children:a.map(t=>e.jsx(T,{value:t.id.toString(),children:t.name}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request For"}),e.jsx("td",{children:e.jsx(u,{control:o.control,name:"request_for",render:({field:s})=>(n==="user"&&!s.value&&s.onChange(c.toString()),e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{onValueChange:t=>s.onChange(t),value:s.value,disabled:n==="user",children:[e.jsx(Y,{className:"w-[200px] py-2",children:e.jsx(q,{placeholder:"-- Select Business Purpose Type --"})}),e.jsx(V,{children:n==="admin"?r.map(t=>e.jsx(T,{value:t.id.toString(),children:t.name},t.id)):r.filter(t=>t.id===c).map(t=>e.jsx(T,{value:t.id.toString(),children:t.name},t.id))})]})}),e.jsx(_,{})]}))})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Cost Center"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:o.control,name:"cost_center_id",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(Y,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Cost Center --"})}),e.jsx(V,{children:x.map(t=>e.jsx(T,{value:t.id.toString(),children:t.cost_center}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:o.control,name:"pajak_id",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(Y,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Pajak --"})}),e.jsx(V,{children:l.map(t=>e.jsx(T,{value:t.id.toString(),children:t.mwszkz}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:o.control,name:"purchasing_group_id",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(Y,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Purchasing Group --"})}),e.jsx(V,{children:g.map(t=>e.jsx(T,{value:t.id.toString(),children:t.purchasing_group}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(u,{control:o.control,name:"remark",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(he,{placeholder:"Insert remark",...s,rows:4,className:"w-[300px]"})}),e.jsx(_,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Attachment"}),e.jsx("td",{children:e.jsx(u,{control:o.control,name:"attachment",render:({field:s})=>e.jsxs(j,{children:[e.jsx(re,{className:"text-xs text-gray-500 font-extralight mb-1",children:"Max File: 1000KB"}),e.jsx(m,{children:e.jsx("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-xs shadow-sm transition-colors file:border-0 file:bg-transparent file:text-xs file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",type:"file",onChange:t=>{var E;const v=(E=t.target.files)==null?void 0:E[0];v?s.onChange(v):s.onChange(null)}})}),e.jsx(_,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Extension"}),e.jsx("td",{className:"text-gray-500 text-xs font-extralight",children:"doc,jpg,ods,png,txt,pdf"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Total Destination"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:o.control,name:"total_destination",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{value:s.value.toString(),onValueChange:w,children:[e.jsx(Y,{className:"w-[200px] py-2",children:e.jsx(q,{placeholder:"-- Select Bussiness Trip --"})}),e.jsx(V,{children:Array.from({length:5},(t,v)=>e.jsxs(T,{value:(v+1).toString(),children:[" ",v+1," "]}))})]})}),e.jsx(_,{})]})})]})]})]}),e.jsx(pe,{className:"my-4"}),e.jsx(Ne,{updateDestination:L,destinationField:y,listDestination:b,form:o,listAllowances:k,totalDestination:o.getValues("total_destination").toString(),setTotalAllowance:te}),e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Cash Advance"}),e.jsx("td",{className:"w-[50%] pb-0",children:e.jsx(Se,{fieldName:"cash_advance",isRequired:!1,disabled:!1,onChanges:s=>Z(s.target.checked)})})]}),Q&&e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Total Percent"}),e.jsxs("td",{className:"w-[50%]",children:[e.jsx(u,{control:o.control,name:"total_percent",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{value:s.value||void 0,onValueChange:t=>s.onChange(t),children:[e.jsx(Y,{className:"w-[50%] mb-2",children:e.jsx(q,{placeholder:"-- Select Option --"})}),e.jsxs(V,{children:[e.jsx(T,{value:"10",children:"10"}),e.jsx(T,{value:"25",children:"25"}),e.jsx(T,{value:"50",children:"50"})]})]})}),e.jsx(_,{})]})}),e.jsx(u,{control:o.control,name:"total_cash_advance",render:({field:s})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{value:s.value||"",readOnly:!0,className:"w-[50%]"})}),e.jsx(_,{})]})})]})]})})]}),e.jsx(W,{type:"submit",children:"submit"})]})})})};function Ne({totalDestination:r,listAllowances:a,destinationField:l,form:x,updateDestination:g,setTotalAllowance:p,listDestination:h=[]}){return D.useState(),D.useState(),D.useState(0),e.jsxs(ue,{defaultValue:"destination1",className:"w-full",children:[e.jsx(je,{className:"flex items-center justify-start space-x-4",children:l.map((n,c)=>e.jsxs(me,{value:`destination${c+1}`,children:["Destination ",c+1]}))}),l.map((n,c)=>e.jsx(Te,{listAllowances:a,updateDestination:g,destination:n,form:x,index:c,setTotalAllowance:p,listDestination:h}))]})}function Te({form:r,index:a,destination:l,updateDestination:x,listAllowances:g,setTotalAllowance:p,listDestination:h}){const{fields:n,update:c,append:b,remove:C}=z({control:r.control,name:`destinations.${a}.detail_attedances`}),{fields:d,update:f,append:o,remove:A,replace:k}=z({control:r.control,name:`destinations.${a}.allowances`});function R(){let N=S(l.business_trip_start_date).startOf("day");const w=S(l.business_trip_end_date).startOf("day");for(C(),A();N.isBefore(w)||N.isSame(w);){const y={date:N.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};b(y),N=N.add(1,"days")}function I(y){let P=S(l.business_trip_start_date).startOf("day");const H=S(l.business_trip_end_date).startOf("day"),L=[];for(;P.isBefore(H)||P.isSame(H);)L.push({date:P.toDate(),request_price:y}),P=P.add(1,"days");return L}const O=g.map(y=>({name:y.name,code:y.code,default_price:parseInt(y.grade_price),type:y.type,subtotal:parseInt(y.grade_price),currency:y.currency_id,request_value:y.request_value,detail:y.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(y.grade_price)}]:I(y.grade_price)}));k(O)}return e.jsxs(_e,{value:`destination${a+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",l.destination]}),e.jsx("td",{children:e.jsx(u,{control:r.control,name:`destinations.${a}.destination`,render:({field:N})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(F,{onValueChange:w=>{x(a,{...l,destination:w})},defaultValue:l.destination,children:[e.jsx(Y,{className:"w-[200px]",children:e.jsx(q,{placeholder:"Destination"})}),e.jsx(V,{children:h.map(w=>e.jsx(T,{value:w.destination,className:"uppercase",children:w.destination}))})]})}),e.jsx(_,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(u,{control:r.control,name:`destinations.${a}.business_trip_start_date`,render:({field:N})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(K,{initialDate:l.business_trip_start_date,onDateChange:w=>{x(a,{...l,business_trip_start_date:w})}})}),e.jsx(_,{})]})}),e.jsx("span",{children:"To"}),e.jsx(u,{control:r.control,name:`destinations.${a}.business_trip_end_date`,render:({field:N})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(K,{initialDate:l.business_trip_end_date,onDateChange:w=>{console.log("end date",w),x(a,{...l,business_trip_end_date:w})}})}),e.jsx(_,{})]})}),e.jsx(W,{type:"button",onClick:()=>R(),children:"Get Detail"})]})]})]}),e.jsx(Fe,{detailAttedanceFields:n,form:r,updateAttedanceFields:c,destinationIndex:a}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(Ye,{allowanceField:d,destinationIndex:a,form:r})]},a),e.jsx(Ae,{allowanceField:d,destinationIndex:a,form:r,setTotalAllowance:p})]})}function Ae({allowanceField:r,destinationIndex:a,form:l,setTotalAllowance:x}){const[g,p]=D.useState(0);D.useEffect(()=>{const n=r.reduce((C,d,f)=>{const o=l.getValues(`destinations.${a}.allowances.${f}.detail`),A=h(d,o);return C+A},0),b=l.getValues("destinations").reduce((C,d,f)=>{const A=(d.allowances||[]).reduce((k,R,N)=>{const w=l.getValues(`destinations.${f}.allowances.${N}.detail`),I=h(R,w);return k+I},0);return C+A},0);p(n),x(b)},[r,l.watch()]);const h=(n,c)=>{var b;return n.type==="total"?parseFloat(((b=c==null?void 0:c[0])==null?void 0:b.request_price)||0):c==null?void 0:c.reduce((C,d)=>C+parseFloat(d.request_price||0),0)};return e.jsx(e.Fragment,{children:e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-[50%]",children:"Item"}),e.jsx("th",{className:"w-[50%]",children:"Sub Total"})]})}),e.jsx("tbody",{children:r.map((n,c)=>e.jsx($e,{allowance:n,destinationIndex:a,form:l,allowanceIndex:c}))}),e.jsx("tfoot",{className:"mt-4",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{children:e.jsx("i",{children:"Total Allowance"})}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:e.jsx("i",{children:"IDR"})}),e.jsx("span",{children:e.jsx("i",{children:g})})]})]})})]})})}function $e({allowance:r,destinationIndex:a,form:l,allowanceIndex:x}){const g=G({control:l.control,name:`destinations.${a}.allowances.${x}.detail.0.request_price`}),p=G({control:l.control,name:`destinations.${a}.allowances.${x}.detail`}),h=()=>{if(r.type==="total")return parseFloat(g||0)*1;{let n=0;return p==null||p.forEach(c=>{const b=parseFloat(c.request_price||0);n+=b}),n}};return e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:"IDR"}),e.jsx("span",{children:h()})]})]},r.id)}function Fe({form:r,destinationIndex:a,detailAttedanceFields:l,updateAttedanceFields:x}){const g=r.watch(`destinations.${a}.detail_attedances`);return D.useEffect(()=>{},[g]),D.useEffect(()=>{},[l]),e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsx("div",{className:"mb-4 text-sm",children:"Detail Attedance: "})})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("table",{className:"detail-attedance text-xs",children:[e.jsxs("thead",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Shift code"}),e.jsx("th",{children:"Shift Start"}),e.jsx("th",{children:"Shift End"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"})]}),e.jsx("tbody",{children:l.map((p,h)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[S(p.date).format("DD/MM/YYYY"),e.jsx(u,{control:r.control,name:`destinations.${a}.detail_attedances.${h}.date`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsxs("td",{children:[p.shift_code,e.jsx(u,{control:r.control,name:`destinations.${a}.detail_attedances.${h}.shift_code`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsxs("td",{children:[p.shift_start,e.jsx(u,{control:r.control,name:`destinations.${a}.detail_attedances.${h}.shift_start`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsxs("td",{children:[p.shift_end,e.jsx(u,{control:r.control,name:`destinations.${a}.detail_attedances.${h}.shift_end`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsx("td",{children:e.jsx(u,{control:r.control,name:`destinations.${a}.detail_attedances.${h}.start_time`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(_,{})]})})}),e.jsx("td",{children:e.jsx(u,{control:r.control,name:`destinations.${a}.detail_attedances.${h}.end_time`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(_,{})]})})})]},p.index))})]})})})]})}function Ye({form:r,destinationIndex:a,allowanceField:l}){return e.jsx("table",{className:"w-full allowance-table",children:l.map((x,g)=>e.jsx(qe,{form:r,allowance:x,destinationIndex:a,allowanceIndex:g}))})}function qe({form:r,allowance:a,destinationIndex:l,allowanceIndex:x}){const[g,p]=D.useState(!1),h=d=>{p(f=>!f)},n=G({control:r.control,name:`destinations.${l}.allowances.${x}.detail.0.request_price`}),c=G({control:r.control,name:`destinations.${l}.allowances.${x}.detail`}),b=()=>{if(a.type==="total")return parseFloat(n||0)*1;{let d=0;return c==null||c.forEach(f=>{const o=parseFloat(f.request_price||0);d+=o}),d}},C=d=>f=>{const o=parseFloat(f.target.value)||0;a.request_value==="unlimited"?d.onChange(f):a.request_value==="up to max value"?o<=a.subtotal?d.onChange(f):alert(`Value cannot exceed the subtotal of IDR ${a.subtotal}`):a.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:a.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:a.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:a.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{control:r.control,name:`destinations.${l}.allowances.${x}.detail.0.request_price`,render:({field:d})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{value:d.value,onChange:C(d)})}),e.jsx(_,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",a.detail.length," Days * ",a.subtotal," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",b()]})})}),a.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>h(),children:e.jsxs(W,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},a.id),g&&e.jsx(e.Fragment,{children:a.detail.map((d,f)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:S(d.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(u,{control:r.control,name:`destinations.${l}.allowances.${x}.detail.${f}.request_price`,render:({field:o})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{value:o.value,onChange:C(o)})}),e.jsx(_,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},d.id))})]})}function mt({form:r,type:a,allowanceIndex:l,destinationIndex:x}){const{fields:g}=z({control:r.control,name:`destinations.${x}.allowances.${l}.detail`});return e.jsx(e.Fragment,{children:g.map((p,h)=>e.jsx(u,{control:r.control,name:`destinations.${x}.allowances.${h}.detail.${h}.request_price`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx($,{value:n.value,onChange:n.onChange})}),e.jsx(_,{})]})}))})}function Ve(r,a){throw new Error("Function not implemented.")}export{mt as AllowanceInputForm,qe as AllowanceRowInput,Ne as BussinesTripDestination,Te as BussinessDestinationForm,jt as BussinessTripFormV1,Ye as DetailAllowance,Fe as DetailAttedances,$e as ResultPerItem,Ae as ResultTotalItem};
