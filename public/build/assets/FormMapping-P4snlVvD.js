import{j as s,r as C,u as B,R as T,b as R}from"./app-DNuiccyu.js";import{F as $}from"./formInput-Csxk3QdQ.js";import{F as H}from"./formDropdown-CleBeLbi.js";import{F as O}from"./formCheckbox-Bflyl3LN.js";import{a as A,C as k,F as P}from"./index.esm-BcJX4rF5.js";import{A as U,T as V,C as D,I as W}from"./TextField-BUqFHcDG.js";import{F as I}from"./FormHelperText-C6oULUD3.js";import{F as _}from"./formTextArea-DkeoBY0l.js";import{F as z}from"./formSwitch-DkAOH0gV.js";import{a as G}from"./axiosInstance-D0MU2t6I.js";import{L as J}from"./Loading-Y5sLJIQ9.js";import{F as K}from"./form-D8Hqguhv.js";import{C as Q}from"./CustomDialog-Dzf3CyhH.js";import{F as X}from"./index-BkbGbtK4.js";import{B as Y}from"./button-D8tf04qm.js";const Z=({fieldLabel:e,fieldName:r,isRequired:m=!1,disabled:d=!1,style:j,requiredMessage:y,options:u=[],placeholder:q,classNames:F,onChangeOutside:x})=>{const{control:f,formState:{errors:b}}=A();return s.jsx(k,{name:r,control:f,rules:{required:m?y??`${e} is required`:!1},render:({field:p})=>{var g;return s.jsxs("div",{style:j,className:F,children:[s.jsx(U,{...p,multiple:!0,options:u,getOptionLabel:a=>a.label,isOptionEqualToValue:(a,t)=>a.value===t,onChange:(a,t)=>{p.onChange(t.map(l=>l.value)),x&&x(t.map(l=>l.value))},value:u.filter(a=>{var t;return(t=p.value)==null?void 0:t.includes(a.value)}),disabled:d,renderInput:a=>s.jsx(V,{...a,label:e,placeholder:q,error:!!b[r],required:m}),renderTags:(a,t)=>a.map((l,n)=>C.createElement(D,{label:l.label,...t({index:n}),key:n}))}),b[r]&&s.jsx(I,{error:!0,children:String((g=b[r])==null?void 0:g.message)})]})}})},ee=({fieldLabel:e,fieldName:r,isRequired:m=!1,disabled:d=!1,style:j,requiredMessage:y,allowedExtensions:u=[],classNames:q,onFileChangeOutside:F})=>{const[x,f]=C.useState(null),{control:b,formState:{errors:p},setError:g,clearErrors:a}=A(),t=(l,n)=>{var v;const o=l.target.files?l.target.files[0]:null;if(o){const N=(v=o.name.split(".").pop())==null?void 0:v.toLowerCase();if(u.length>0&&N&&!u.includes(N)){n(null),f(null),g(r,{type:"manual",message:`Invalid file type. Allowed types: ${u.join(", ")}`});return}a(r),f(o.name),n(o),F&&F(o)}else n(null),f(null),a(r)};return s.jsx(k,{name:r,control:b,rules:{required:m?y??`${e} is required`:!1},render:({field:l})=>{var n;return s.jsxs("div",{style:j,className:q,children:[s.jsx("label",{children:e}),s.jsx(W,{type:"file",disabled:d,onChange:o=>t(o,l.onChange)}),x&&s.jsxs("p",{children:["Selected file: ",x]}),p[r]&&s.jsx(I,{error:!0,children:String((n=p[r])==null?void 0:n.message)})]})}})},se=({model:e,onChangeOutside:r})=>{switch(e.type){case"input":return s.jsx($,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,type:e.texttype,requiredMessage:e.requiredMessage,placeholder:e.placeholder,minLength:e.minLength,maxLength:e.maxLength,classNames:e.classNames,icon:e.icon});case"textarea":return s.jsx(_,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames});case"select":return s.jsx(H,{options:e.options??[],fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames,onChangeOutside:r});case"checkbox":return s.jsx(O,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,classNames:e.classNames});case"multiselect":return s.jsx(Z,{options:e.options??[],fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames,onChangeOutside:r});case"switch":return s.jsx(z,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,classNames:e.classNames});case"file":return s.jsx(ee,{fieldLabel:e.label??"",fieldName:e.name??"",allowedExtensions:e.allowedExtensions,disabled:e.disabled,onFileChangeOutside:r});default:return null}},ge=({formModel:e,url:r,redirectUrl:m,methods:d,onSave:j,isLoading:y,classForm:u,isCustom:q=!1,formCustom:F,formLogic:x,disableButtonSubmit:f=!1})=>{const{setError:b,watch:p}=d,{showToast:g}=B(),[a,t]=C.useState(!1),l=async i=>{var h,L,S,M;t(!0);try{const c=await G.post(r,i,{headers:{"Content-Type":"application/json"}});g(c.data.message??"success","success"),j&&await j(c),m&&setTimeout(()=>{window.location.href=m},2e3)}catch(c){if(R.isAxiosError(c)&&((L=(h=c.response)==null?void 0:h.data)!=null&&L.message)&&g(c.response.data.message,"error"),R.isAxiosError(c)&&((M=(S=c.response)==null?void 0:S.data)!=null&&M.errors)){const w=c.response.data.errors;Object.keys(w).forEach(E=>{b(E,{type:"server",message:w[E].join(", ")})})}}t(!1)},[n,o]=T.useState(!1),v=i=>{let h=i.split("/");return h[h.length-1]};T.useState({type:X.create,id:void 0});function N(){o(!n)}return s.jsxs(P,{...d,children:[s.jsx(J,{isLoading:y||a}),s.jsxs(Y,{onClick:N,className:"bg-blue-500",style:{marginRight:"10px",marginBottom:"10px"},children:[s.jsx("i",{className:"ki-filled ki-people"}),"Family Setting"]}),s.jsx(Q,{onClose:()=>o(!1),open:n,onOpenChange:N,children:s.jsx(K,{idUser:v(r),onSuccess:i=>o(!i)})}),s.jsxs("form",{onSubmit:d.handleSubmit(l),children:[s.jsxs("div",{className:u,children:[q?s.jsx(s.Fragment,{children:F}):s.jsx(s.Fragment,{children:(e??[]).map((i,h)=>s.jsx("div",{className:`mt-8 ${i.classPosition}`,children:i.fieldCustome?i.fieldCustomeValue:s.jsx(s.Fragment,{children:!i.conditional||p(i.parameterConditional??"")===i.conditional?s.jsx(se,{model:i}):null})},h))}),x]}),!f&&s.jsx("div",{className:"flex justify-end mt-8",children:s.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",children:"Submit"})})]})]})};export{ge as F};
