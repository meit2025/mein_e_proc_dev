import{r as l,u as A,j as t}from"./app-DmdjFYN3.js";import{d as I}from"./form-CqaPDspB.js";import{z as o,t as O}from"./index-BQDDbtGT.js";import{B as V}from"./button-ByWU15lG.js";import{u as B}from"./index.esm-CKoOinFG.js";import{S as M}from"./scroll-area-DxTtq742.js";import{F as x}from"./formDropdown-BBndZPCe.js";import{u as y}from"./getDropdown-HLpn0cwd.js";import{a as m}from"./axiosInstance-Bgc-5Uba.js";import{F as c}from"./utils-DkKlTS5W.js";import{M as v}from"./MultiSelect-CVhY-Okk.js";import{a as C}from"./api-BBkWHPRN.js";import{b as L}from"./api-BSjkUOmE.js";import"./app-DQK4SJPx.js";import"./index-ChSjQNUV.js";import"./index-DuB2W0Qy.js";import"./index-Bb4qSo10.js";import"./index-CwK3G1m4.js";import"./index-Bvuzssq6.js";import"./TextField-Ae-BOfAt.js";import"./createSvgIcon-BjVbGZeT.js";import"./DefaultPropsProvider-CwyvXzBo.js";import"./extends-CF3RwP-h.js";import"./useSlot-DkcPt954.js";import"./createSimplePaletteValueFilter-BPz92A5r.js";import"./useControlled-DyI6iNHe.js";import"./FormHelperText-CDzZYCvV.js";import"./index-CfLX6Nrw.js";import"./checkbox-BvZLHsLq.js";import"./index-spAMJ4bx.js";import"./index-D14G0JmU.js";import"./index-7sizUBCg.js";function je({onSuccess:i,type:d=c.create,storeURL:j,editURL:R,updateURL:w}){const[_,u]=l.useState([]);l.useState(null);const{dataDropdown:g,getDropdown:h}=y(),{dataDropdown:T,getDropdown:f}=y(L),D=o.object({period:o.number("Period must choose"),type:o.number("Type must choose"),users:o.array(o.number().optional())}),E={period:null,type:null,users:[]},a=B({resolver:O(D),defaultValues:E});async function S(){try{const r=(await m.get(R)).data.data;await n(r.type),a.reset({period:r.period,type:r.type,users:r.users})}catch{}}const{showToast:b}=A(),P=async e=>{var r;try{let s;d===c.edit?s=await m.put(w??"",e):s=await m.post(j??"",e),i==null||i(!0),b((r=s==null?void 0:s.data)==null?void 0:r.data,"success")}catch(s){i==null||i(!1),b(s.message,"error")}},N=async e=>{e.length>0&&h(e,{name:"code",id:"id",tabel:"master_type_reimburses"})},U=async e=>{e.length>0&&f(e,{name:"code",id:"id",tabel:"master_period_reimburses"})},n=async e=>{try{const s=(await m.get(C(e))).data.data.map(p=>({id:p.id,name:p.name,nip:p.nip}));u(s)}catch{u([])}},F=e=>{a.setValue("type",e),n(e)};return l.useEffect(()=>{h("",{name:"code",id:"id",tabel:"master_type_reimburses"}),f("",{name:"code",id:"id",tabel:"master_period_reimburses"}),d===c.edit?S():a.getValues("type")&&n(a.getValues("type"))},[d]),t.jsx(M,{className:"h-[600px] w-full",children:t.jsx(I,{...a,children:t.jsxs("form",{onSubmit:a.handleSubmit(P),children:[t.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[t.jsxs("tr",{children:[t.jsx("td",{width:200,children:"Type"}),t.jsx("td",{children:t.jsx(x,{options:g,fieldName:"type",isRequired:!0,disabled:!1,placeholder:"Reimburse Type",onSearch:N,onChangeOutside:e=>F(e),classNames:"mt-2 w-full"})})]}),t.jsxs("tr",{children:[t.jsx("td",{width:200,children:"Period"}),t.jsx("td",{children:t.jsx(x,{options:T,fieldName:"period",isRequired:!0,disabled:!1,placeholder:"Reimburse Period",onSearch:U,classNames:"mt-2 w-full"})})]}),t.jsxs("tr",{children:[t.jsxs("td",{width:200,children:["Users ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("td",{children:t.jsx(v,{onSelect:e=>{a.setValue("users",e.map(r=>r.id))},value:a.getValues("users"),id:"id",label:"name",options:_})})]})]}),t.jsx("div",{className:"flex justify-end items-center",children:t.jsx(V,{type:"submit",children:"Save"})})]})})})}export{je as default};
