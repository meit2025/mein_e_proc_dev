import{j as e}from"./app-DT9oxaOb.js";import{F as j,a as f,b as w,c as x}from"./form-hL4e1H9r.js";import{B as R}from"./button--eB67zHQ.js";import{b}from"./index.esm-CamKYyGJ.js";/* empty css              */import{c as G}from"./tabs-BDSJ_BNk.js";import{C as g}from"./CustomDatePicker-BS4Lepr4.js";import{h as p}from"./moment-C5S46NFB.js";import{F as m}from"./formDropdown-BAREkBwW.js";import{DetailAttedances as T}from"./DetailAttedances-BC0gEm4-.js";import{DetailAllowance as L}from"./DetailAllowance-C3xLM4gA.js";import{ResultTotalItem as P}from"./ResultTotalItem-DyQtSD6v.js";import"./index-sY56SCGx.js";import"./utils-DwndSUy6.js";import"./index-BCvOxj_J.js";import"./index-Bb4qSo10.js";import"./index-EvR_V4_C.js";import"./index-XH5AFRIt.js";import"./index-DP-wH3hV.js";import"./index-BjEbi6AW.js";import"./index-DQ6BtcNe.js";import"./index-Ce-bC7Hs.js";import"./index-pfNXkOFO.js";import"./popover-n78cYVA-.js";import"./Combination-CLqhaVs0.js";import"./createLucideIcon-BXQGbN7f.js";import"./TextField-CpS1-5zT.js";import"./createSvgIcon-BMfph7ok.js";import"./DefaultPropsProvider-DmjKak_p.js";import"./useSlot-tQ4DkPgF.js";import"./createSimplePaletteValueFilter-BNo2HqrB.js";import"./useControlled-drrZw8K3.js";import"./FormHelperText-GBiFxlm-.js";import"./input-BDqDAMkt.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-STjrn3aM.js";function Ne({form:a,index:t,destination:i,updateDestination:d,listAllowances:A,setTotalAllowance:F,pajak:H,purchasingGroup:M,dataTax:D,dataPurchasingGroup:$,dataDestination:C,type:l,btEdit:n}){const{fields:N,update:k,append:I,remove:v}=b({control:a.control,name:`destinations.${t}.detail_attedances`}),{fields:u,update:U,append:z,remove:B,replace:S}=b({control:a.control,name:`destinations.${t}.allowances`});function q(){let r=p(i.business_trip_start_date).startOf("day");const o=p(i.business_trip_end_date).startOf("day");for(v(),B();r.isBefore(o)||r.isSame(o);){const s={date:r.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};I(s),r=r.add(1,"days")}function y(s){let c=p(i.business_trip_start_date).startOf("day");const _=p(i.business_trip_end_date).startOf("day"),h=[];for(;c.isBefore(_)||c.isSame(_);)h.push({date:c.toDate(),request_price:s}),c=c.add(1,"days");return h}const O=A.map(s=>({name:s.name,code:s.code,default_price:parseInt(s.grade_price),type:s.type,subtotal:parseInt(s.grade_price),currency:s.currency_id,request_value:s.request_value,detail:s.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(s.grade_price)}]:y(s.grade_price)}));S(O)}return e.jsxs(G,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",i.destination]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:C,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.destination`):!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,destination:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:D,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.pajak_id`):!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,pajak_id:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:$,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.purchasing_group_id`):!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,purchasing_group_id:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(j,{control:a.control,name:`destinations.${t}.business_trip_start_date`,render:({field:r})=>e.jsxs(f,{children:[e.jsx(w,{children:e.jsx(g,{initialDate:i.business_trip_start_date,onDateChange:o=>{d(t,{...i,business_trip_start_date:o})},disabled:l==n?!!a.watch(`destinations.${t}.business_trip_start_date`):!1})}),e.jsx(x,{})]})}),e.jsx("span",{children:"To"}),e.jsx(j,{control:a.control,name:`destinations.${t}.business_trip_end_date`,render:({field:r})=>e.jsxs(f,{children:[e.jsx(w,{children:e.jsx(g,{initialDate:i.business_trip_end_date,onDateChange:o=>{d(t,{...i,business_trip_end_date:o})},disabled:l==n?!!a.watch(`destinations.${t}.business_trip_end_date`):!1})}),e.jsx(x,{})]})}),e.jsx(R,{type:"button",className:l==n&&a.watch(`destinations.${t}.destination`)?"hidden":"",onClick:()=>q(),children:"Get Detail"})]})]})]}),e.jsx(T,{detailAttedanceFields:N,form:a,updateAttedanceFields:k,destinationIndex:t,type:l,btEdit:n}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(L,{allowanceField:u,destinationIndex:t,form:a,type:l,btEdit:n})]},t),e.jsx(P,{allowanceField:u,destinationIndex:t,form:a,setTotalAllowance:F})]})}export{Ne as BussinessDestinationForm};
