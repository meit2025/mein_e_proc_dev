import{r as f,j as e}from"./app-C23JRtY-.js";import{z as d,t as T,F as E,b as o,d as c,f as i,g as h,I as w,B as A}from"./index-C80Y7W4U.js";import{d as _}from"./index-6Vwa-N2y.js";import{u as O}from"./index.esm-hKtL71Pc.js";import{S as B,j as S,a as x,b as m,c as p,d as u,e as g,f as v,T as P,g as K,h as X,i as z,C as y}from"./CustomDatePicker-DJZx4RNN.js";/* empty css            */const W=({reimbursement:l,reimburses:D,currencies:b,types:$,periods:k,users:N,csrf_token:C})=>{const[L,F]=f.useState(1);f.useState(D);const q=d.object({remark_group:d.string().nonempty("Remark is required"),requester:d.string().nonempty("Requester is required"),forms:d.array(d.object({rn:d.string(),type:d.string().nonempty("Type is required"),period:d.string().nonempty("Period is required"),remark:d.string().nonempty("Remark is required"),balance:d.number().min(1,"Balance must be at least 1"),receipt_date:d.date(),start_date:d.date(),end_date:d.date(),currency:d.string().nonempty("Currency is required"),attachment:d.array(d.instanceof(File)).optional()})),formCount:d.string().nonempty("Currency is required")}),n=O({resolver:T(q),defaultValues:{formCount:"1",remark_group:"",requester:"",forms:Array.from({length:1}).map(()=>({rn:"",type:"",remark:"",period:"",balance:0,receipt_date:new Date,start_date:new Date,end_date:new Date,currency:"IDR",attachment:null}))}});f.useEffect(()=>{l&&(n.setValue("remark_group",l.remark),n.setValue("requester",l.users.nip),n.setValue("formCount",l.reimburses.length.toString()),n.setValue("forms",l.reimburses.map(s=>({rn:s.rn,type:s.type,remark:s.remark,balance:Number(s.balance),currency:s.currency,period:s.period,receipt_date:new Date(s.receipt_date),start_date:new Date(s.start_date),end_date:new Date(s.end_date),attachment:s.attachment||null}))))},[l]);const R=s=>{F(s);const t=n.getValues("forms"),r=Array.from({length:s}).map((a,j)=>t[j]||{rn:"",type:"",remark:"",period:"",balance:0,receipt_date:new Date,start_date:new Date,end_date:new Date,currency:"IDR"});n.setValue("forms",r),n.setValue("formCount",s.toString())},V=async s=>{const t=new FormData;t.append("remark_group",s.remark_group),t.append("requester",s.requester),s.forms.forEach((r,a)=>{t.append(`forms[${a}][rn]`,r.rn),t.append(`forms[${a}][type]`,r.type),t.append(`forms[${a}][remark]`,r.remark),t.append(`forms[${a}][balance]`,r.balance.toString()),t.append(`forms[${a}][period]`,r.period),t.append(`forms[${a}][currency]`,r.currency),t.append(`forms[${a}][receipt_date]`,r.receipt_date.toISOString()),t.append(`forms[${a}][start_date]`,r.start_date.toISOString()),t.append(`forms[${a}][end_date]`,r.end_date.toISOString()),r.attachment.forEach(j=>{t.append(`forms[${a}][attachments][]`,j)})}),l?_.Inertia.put(`/reimburse/${l.id}`,s,{headers:{"X-CSRF-TOKEN":C}}):await _.Inertia.post("/reimburse",t,{headers:{"X-CSRF-TOKEN":C,"Content-Type":"multipart/form-data"}})};return e.jsx(B,{className:"h-[600px] w-full",children:e.jsx(E,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(V),children:[e.jsx("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Reimburse Request No."}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request Status"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:"remark_group",render:({field:s})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(S,{disabled:l!==null,placeholder:"Insert remark",...s})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Employee"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:"requester",render:({field:s})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(x,{disabled:l!==null,onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(m,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Requester"})}),e.jsx(u,{children:N.map(t=>e.jsxs(g,{value:t.nip,children:[t.name," (",t.nip,")"]},t.id))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Number of Forms"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:"formCount",render:({field:s})=>{var t;return e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(x,{disabled:l!==null,onValueChange:r=>R(r),value:(t=s.value)==null?void 0:t.toString(),children:[e.jsx(m,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select number of forms"})}),e.jsx(u,{children:Array.from({length:20},(r,a)=>a+1).map(r=>e.jsx(g,{value:r.toString(),children:r},r))})]})}),e.jsx(h,{})]})}})})]})]})}),e.jsx(v,{className:"my-4"}),Array.from({length:n.watch("formCount")||1}).map((s,t)=>e.jsxs(P,{defaultValue:`form${t+1}`,className:"w-full",children:[e.jsx(K,{className:"grid w-full grid-cols-2",children:e.jsxs(X,{value:`form${t+1}`,children:["Form ",t+1]})}),e.jsxs(z,{value:`form${t+1}`,children:[e.jsx(o,{control:n.control,name:`forms.${t}.rn`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(w,{className:"sr-only",value:r.value,onChange:r.onChange})}),e.jsx(h,{})]})}),e.jsx("div",{children:e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type of Reimbursement"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.type`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(x,{disabled:l!==null,onValueChange:a=>r.onChange(a),value:r.value,children:[e.jsx(m,{className:"w-[200px]",children:e.jsx(p,{placeholder:"-"})}),e.jsx(u,{children:$.map(a=>e.jsxs(g,{value:a.code,children:[a.name," (",a.code,")"]},a.code))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Period Date"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.period`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(x,{disabled:l!==null,onValueChange:a=>r.onChange(a),value:r.value,children:[e.jsx(m,{className:"w-[200px]",children:e.jsx(p,{placeholder:"-"})}),e.jsx(u,{children:k.map(a=>e.jsxs(g,{value:a.code,children:[a.start," - ",a.end," (",a.code,")"]},a.code))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Balance"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.balance`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(w,{disabled:l!==null,type:"number",placeholder:"0.0",...r,onChange:a=>r.onChange(Number(a.target.value)),value:r.value||0})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Start Date"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.start_date`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(y,{disabled:l!==null,initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:a=>r.onChange(a)})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"End Date"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.end_date`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(y,{disabled:l!==null,initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:a=>r.onChange(a)})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Receipt Date"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.receipt_date`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(y,{disabled:l!==null,initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:a=>r.onChange(a)})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.currency`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(x,{disabled:l!==null,onValueChange:a=>r.onChange(a),value:r.value,children:[e.jsx(m,{className:"w-[200px]",children:e.jsx(p,{placeholder:"-"})}),e.jsx(u,{children:b.map(a=>e.jsxs(g,{value:a.code,children:[a.name," (",a.code,")"]},a.code))})]})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.remark`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(S,{placeholder:"Insert remark",...r})}),e.jsx(h,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Attachments"}),e.jsx("td",{children:e.jsx(o,{control:n.control,name:`forms.${t}.attachment`,render:({field:r})=>e.jsxs(c,{children:[e.jsx(i,{children:e.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx",onChange:a=>{const j=a.target.files;if(j){const I=Array.from(j);r.onChange(I)}}})}),e.jsx(h,{})]})})})]})]})})})]})]},t)),e.jsx(v,{className:"my-4"}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(A,{type:"submit",className:"w-32",children:"Save"})})]})})})};export{W as ReimburseForm};
