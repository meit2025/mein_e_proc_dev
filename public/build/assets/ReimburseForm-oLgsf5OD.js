import{r as g,j as e}from"./app-DkozIC35.js";import{z as l,t as V,F as T,b as c,d as o,f as d,g as i,I as $,B as I}from"./index-APbpXB2u.js";import{d as E}from"./index-ByZ5tFVr.js";import{u as A}from"./index.esm-BSoOnnup.js";import{S as B,j as w,a as j,b as x,c as m,d as u,e as p,f as C,T as P,g as z,h as K,i as L,C as f}from"./CustomDatePicker-DOIZh6Vp.js";/* empty css            */const U=({reimbursement:h,reimburses:v,currencies:y,types:D,periods:b,users:_,csrf_token:S})=>{const[M,k]=g.useState(1);g.useState(v);const N=l.object({remark_group:l.string().nonempty("Remark is required"),requester:l.string().nonempty("Requester is required"),forms:l.array(l.object({type:l.string().nonempty("Type is required"),period:l.string().nonempty("Period is required"),remark:l.string().nonempty("Remark is required"),balance:l.number().min(1,"Balance must be at least 1"),receipt_date:l.date(),start_date:l.date(),end_date:l.date(),currency:l.string().nonempty("Currency is required")})),formCount:l.string().nonempty("Currency is required")}),a=A({resolver:V(N),defaultValues:{formCount:"1",remark_group:"",requester:"",forms:Array.from({length:1}).map(()=>({type:"",remark:"",period:"",balance:0,receipt_date:new Date,start_date:new Date,end_date:new Date,currency:"IDR"}))}});g.useEffect(()=>{h&&(a.setValue("remark_group",h.remark),a.setValue("requester",h.users.nip),a.setValue("formCount",h.reimburses.length),a.setValue("forms",h.reimburses.map(n=>({type:n.type,remark:n.remark,balance:n.balance,currency:n.currency,period:n.period,receipt_date:new Date(n.receipt_date),start_date:new Date(n.start_date),end_date:new Date(n.end_date)}))))},[h]);const F=n=>{k(n);const t=a.getValues("forms"),r=Array.from({length:n}).map((s,q)=>t[q]||{type:"",remark:"",period:"",balance:0,receipt_date:new Date,start_date:new Date,end_date:new Date,currency:"IDR"});a.setValue("forms",r),a.setValue("formCount",n.toString())},R=n=>{E.Inertia.post("/reimburse",n,{headers:{"X-CSRF-TOKEN":S}})};return e.jsx(B,{className:"h-[600px] w-full",children:e.jsx(T,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(R),children:[e.jsx("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Reimburse Request No."}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request Status"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:"remark_group",render:({field:n})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(w,{placeholder:"Insert remark",...n})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Employee"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:"requester",render:({field:n})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(j,{onValueChange:t=>n.onChange(t),value:n.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Requester"})}),e.jsx(u,{children:_.map(t=>e.jsxs(p,{value:t.nip,children:[t.name," (",t.nip,")"]},t.id))})]})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Number of Forms"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:"formCount",render:({field:n})=>{var t;return e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(j,{onValueChange:r=>F(parseInt(r)),value:(t=n.value)==null?void 0:t.toString(),children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"Select number of forms"})}),e.jsx(u,{children:Array.from({length:20},(r,s)=>s+1).map(r=>e.jsx(p,{value:r.toString(),children:r},r))})]})}),e.jsx(i,{})]})}})})]})]})}),e.jsx(C,{className:"my-4"}),Array.from({length:a.watch("formCount")||1}).map((n,t)=>e.jsxs(P,{defaultValue:`form${t+1}`,className:"w-full",children:[e.jsx(z,{className:"grid w-full grid-cols-2",children:e.jsxs(K,{value:`form${t+1}`,children:["Form ",t+1]})}),e.jsx(L,{value:`form${t+1}`,children:e.jsx("div",{children:e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type of Reimbursement"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.type`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(j,{onValueChange:s=>r.onChange(s),value:r.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"-"})}),e.jsx(u,{children:D.map(s=>e.jsxs(p,{value:s.code,children:[s.name," (",s.code,")"]},s.code))})]})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Period Date"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.period`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(j,{onValueChange:s=>r.onChange(s),value:r.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"-"})}),e.jsx(u,{children:b.map(s=>e.jsxs(p,{value:s.code,children:[s.start," - ",s.end," (",s.code,")"]},s.code))})]})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Balance"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.balance`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx($,{type:"number",placeholder:"0.0",...r,onChange:s=>r.onChange(Number(s.target.value)),value:r.value||0})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Start Date"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.start_date`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(f,{initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:s=>r.onChange(s)})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"End Date"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.end_date`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(f,{initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:s=>r.onChange(s)})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Receipt Date"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.receipt_date`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(f,{initialDate:r.value instanceof Date?r.value:new Date(r.value),onDateChange:s=>r.onChange(s)})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.currency`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(j,{onValueChange:s=>r.onChange(s),value:r.value,children:[e.jsx(x,{className:"w-[200px]",children:e.jsx(m,{placeholder:"-"})}),e.jsx(u,{children:y.map(s=>e.jsxs(p,{value:s.code,children:[s.name," (",s.code,")"]},s.code))})]})}),e.jsx(i,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(c,{control:a.control,name:`forms.${t}.remark`,render:({field:r})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(w,{placeholder:"Insert remark",...r})}),e.jsx(i,{})]})})})]})]})})})})]},t)),e.jsx(C,{className:"my-4"}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(I,{type:"submit",className:"w-32",children:"Save"})})]})})})};export{U as ReimburseForm};
