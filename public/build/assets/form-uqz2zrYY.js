import{r as y,u as B,j as e}from"./app-DUyOpTBh.js";import{F as U,a as o,b as l,c as n,d as c,e as S}from"./form-D_g86boo.js";import{z as t,t as $}from"./index-DAFFb4oY.js";import{B as G}from"./button-dOIyZ1Od.js";import{u as D,b as Y}from"./index.esm-CyYOhRC8.js";import{S as O}from"./scroll-area-D_dUkDib.js";import{S as p,a as g,b as _,c as f,d as h}from"./select-DXzILdmy.js";import{I as m}from"./input-Cs8-wsSX.js";import{a as b}from"./axiosInstance-DZ_xSXPt.js";import{F as j}from"./utils-oyoOCCx1.js";import{M as z}from"./MultiSelect-DG4iqSba.js";import{R as q,a as N}from"./radio-group-eOSY4yXS.js";import{L as k}from"./Loading-DKE_gS9k.js";const x="/api/master/reimburse-type",de=`${x}/`,H=`${x}/create`,ce=d=>`${x}/edit/${d}`,me=d=>`${x}/update/${d}`,xe=`${x}/delete`;function J({onSuccess:d,type:u=j.create,listGrades:C,listMaterialNumber:I,listMaterialGroup:R,editURL:F,updateURL:T,id:K}){const w=t.object({code:t.string(),name:t.string().min(1,"Name is required"),is_employee:t.boolean(),limit:t.number(),material_group:t.string("Material Group must choose"),material_number:t.string("Material Number must choose"),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string()}))}),[M,v]=y.useState(!1),V={code:"",name:"",material_group:"",material_number:"",is_employee:!0,grade_option:"all",grade_all_price:"0",grades:[]},a=D({resolver:$(w),defaultValues:V});async function P(){try{const r=(await b.get(F)).data.data;a.reset({code:r.code,name:r.name,limit:r.limit,is_employee:r.is_employee,material_group:r.material_group,material_number:r.material_number,grade_option:r.grade_option,grade_all_price:r.grade_all_price,grades:r.grades})}catch{}}const{fields:A}=Y({control:a.control,name:"grades"}),{showToast:E}=B(),L=async s=>{var r;v(!0);try{let i;u===j.edit?i=await b.put(T??"",s):i=await b.post(H??"",s),d&&d(!0),E((r=i==null?void 0:i.data)==null?void 0:r.message,"success")}catch(i){d&&d(!1),E(i.message,"error")}v(!1)};return y.useEffect(()=>{u===j.edit&&P()},[]),e.jsxs(O,{className:"h-[600px] w-full",children:[e.jsx(k,{isLoading:M}),e.jsx(U,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(L),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(o,{control:a.control,name:"code",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(m,{type:"text",placeholder:"Insert code",...s,value:s.value||"",onChange:r=>s.onChange(r.target.value),disabled:u===j.edit})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(o,{control:a.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(m,{type:"text",...s,value:s.value||"",onChange:r=>s.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"For"}),e.jsx("td",{children:e.jsx(o,{control:a.control,name:"is_employee",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(p,{onValueChange:r=>s.onChange(r==="true"),value:s.value?"true":"false",children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(_,{placeholder:"-"})}),e.jsxs(f,{children:[e.jsx(h,{value:"true",children:"Employee"},"is_employee"),e.jsx(h,{value:"false",children:"Family"},"is_employee")]})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Limit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(o,{control:a.control,name:"limit",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(m,{onChange:r=>s.onChange(Number(r.target.value)),value:s.value})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(o,{control:a.control,name:"grade_option",render:({field:s})=>e.jsx(l,{children:e.jsx(n,{children:e.jsxs(q,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(N,{value:"all"})}),e.jsx(S,{className:"text-xs",children:"All"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(N,{value:"grade"})}),e.jsx(S,{className:"text-xs",children:"Grade"})]})]})})})}),a.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(o,{control:a.control,name:"grade_all_price",render:({field:s})=>e.jsx(l,{children:e.jsx(n,{children:e.jsx(m,{...s})})})})}):e.jsx("div",{children:e.jsx(z,{label:"grade",id:"id",options:C,value:a.getValues("grades").map(s=>s.id),onSelect:s=>{a.setValue("grades",s.map(r=>({id:r.id,grade:r.grade,plafon:0})))}})}),a.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:A.map((s,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Balance ",s.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(o,{control:a.control,name:`grades.${r}.plafon`,render:({field:i})=>e.jsx(l,{children:e.jsx(n,{children:e.jsx(m,{...i})})})})})})]},s))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(o,{control:a.control,name:"material_group",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(p,{onValueChange:r=>s.onChange(r),value:s.value,children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(_,{placeholder:"-"})}),e.jsx(f,{children:R.map(r=>e.jsx(h,{value:r.id.toString(),children:r.material_group},r.id))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(o,{control:a.control,name:"material_number",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(p,{onValueChange:r=>s.onChange(r),value:s.value,children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(_,{placeholder:"-"})}),e.jsx(f,{children:I.map(r=>e.jsx(h,{value:r.id.toString(),children:r.material_number},r.id))})]})}),e.jsx(c,{})]})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(G,{type:"submit",children:"Save"})})]})})]})}const he=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{xe as D,ce as E,de as L,J as R,me as U,he as f};
