import{r as S,u as J,j as e}from"./app-UQRY0Wg-.js";import{d as K,F as m,a as o,b as d,c as u,e as I}from"./form-8MDJD2wA.js";import{z as t,t as Q}from"./index-KF8pbNIg.js";import{B as X}from"./button-4cvMUtsO.js";import{u as Z,b as ee}from"./index.esm-BegRTVcG.js";import{S as ae}from"./scroll-area-CMzZEKD6.js";import{S as M,a as R,b as F,c as T,d as x}from"./select-D3858CNi.js";import{I as h}from"./input-CpajBuSj.js";import{a as b}from"./axiosInstance-B-R-0mYN.js";import{F as j}from"./utils-KXdwy_yG.js";import{M as re}from"./MultiSelect-C_uYn9ta.js";import{R as se,a as V}from"./radio-group-zsKN5KsX.js";import{L as te}from"./Loading-CWq0wc7p.js";import{F as v}from"./formDropdown-DIoUphAt.js";import{u as L}from"./getDropdown-DR9C_heY.js";import{f as g}from"./rupiahCurrencyFormat-CP-6egij.js";const p="/api/master/reimburse-type",Ee=`${p}/`,le=`${p}/create`,Ne=c=>`${p}/edit/${c}`,Ce=c=>`${p}/update/${c}`,Se=`${p}/delete`;function ne({onSuccess:c,type:_=j.create,listGrades:P,editURL:D,updateURL:G,id:ie}){const A=t.object({code:t.string(),name:t.string().min(1,"Name is required"),is_employee:t.boolean(),family_status:t.string().optional(),interval_claim_period:t.number().nullable(),limit:t.any(),material_group:t.number().refine(a=>a>0,{message:"Material Group must be chosen"}),material_number:t.number().refine(a=>a>0,{message:"Material Number must be chosen"}),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string().min(1,"Balance required")}))}),[B,y]=S.useState(!1),{dataDropdown:U,getDropdown:Y}=L(),{dataDropdown:$,getDropdown:w}=L(),E=365,O=[{label:"1 Year",value:E*1},{label:"2 Year",value:E*2}],k={code:"",name:"",material_group:null,material_number:null,family_status:"",interval_claim_period:null,is_employee:!0,grade_option:"all",grade_all_price:"",grades:[],limit:null},s=Z({resolver:Q(A),defaultValues:k});async function q(){try{const r=(await b.get(D||"")).data.data;s.reset({code:r.code,name:r.name,limit:r.limit,is_employee:r.is_employee,family_status:r.family_status,interval_claim_period:r.interval_claim_period?parseInt(r.interval_claim_period):null,material_group:parseInt(r.material_group.id),material_number:parseInt(r.material_number),grade_option:r.grade_option,grade_all_price:r.grade_all_price,grades:r.grades}),C(r.material_group.material_group||"")}catch{}}const{fields:z}=ee({control:s.control,name:"grades"}),{showToast:N}=J(),H=async a=>{var r,n,i;y(!0);try{let l;_===j.edit?l=await b.put(G??"",a):l=await b.post(le??"",a),c&&c(!0),N((r=l==null?void 0:l.data)==null?void 0:r.message,"success")}catch(l){c&&c(!1);const f=((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||l.message;N(f,"error")}y(!1)},C=async a=>{a.length>0&&w(a,{name:"material_number",id:"id",tabel:"master_materials",where:{key:"material_group",parameter:a}})},W=async(a,r)=>{a.length>0&&w(a,{name:"material_number",id:"id",tabel:"master_materials",search:a,where:{key:"material_group",parameter:r}})};return S.useEffect(()=>{Y("",{name:"material_group",id:"id",tabel:"material_groups"}),_===j.edit&&q()},[]),e.jsxs(ae,{className:"h-[600px] w-full",children:[e.jsx(te,{isLoading:B}),e.jsx(K,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(H),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{control:s.control,name:"code",render:({field:a})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(h,{type:"text",placeholder:"Insert code",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value),disabled:_===j.edit})}),e.jsx(u,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(m,{control:s.control,name:"name",render:({field:a})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(h,{type:"text",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(u,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"For"}),e.jsx("td",{children:e.jsx(m,{control:s.control,name:"is_employee",render:({field:a})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(M,{onValueChange:r=>a.onChange(r==="true"),value:a.value?"true":"false",children:[e.jsx(R,{className:"w-[200px]",children:e.jsx(F,{placeholder:"-"})}),e.jsxs(T,{children:[e.jsx(x,{value:"true",children:"Employee"},"is_employee"),e.jsx(x,{value:"false",children:"Family"},"is_employee")]})]})}),e.jsx(u,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Family Status"}),e.jsx("td",{children:e.jsx(m,{control:s.control,name:"family_status",render:({field:a})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(M,{onValueChange:r=>a.onChange(r),value:a.value,disabled:s.getValues("is_employee")===!0,children:[e.jsx(R,{className:"w-[200px]",children:e.jsx(F,{placeholder:"Select Family"})}),e.jsxs(T,{children:[e.jsx(x,{value:"husband",children:"Husband"}),e.jsx(x,{value:"wife",children:"Wife"}),e.jsx(x,{value:"child",children:"Child"})]})]})}),e.jsx(u,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Limit Request",e.jsx("p",{className:"text-xs italic text-slate-400",children:"( Clear the form input to set an unlimited limit for the request reimbursement )"})]}),e.jsx("td",{children:e.jsx(m,{control:s.control,name:"limit",render:({field:a})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(h,{type:"text",onChange:r=>a.onChange(parseInt(r.target.value.replace(/[^0-9]/g,""))||""),value:a.value??""})}),e.jsx(u,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"block",width:200,children:"Balance"}),e.jsxs("td",{children:[e.jsx(m,{control:s.control,name:"grade_option",render:({field:a})=>e.jsx(o,{children:e.jsx(d,{children:e.jsxs(se,{value:a.value,onValueChange:a.onChange,className:"flex flex space-x-1 mb-3",children:[e.jsxs(o,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(V,{value:"all"})}),e.jsx(I,{className:"text-xs",children:"All"})]}),e.jsxs(o,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(V,{value:"grade"})}),e.jsx(I,{className:"text-xs",children:"Grade"})]})]})})})}),s.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(m,{control:s.control,name:"grade_all_price",render:({field:a})=>e.jsx(o,{children:e.jsx(d,{children:e.jsx(h,{type:"text",onChange:r=>{const n=r.target.value.replace(/[^0-9]/g,""),i=g(n,!1);a.onChange(n),r.target.value=i},value:g(String(a.value),!1)||0})})})})}):e.jsx("div",{children:e.jsx(re,{label:"grade",id:"id",options:P||[],value:s.getValues("grades").map(a=>a.id),onSelect:a=>{s.setValue("grades",a.map((r,n)=>{var i,l;return{id:r.id,grade:r.grade,plafon:((l=(i=s.getValues("grades"))==null?void 0:i[n])==null?void 0:l.plafon)||"0"}}))}})}),s.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:z.map((a,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Balance Grade ",a.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(m,{control:s.control,name:`grades.${r}.plafon`,render:({field:n})=>e.jsxs(o,{children:[e.jsx(d,{children:e.jsx(h,{type:"text",placeholder:"0",onChange:i=>{const l=i.target.value.replace(/[^0-9]/g,""),f=g(l,!1);n.onChange(l),i.target.value=f},value:g(n.value,!1)})}),e.jsx(u,{})]})})})})]},a))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Interval Claim Period"}),e.jsx("td",{children:e.jsx(v,{options:O,fieldName:"interval_claim_period",placeholder:"Select Interval",classNames:"mt-2 w-full",fieldLabel:""})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(v,{options:U,fieldName:"material_group",isRequired:!0,disabled:!1,placeholder:"Material Group",classNames:"mt-2 w-full",onChangeOutside:async(a,r)=>{await C(r==null?void 0:r.label)},fieldLabel:""})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(v,{fieldLabel:"",options:$,fieldName:"material_number",isRequired:!0,disabled:!1,placeholder:"Material Number",classNames:"mt-2 w-full",onChangeOutside:async a=>await W(a,String(s.getValues("material_group")))})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(X,{type:"submit",children:"Save"})})]})})]})}const Ie=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{Se as D,Ne as E,Ee as L,ne as R,Ce as U,Ie as f};
