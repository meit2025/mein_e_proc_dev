import{j as e,r as v,b as de}from"./app-Cp_-tSGF.js";import{F as ce,a as u,b as j,c as m,d as _,e as oe}from"./form-C5NutZ6z.js";import{z as l,t as he}from"./index-ChvvJgth.js";import{d as xe}from"./index-NuyQ1ECs.js";import{B as H}from"./button-VE0I-KHr.js";import{a as pe,C as ue,u as je,b as G,c as V}from"./index.esm-Borx5QGt.js";import{T as me}from"./textarea-vL6HNd1r.js";/* empty css              */import{S as _e}from"./scroll-area-CwAZDnNk.js";import{S as ge}from"./separator-Bl0AZHJy.js";import{T as fe,a as be,b as we,c as ye}from"./tabs-DsilnpRc.js";import{h as $,C as ve}from"./moment-Ba_LIGSw.js";import{S as A,a as F,b as q,c as E,d as N}from"./select-DCncYRXn.js";import{C as K}from"./CustomDatePicker-DDvXHfNI.js";import{I as T}from"./input-DyPe-S7i.js";import{G as Se}from"./api-DWMUymuN.js";import{a as Ce}from"./axiosInstance-CVrw0qDt.js";import{BusinessTripType as Ne}from"./models-DuVeCXYL.js";import{S as De}from"./Switch-BgXiMtXu.js";import{F as Te}from"./FormHelperText-DKsy3b_a.js";const O="/api/business-trip",tt=`${O}/list`,$e=`${O}/create`,Ae=r=>`${O}/detail/${r}`,st=`${O}/delete`,Fe=({fieldLabel:r,fieldName:s,isRequired:i=!1,disabled:o=!1,style:g,requiredMessage:x,classNames:c,defaultChecked:n=!1,note:h,onChanges:b})=>{var d;const{control:f,formState:{errors:p}}=pe();return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[r&&e.jsxs("label",{className:"form-label max-w-32",children:[r," ",e.jsxs("span",{className:"text-red-700",children:[" ",i?"*":""]})]}),e.jsx(ue,{name:s,control:f,rules:{required:i?x??`${r} is required`:!1},render:({field:y})=>e.jsx("div",{style:g,className:c,children:e.jsx(De,{...y,checked:!!(y.value??n),onChange:P=>{y.onChange(P),b&&b(P)},disabled:o})})}),e.jsx("span",{children:h})]}),e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label max-w-32",children:""}),p[s]&&e.jsx(Te,{error:!0,children:String((d=p[s])==null?void 0:d.message)})]})]})};l.object({remark:l.string().min(1).max(50),reimburse_cost:l.number()});const qe=({users:r,listPurposeType:s,pajak:i,costcenter:o,purchasingGroup:g,type:x,id:c,role:n,idUser:h})=>{const b=l.object({purpose_type_id:l.string().min(1,"Purpose type required"),request_for:l.string().min(1,"Request for required"),cost_center_id:l.string().min(1,"Cost Center for required"),pajak_id:l.string().min(1,"Pajak for required"),purchasing_group_id:l.string().min(1,"Purchasing Group for required"),remark:l.string().min(1,"Remark is required"),attachment:l.instanceof(File).nullable().optional(),total_destination:l.number().min(1,"Total Destinantion Required"),cash_advance:l.boolean().nullable().optional(),total_percent:l.string().nullable().optional(),total_cash_advance:l.string().nullable().optional(),destinations:l.array(l.object({destination:l.string().min(1,"Destinantion Required"),business_trip_start_date:l.date().optional(),business_trip_end_date:l.date().optional(),detail_attedances:l.array(l.object({date:l.date().optional(),shift_code:l.string().optional(),shift_start:l.string().optional(),shift_end:l.string().optional(),start_time:l.string().optional(),end_time:l.string().optional()})),allowances:l.array(l.object({name:l.string().optional(),code:l.string().optional(),default_price:l.number().optional(),type:l.string().optional(),subtotal:l.number().optional(),currency:l.string().optional(),detail:l.array(l.object({date:l.date().nullish(),request_price:l.any().optional()}))}))}))}),[f,p]=v.useState("1"),d=je({resolver:he(b),defaultValues:{purpose_type_id:"",request_for:"",cost_center_id:"",pajak_id:"",purchasing_group_id:"",remark:"",attachment:null,total_destination:1,cash_advance:!1,total_percent:"0",total_cash_advance:"0",destinations:[{detail_attedances:[],allowances:[],destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date}]}});async function y(){let a=Ae(c);try{let t=await de.get(a);d.reset({purpose_type_id:t.data.data.purpose_type_id,request_for:t.data.data.request_for,remark:t.data.data.remarks,attachment:null,total_destination:t.data.data.total_destination,destinations:[{detail_attedances:t.data.data.destination.detail_attedances,allowances:[],destination:t.data.data.destination.destination,business_trip_start_date:new Date,business_trip_end_date:new Date}]})}catch{}}const[P,L]=v.useState([]);async function z(a){d.setValue("purpose_type_id",a||"");let C=Se(a,h||"");try{let I=await Ce.get(C);L(I.data.data)}catch{}}const S=a=>{p(a),Y()},D=async a=>{try{const t=new FormData;t.append("purpose_type_id",a.purpose_type_id??""),t.append("request_for",a.request_for??""),t.append("cost_center_id",a.cost_center_id??""),t.append("pajak_id",a.pajak_id??""),t.append("purchasing_group_id",a.purchasing_group_id??""),t.append("remark",a.remark??""),t.append("attachment",a.attachment??""),t.append("total_destination",`${a.total_destination}`),t.append("cash_advance",`${a.cash_advance}`),t.append("total_percent",`${a.total_percent}`),t.append("total_cash_advance",`${a.total_cash_advance}`),a.destinations.forEach((C,I)=>{t.append(`destinations[${I}]`,JSON.stringify(C))}),await xe.Inertia.post($e,t,{headers:{"Content-Type":"multipart/form-data"}}),Pe("succesfully created data","success"),R==null||R(!0)}catch{R==null||R()}};function Y(){let a=[],t=parseInt(f);for(let C=0;C<t;C++)a.push({destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date,allowances:[],detail_attedances:[]});d.setValue("destinations",a)}const{fields:U,append:w,remove:k,update:B}=G({control:d.control,name:"destinations"});v.useEffect(()=>{Y(),c&&x==Ne.edit&&y()},[f,P,c,x,n,h]);const[M,ne]=v.useState(!1),re=a=>{ne(a)},W=V({control:d.control,name:"total_percent"}),[le,ie]=v.useState(0),J=le;return v.useEffect(()=>{const t=parseFloat((W||"0").toString())/100*J;d.setValue("total_cash_advance",t.toFixed(0))},[W,J]),e.jsx(_e,{className:"h-[600px] w-full ",children:e.jsx(ce,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(D),children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request No."}),e.jsx("td",{children:"ODR-2023"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussiness Trip Purpose Type"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:d.control,name:"purpose_type_id",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{onValueChange:t=>z(t),value:a.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Bussiness Purpose Type --"})}),e.jsx(E,{children:s.map(t=>e.jsx(N,{value:t.id.toString(),children:t.name}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request For"}),e.jsx("td",{children:e.jsx(u,{control:d.control,name:"request_for",render:({field:a})=>(n==="user"&&!a.value&&a.onChange(h.toString()),e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{onValueChange:t=>a.onChange(t),value:a.value,disabled:n==="user",children:[e.jsx(F,{className:"w-[200px] py-2",children:e.jsx(q,{placeholder:"-- Select Business Purpose Type --"})}),e.jsx(E,{children:n==="admin"?r.map(t=>e.jsx(N,{value:t.id.toString(),children:t.name},t.id)):r.filter(t=>t.id===h).map(t=>e.jsx(N,{value:t.id.toString(),children:t.name},t.id))})]})}),e.jsx(_,{})]}))})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Cost Center"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:d.control,name:"cost_center_id",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{onValueChange:t=>a.onChange(t),value:a.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Cost Center --"})}),e.jsx(E,{children:o.map(t=>e.jsx(N,{value:t.id.toString(),children:t.cost_center}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:d.control,name:"pajak_id",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{onValueChange:t=>a.onChange(t),value:a.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Pajak --"})}),e.jsx(E,{children:i.map(t=>e.jsx(N,{value:t.id.toString(),children:t.mwszkz}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:d.control,name:"purchasing_group_id",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{onValueChange:t=>a.onChange(t),value:a.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Purchasing Group --"})}),e.jsx(E,{children:g.map(t=>e.jsx(N,{value:t.id.toString(),children:t.purchasing_group}))})]})}),e.jsx(_,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(u,{control:d.control,name:"remark",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(me,{placeholder:"Insert remark",...a,rows:4,className:"w-[300px]"})}),e.jsx(_,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Attachment"}),e.jsx("td",{children:e.jsx(u,{control:d.control,name:"attachment",render:({field:a})=>e.jsxs(j,{children:[e.jsx(oe,{className:"text-xs text-gray-500 font-extralight mb-1",children:"Max File: 1000KB"}),e.jsx(m,{children:e.jsx("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-xs shadow-sm transition-colors file:border-0 file:bg-transparent file:text-xs file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",type:"file",onChange:t=>{var I;const C=(I=t.target.files)==null?void 0:I[0];C?a.onChange(C):a.onChange(null)}})}),e.jsx(_,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Extension"}),e.jsx("td",{className:"text-gray-500 text-xs font-extralight",children:"doc,jpg,ods,png,txt,pdf"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Total Destination"}),e.jsxs("td",{children:[" ",e.jsx(u,{control:d.control,name:"total_destination",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{value:f,onValueChange:S,children:[e.jsx(F,{className:"w-[200px] py-2",children:e.jsx(q,{placeholder:"-- Select Bussiness Trip --"})}),e.jsx(E,{children:Array.from({length:5},(t,C)=>e.jsxs(N,{value:(C+1).toString(),children:[" ",C+1," "]}))})]})}),e.jsx(_,{})]})})]})]})]}),e.jsx(ge,{className:"my-4"}),e.jsx(Q,{updateDestination:B,destinationField:U,form:d,listAllowances:P,totalDestination:d.getValues("total_destination").toString(),setTotalAllowance:ie}),e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Cash Advance"}),e.jsx("td",{className:"w-[50%] pb-0",children:e.jsx(Fe,{fieldName:"cash_advance",isRequired:!1,disabled:!1,onChanges:a=>re(a.target.checked)})})]}),M&&e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Total Percent"}),e.jsxs("td",{className:"w-[50%]",children:[e.jsx(u,{control:d.control,name:"total_percent",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{value:a.value||void 0,onValueChange:t=>a.onChange(t),children:[e.jsx(F,{className:"w-[50%] mb-2",children:e.jsx(q,{placeholder:"-- Select Option --"})}),e.jsxs(E,{children:[e.jsx(N,{value:"10",children:"10"}),e.jsx(N,{value:"25",children:"25"}),e.jsx(N,{value:"50",children:"50"})]})]})}),e.jsx(_,{})]})}),e.jsx(u,{control:d.control,name:"total_cash_advance",render:({field:a})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{value:a.value||"",readOnly:!0,className:"w-[50%]"})}),e.jsx(_,{})]})})]})]})})]}),e.jsx(H,{type:"submit",children:"submit"})]})})})};function Q({totalDestination:r,listAllowances:s,destinationField:i,form:o,updateDestination:g,setTotalAllowance:x}){return v.useState(),v.useState(),v.useState(0),e.jsxs(fe,{defaultValue:"destination1",className:"w-full",children:[e.jsx(be,{className:"flex items-center justify-start space-x-4",children:i.map((c,n)=>e.jsxs(we,{value:`destination${n+1}`,children:["Destination ",n+1]}))}),i.map((c,n)=>e.jsx(X,{listAllowances:s,updateDestination:g,destination:c,form:o,index:n,setTotalAllowance:x}))]})}function X({form:r,index:s,destination:i,updateDestination:o,listAllowances:g,setTotalAllowance:x}){const{fields:c,update:n,append:h,remove:b}=G({control:r.control,name:`destinations.${s}.detail_attedances`}),{fields:f,update:p,append:d,remove:y,replace:P}=G({control:r.control,name:`destinations.${s}.allowances`});function L(){let S=$(i.business_trip_start_date).startOf("day"),D=$(i.business_trip_end_date).startOf("day");for(b(),y();S.isBefore(D)||S.isSame(D);){const w={date:S.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};h(w),S=S.add(1,"days")}function Y(w){let k=$(i.business_trip_start_date),B=$(i.business_trip_end_date),M=[];for(;k.isBefore(B)||k.isSame(B);)M.push({date:k.toDate(),request_price:w}),k=k.add(1,"days");return M}let U=g.map(w=>({name:w.name,code:w.code,default_price:parseInt(w.grade_price),type:w.type,subtotal:parseInt(w.grade_price),currency:w.currency_id,request_value:w.request_value,detail:w.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(w.grade_price)}]:Y(w.grade_price)}));P(U)}function z(S){o(s,{...i,business_trip_end_date:S})}return e.jsxs(ye,{value:`destination${s+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",i.destination]}),e.jsx("td",{children:e.jsx(u,{control:r.control,name:`destinations.${s}.destination`,render:({field:S})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsxs(A,{onValueChange:D=>{o(s,{...i,destination:D})},defaultValue:i.destination,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"Destination"})}),e.jsxs(E,{children:[e.jsx(N,{value:"jakarta",children:"Jakarta"}),e.jsx(N,{value:"banyuwangi",children:"Banyuwangi"})]})]})}),e.jsx(_,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(u,{control:r.control,name:`destinations.${s}.business_trip_start_date`,render:({field:S})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(K,{initialDate:i.business_trip_start_date,onDateChange:D=>{o(s,{...i,business_trip_start_date:D})}})}),e.jsx(_,{})]})}),e.jsx("span",{children:"To"}),e.jsx(u,{control:r.control,name:`destinations.${s}.business_trip_end_date`,render:({field:S})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(K,{initialDate:i.business_trip_end_date,onDateChange:D=>{z(D)}})}),e.jsx(_,{})]})}),e.jsx(H,{type:"button",onClick:()=>L(),children:"Get Detail"})]})]})]}),e.jsx(te,{detailAttedanceFields:c,form:r,updateAttedanceFields:n,destinationIndex:s}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(se,{allowanceField:f,destinationIndex:s,form:r})]},s),e.jsx(Z,{allowanceField:f,destinationIndex:s,form:r,setTotalAllowance:x})]})}function Z({allowanceField:r,destinationIndex:s,form:i,setTotalAllowance:o}){const[g,x]=v.useState(0);v.useEffect(()=>{const n=r.reduce((h,b,f)=>{const p=i.getValues(`destinations.${s}.allowances.${f}.detail`),d=c(b,p);return h+d},0);x(n),o(n)},[r,i.watch()]);const c=(n,h)=>{var b;return n.type==="total"?parseFloat(((b=h==null?void 0:h[0])==null?void 0:b.request_price)||0):h==null?void 0:h.reduce((f,p)=>f+parseFloat(p.request_price||0),0)};return e.jsx(e.Fragment,{children:e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-[50%]",children:"Item"}),e.jsx("th",{className:"w-[50%]",children:"Sub Total"})]})}),e.jsx("tbody",{children:r.map((n,h)=>e.jsx(ee,{allowance:n,destinationIndex:s,form:i,allowanceIndex:h}))}),e.jsx("tfoot",{className:"mt-4",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{children:e.jsx("i",{children:"Total Allowance"})}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:e.jsx("i",{children:"IDR"})}),e.jsx("span",{children:e.jsx("i",{children:g})})]})]})})]})})}function ee({allowance:r,destinationIndex:s,form:i,allowanceIndex:o}){const g=V({control:i.control,name:`destinations.${s}.allowances.${o}.detail.0.request_price`}),x=V({control:i.control,name:`destinations.${s}.allowances.${o}.detail`}),c=()=>{if(r.type==="total")return parseFloat(g||0)*1;{let n=0;return x==null||x.forEach(h=>{const b=parseFloat(h.request_price||0);n+=b}),n}};return e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:"IDR"}),e.jsx("span",{children:c()})]})]},r.id)}function te({form:r,destinationIndex:s,detailAttedanceFields:i,updateAttedanceFields:o}){const g=r.watch(`destinations.${s}.detail_attedances`);return v.useEffect(()=>{},[g]),v.useEffect(()=>{},[i]),e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsx("div",{className:"mb-4 text-sm",children:"Detail Attedance: "})})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("table",{className:"detail-attedance text-xs",children:[e.jsxs("thead",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Shift code"}),e.jsx("th",{children:"Shift Start"}),e.jsx("th",{children:"Shift End"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"})]}),e.jsx("tbody",{children:i.map((x,c)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[$(x.date).format("DD/MM/YYYY"),e.jsx(u,{control:r.control,name:`destinations.${s}.detail_attedances.${c}.date`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{defaultValue:$(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsxs("td",{children:[x.shift_code,e.jsx(u,{control:r.control,name:`destinations.${s}.detail_attedances.${c}.shift_code`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{defaultValue:$(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsxs("td",{children:[x.shift_start,e.jsx(u,{control:r.control,name:`destinations.${s}.detail_attedances.${c}.shift_start`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{defaultValue:$(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsxs("td",{children:[x.shift_end,e.jsx(u,{control:r.control,name:`destinations.${s}.detail_attedances.${c}.shift_end`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{defaultValue:$(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(_,{})]})})]}),e.jsx("td",{children:e.jsx(u,{control:r.control,name:`destinations.${s}.detail_attedances.${c}.start_time`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(_,{})]})})}),e.jsx("td",{children:e.jsx(u,{control:r.control,name:`destinations.${s}.detail_attedances.${c}.end_time`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(_,{})]})})})]},x.index))})]})})})]})}function se({form:r,destinationIndex:s,allowanceField:i}){return e.jsx("table",{className:"w-full allowance-table",children:i.map((o,g)=>e.jsx(ae,{form:r,allowance:o,destinationIndex:s,allowanceIndex:g}))})}function ae({form:r,allowance:s,destinationIndex:i,allowanceIndex:o}){const[g,x]=v.useState(!1),c=p=>{x(d=>!d)},n=V({control:r.control,name:`destinations.${i}.allowances.${o}.detail.0.request_price`}),h=V({control:r.control,name:`destinations.${i}.allowances.${o}.detail`}),b=()=>{if(s.type==="total")return parseFloat(n||0)*1;{let p=0;return h==null||h.forEach(d=>{const y=parseFloat(d.request_price||0);p+=y}),p}},f=p=>d=>{const y=parseFloat(d.target.value)||0;s.request_value==="unlimited"?p.onChange(d):s.request_value==="up to max value"?y<=s.subtotal?p.onChange(d):alert(`Value cannot exceed the subtotal of IDR ${s.subtotal}`):s.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:s.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:s.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:s.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{control:r.control,name:`destinations.${i}.allowances.${o}.detail.0.request_price`,render:({field:p})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{value:p.value,onChange:f(p)})}),e.jsx(_,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",s.detail.length," Days * ",s.subtotal," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",b()]})})}),s.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>c(),children:e.jsxs(H,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},s.id),g&&e.jsx(e.Fragment,{children:s.detail.map((p,d)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:$(p.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(u,{control:r.control,name:`destinations.${i}.allowances.${o}.detail.${d}.request_price`,render:({field:y})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{value:y.value,onChange:f(y)})}),e.jsx(_,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},p.id))})]})}function Ee({form:r,type:s,allowanceIndex:i,destinationIndex:o}){const{fields:g}=G({control:r.control,name:`destinations.${o}.allowances.${i}.detail`});return e.jsx(e.Fragment,{children:g.map((x,c)=>e.jsx(u,{control:r.control,name:`destinations.${o}.allowances.${c}.detail.${c}.request_price`,render:({field:n})=>e.jsxs(j,{children:[e.jsx(m,{children:e.jsx(T,{value:n.value,onChange:n.onChange})}),e.jsx(_,{})]})}))})}function Pe(r,s){throw new Error("Function not implemented.")}function R(r){throw new Error("Function not implemented.")}const at=Object.freeze(Object.defineProperty({__proto__:null,AllowanceInputForm:Ee,AllowanceRowInput:ae,BussinesTripDestination:Q,BussinessDestinationForm:X,BussinessTripFormV1:qe,DetailAllowance:se,DetailAttedances:te,ResultPerItem:ee,ResultTotalItem:Z},Symbol.toStringTag,{value:"Module"}));export{qe as B,st as D,tt as G,at as a};
