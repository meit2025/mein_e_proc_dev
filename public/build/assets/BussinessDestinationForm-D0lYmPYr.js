import{r as K,j as e}from"./app-BDU16s5X.js";import{F as h,a as j,b as f,c as b}from"./form-CLGJuOMH.js";import{B as Q}from"./button-vHkKZCED.js";import{b as D}from"./index.esm-4u4-aKHq.js";/* empty css              */import{c as V}from"./tabs-CFD0Dp35.js";import{C as I}from"./CustomDatePicker-CDZvm1H6.js";import{h as u}from"./moment-C5S46NFB.js";import{F as x}from"./formDropdown-tZYTpLe2.js";import{DetailAttedances as W}from"./DetailAttedances-C6T2s920.js";import{DetailAllowance as X}from"./DetailAllowance-TVd4hYv-.js";import{ResultTotalItem as Y}from"./ResultTotalItem-C_ZUwa4c.js";import{C as Z}from"./checkbox-D5mKQjpy.js";import"./app-DQK4SJPx.js";import"./index-CVnRQzb-.js";import"./utils-7ptpAUXx.js";import"./index-B2h_I9_s.js";import"./index-Bb4qSo10.js";import"./index-FkzXB5Ex.js";import"./index-7ckTQ1yi.js";import"./index-BCILxUso.js";import"./index-Forjrvux.js";import"./index-DoTnDc1r.js";import"./index-DuRrwXyd.js";import"./Combination-XorUIBqb.js";import"./createLucideIcon-BFy8GcIp.js";import"./TextField-P-WgsuZo.js";import"./createSvgIcon--sap8KVU.js";import"./DefaultPropsProvider-CONd5zvO.js";import"./useSlot-CimZv8Lc.js";import"./createSimplePaletteValueFilter-DzjIFdoE.js";import"./useControlled-DrZA3PWm.js";import"./FormHelperText-DRsRrox7.js";import"./input-DCeK1uKe.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-CA-4qQ9x.js";import"./index-DVVXTDB9.js";function Pe({key:S,form:n,index:t,destination:a,updateDestination:d,listAllowances:$,setTotalAllowance:B,pajak:ee,purchasingGroup:te,dataTax:q,dataPurchasingGroup:E,dataDestination:O,type:w,btClone:g,setSelectedDates:m,selectedDates:A}){const{fields:G,update:T,append:L,remove:P}=D({control:n.control,name:`destinations.${t}.detail_attedances`}),{fields:v,update:se,append:re,remove:H,replace:M}=D({control:n.control,name:`destinations.${t}.allowances`});function U(){let s=u(a.business_trip_start_date).startOf("day");const r=u(a.business_trip_end_date).startOf("day");for(P(),H();s.isBefore(r)||s.isSame(r);){const o={date:s.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};L(o),s=s.add(1,"days")}function i(o){let p=u(a.business_trip_start_date).startOf("day");const y=u(a.business_trip_end_date).startOf("day"),R=[];for(;p.isBefore(y)||p.isSame(y);)R.push({date:p.toDate(),request_price:o}),p=p.add(1,"days");return R}const l=$.map(o=>({name:o.name,code:o.code,default_price:parseInt(o.grade_price),type:o.type,subtotal:parseInt(o.grade_price),currency:o.currency_id,request_value:o.request_value,detail:o.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(o.grade_price)}]:i(o.grade_price)}));M(l)}const C=(s,r)=>{m(i=>{const l=[...i];return l[r]={...l[r],from:s},l})},F=(s,r)=>{d(r,{...a,business_trip_end_date:s}),m(i=>{const l=[...i];return l[r]={...l[r],to:s},l})},[k,c]=K.useState(),_={};k&&(_.selected=k);const N=(s,r)=>{r==="start"&&(d(s,{...a,business_trip_start_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],from:void 0},l})),r==="end"&&(d(s,{...a,business_trip_end_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],to:void 0},l})),c(void 0)};let z=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>N(t,"start"),children:"Reset"})}),J=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>N(t,"end"),children:"Reset"})});return e.jsxs(V,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:O,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,destination:s})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Restricted Area"}),e.jsx("td",{children:e.jsx(h,{control:n.control,name:`destinations.${t}.restricted_area`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(Z,{checked:a.restricted_area,onCheckedChange:r=>{d(t,{...a,restricted_area:r})}})}),e.jsx(b,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Pajak",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:q,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,pajak_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Purchasing Group",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:E,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,purchasing_group_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(h,{control:n.control,name:`destinations.${t}.business_trip_start_date`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(I,{initialDate:a.business_trip_start_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(C(void 0,t),c(void 0),d(t,{...a,business_trip_start_date:void 0,business_trip_end_date:void 0})):(C(r,t),c(r),d(t,{...a,business_trip_start_date:r,business_trip_end_date:r}))},disabled:!1,disabledDays:A,footer:z})}),e.jsx(b,{})]})}),e.jsx("span",{children:"To"}),e.jsx(h,{control:n.control,name:`destinations.${t}.business_trip_end_date`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(I,{initialDate:a.business_trip_end_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(F(void 0,t),c(void 0),d(t,{...a,business_trip_end_date:void 0})):(F(r,t),c(r),d(t,{...a,business_trip_end_date:r}))},disabled:!1,disabledDays:A,footer:J})}),e.jsx(b,{})]})}),e.jsx(Q,{type:"button",onClick:()=>U(),children:"Get Detail"})]})]})]}),e.jsx(W,{detailAttedanceFields:G,form:n,updateAttedanceFields:T,destinationIndex:t,type:w,btClone:g}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(X,{allowanceField:v,destinationIndex:t,form:n,type:w,btClone:g})]},t),e.jsx(Y,{allowanceField:v,destinationIndex:t,form:n,setTotalAllowance:B})]},S)}export{Pe as BussinessDestinationForm};
