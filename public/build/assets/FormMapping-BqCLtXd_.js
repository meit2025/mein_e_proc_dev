import{j as s,r as N,u as A,b as C}from"./app-D8_IGLVi.js";import{a as I}from"./axiosInstance-DuZz-HMU.js";import{F as R}from"./formInput-D86Clm_m.js";import{F as k}from"./formDropdown-XbIpK9gp.js";import{F as $}from"./formCheckbox-BHdhaj1J.js";import{a as E,C as S,F as P}from"./index.esm-BdxxVNAE.js";import{A as B,T as H,b as W,I as _}from"./TextField-CCAmSNjW.js";import{F as T}from"./FormHelperText-war5HFOH.js";import{F as z}from"./formTextArea-Bkl8J2Wb.js";import{F as D}from"./formSwitch-RlJffqC2.js";import{L as G}from"./Loading-XLGKJd5r.js";const J=({fieldLabel:e,fieldName:a,isRequired:x=!1,disabled:b=!1,style:j,requiredMessage:y,options:o=[],placeholder:F,classNames:q,onChangeOutside:d})=>{const{control:f,formState:{errors:h}}=E();return s.jsx(S,{name:a,control:f,rules:{required:x?y??`${e} is required`:!1},render:({field:p})=>{var g;return s.jsxs("div",{style:j,className:q,children:[s.jsx(B,{...p,multiple:!0,options:o,getOptionLabel:t=>t.label,isOptionEqualToValue:(t,n)=>t.value===n,onChange:(t,n)=>{p.onChange(n.map(l=>l.value)),d&&d(n.map(l=>l.value))},value:o.filter(t=>{var n;return(n=p.value)==null?void 0:n.includes(t.value)}),disabled:b,renderInput:t=>s.jsx(H,{...t,label:e,placeholder:F,error:!!h[a],required:x}),renderTags:(t,n)=>t.map((l,c)=>N.createElement(W,{label:l.label,...n({index:c}),key:c}))}),h[a]&&s.jsx(T,{error:!0,children:String((g=h[a])==null?void 0:g.message)})]})}})},K=({fieldLabel:e,fieldName:a,isRequired:x=!1,disabled:b=!1,style:j,requiredMessage:y,allowedExtensions:o=[],classNames:F,onFileChangeOutside:q})=>{const[d,f]=N.useState(null),{control:h,formState:{errors:p},setError:g,clearErrors:t}=E(),n=(l,c)=>{var i;const r=l.target.files?l.target.files[0]:null;if(r){const m=(i=r.name.split(".").pop())==null?void 0:i.toLowerCase();if(o.length>0&&m&&!o.includes(m)){c(null),f(null),g(a,{type:"manual",message:`Invalid file type. Allowed types: ${o.join(", ")}`});return}t(a),f(r.name),c(r),q&&q(r)}else c(null),f(null),t(a)};return s.jsx(S,{name:a,control:h,rules:{required:x?y??`${e} is required`:!1},render:({field:l})=>{var c;return s.jsxs("div",{style:j,className:F,children:[s.jsx("label",{children:e}),s.jsx(_,{type:"file",disabled:b,onChange:r=>n(r,l.onChange)}),d&&s.jsxs("p",{children:["Selected file: ",d]}),p[a]&&s.jsx(T,{error:!0,children:String((c=p[a])==null?void 0:c.message)})]})}})},O=({model:e,onChangeOutside:a})=>{switch(e.type){case"input":return s.jsx(R,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,type:e.texttype,requiredMessage:e.requiredMessage,placeholder:e.placeholder,minLength:e.minLength,maxLength:e.maxLength,classNames:e.classNames,icon:e.icon});case"textarea":return s.jsx(z,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames});case"select":return s.jsx(k,{options:e.options??[],fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames,onChangeOutside:a});case"checkbox":return s.jsx($,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,classNames:e.classNames});case"multiselect":return s.jsx(J,{options:e.options??[],fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames,onChangeOutside:a});case"switch":return s.jsx(D,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,classNames:e.classNames});case"file":return s.jsx(K,{fieldLabel:e.label??"",fieldName:e.name??"",allowedExtensions:e.allowedExtensions,disabled:e.disabled,onFileChangeOutside:a});default:return null}},ie=({formModel:e,url:a,redirectUrl:x,methods:b,onSave:j,isLoading:y,classForm:o,isCustom:F=!1,formCustom:q,formLogic:d,disableButtonSubmit:f=!1})=>{const{setError:h,watch:p}=b,{showToast:g}=A(),[t,n]=N.useState(!1),l=async r=>{var i,m,v,L;n(!0);try{const u=await I.post(a,r,{headers:{"Content-Type":"application/json"}});g(u.data.message??"success","success"),j&&await j(u),x&&setTimeout(()=>{window.location.href=x},2e3)}catch(u){if(C.isAxiosError(u)&&((m=(i=u.response)==null?void 0:i.data)!=null&&m.message)&&g(u.response.data.message,"error"),C.isAxiosError(u)&&((L=(v=u.response)==null?void 0:v.data)!=null&&L.errors)){const M=u.response.data.errors;Object.keys(M).forEach(w=>{h(w,{type:"server",message:M[w].join(", ")})})}}n(!1)};function c(r,i,m="="){switch(m){case"=":return r===i;case">":return r>i;case"<":return r<i;case">=":return r>=i;case"<=":return r<=i;case"!==":return r!==i;default:return r===i}}return s.jsxs(P,{...b,children:[s.jsx(G,{isLoading:y||t}),s.jsxs("form",{onSubmit:b.handleSubmit(l),children:[s.jsxs("div",{className:o,children:[F?s.jsx(s.Fragment,{children:q}):s.jsx(s.Fragment,{children:(e??[]).map((r,i)=>s.jsx("div",{className:`mt-8 ${r.classPosition}`,children:r.fieldCustome?r.fieldCustomeValue:s.jsx(s.Fragment,{children:!r.conditional||c(p(r.parameterConditional??""),r.valueConditional,r.conditionalType)?s.jsx(O,{model:r}):null})},i))}),d]}),!f&&s.jsx("div",{className:"flex justify-end mt-8",children:s.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",children:"Submit"})})]})]})};export{ie as F};
