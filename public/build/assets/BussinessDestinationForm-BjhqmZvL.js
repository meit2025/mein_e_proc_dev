import{j as e}from"./app-4xTslrwp.js";import{F as j,a as f,b as w,c as x}from"./form-BLbC4Gcr.js";import{B as R}from"./button-BeOI8Olf.js";import{b}from"./index.esm-BgllR54e.js";/* empty css              */import{c as G}from"./tabs-4yG4kL5C.js";import{C as g}from"./CustomDatePicker-DVmhe1QE.js";import{h as p}from"./moment-C5S46NFB.js";import{F as m}from"./formDropdown-C2RFY2B2.js";import{DetailAttedances as T}from"./DetailAttedances-3RvXXfvn.js";import{DetailAllowance as L}from"./DetailAllowance-CxGfzxQ2.js";import{ResultTotalItem as P}from"./ResultTotalItem-CHmiWaDE.js";import"./app-HlhieNAw.js";import"./index-Cq2L1Y7s.js";import"./utils-BwCb8yMi.js";import"./index-Bb4qSo10.js";import"./index-lyFOcq1z.js";import"./index-DyWrWlAK.js";import"./index-CgKoMc_3.js";import"./index-2tuttlJ3.js";import"./index-CJHW0s66.js";import"./index-C6P8zuf9.js";import"./index-BBlqi0tC.js";import"./popover-E0wgABQm.js";import"./Combination-CRSFkbxJ.js";import"./createLucideIcon-CHkKBelL.js";import"./TextField-BRBBkqox.js";import"./createSimplePaletteValueFilter-Dvc2jE_N.js";import"./DefaultPropsProvider-Dgec_S5u.js";import"./extends-CF3RwP-h.js";import"./useSlot-WbFfNdBj.js";import"./FormHelperText-YH-beue1.js";import"./input-Cu7ugxi2.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-r_3hYR5p.js";function Ce({form:a,index:t,destination:i,updateDestination:d,listAllowances:A,setTotalAllowance:F,pajak:H,purchasingGroup:M,dataTax:D,dataPurchasingGroup:$,dataDestination:C,type:l,btEdit:n}){const{fields:N,update:k,append:I,remove:v}=b({control:a.control,name:`destinations.${t}.detail_attedances`}),{fields:u,update:U,append:z,remove:B,replace:S}=b({control:a.control,name:`destinations.${t}.allowances`});function q(){let r=p(i.business_trip_start_date).startOf("day");const o=p(i.business_trip_end_date).startOf("day");for(v(),B();r.isBefore(o)||r.isSame(o);){const s={date:r.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};I(s),r=r.add(1,"days")}function y(s){let c=p(i.business_trip_start_date).startOf("day");const _=p(i.business_trip_end_date).startOf("day"),h=[];for(;c.isBefore(_)||c.isSame(_);)h.push({date:c.toDate(),request_price:s}),c=c.add(1,"days");return h}const O=A.map(s=>({name:s.name,code:s.code,default_price:parseInt(s.grade_price),type:s.type,subtotal:parseInt(s.grade_price),currency:s.currency_id,request_value:s.request_value,detail:s.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(s.grade_price)}]:y(s.grade_price)}));S(O)}return e.jsxs(G,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",i.destination]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:C,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.destination`):!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,destination:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:D,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.pajak_id`):!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,pajak_id:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:$,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:l==n?!!a.watch(`destinations.${t}.purchasing_group_id`):!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:r=>{d(t,{...i,purchasing_group_id:r})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(j,{control:a.control,name:`destinations.${t}.business_trip_start_date`,render:({field:r})=>e.jsxs(f,{children:[e.jsx(w,{children:e.jsx(g,{initialDate:i.business_trip_start_date,onDateChange:o=>{d(t,{...i,business_trip_start_date:o})},disabled:l==n?!!a.watch(`destinations.${t}.business_trip_start_date`):!1})}),e.jsx(x,{})]})}),e.jsx("span",{children:"To"}),e.jsx(j,{control:a.control,name:`destinations.${t}.business_trip_end_date`,render:({field:r})=>e.jsxs(f,{children:[e.jsx(w,{children:e.jsx(g,{initialDate:i.business_trip_end_date,onDateChange:o=>{d(t,{...i,business_trip_end_date:o})},disabled:l==n?!!a.watch(`destinations.${t}.business_trip_end_date`):!1})}),e.jsx(x,{})]})}),e.jsx(R,{type:"button",className:l==n&&a.watch(`destinations.${t}.destination`)?"hidden":"",onClick:()=>q(),children:"Get Detail"})]})]})]}),e.jsx(T,{detailAttedanceFields:N,form:a,updateAttedanceFields:k,destinationIndex:t,type:l,btEdit:n}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(L,{allowanceField:u,destinationIndex:t,form:a,type:l,btEdit:n})]},t),e.jsx(P,{allowanceField:u,destinationIndex:t,form:a,setTotalAllowance:F})]})}export{Ce as BussinessDestinationForm};
