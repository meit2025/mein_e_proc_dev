import{j as e,r as i,u as je,q as ue,a as S,b as fe}from"./app-DT9oxaOb.js";import{a as H}from"./axiosInstance-CCIKLaiQ.js";import{D as we,b as ve,c as ye}from"./dialog-T_wPQTYB.js";import{B as U}from"./button--eB67zHQ.js";import{L as ke}from"./LoadingSpin-Bu6XX1u1.js";import{D as Ce,a as Se,b as be,c as Ne,d as D,e as V}from"./dropdown-menu-D_uHx59x.js";import{D as $e}from"./index-pfNXkOFO.js";import{c as X}from"./createLucideIcon-BXQGbN7f.js";import{B as b}from"./Box-CUOiY_EY.js";import{T as Me,a as W}from"./Tabs-D76cuhH0.js";import{B as De}from"./Button-s4xr3tQ2.js";import{D as Ue}from"./DataGrid-0RuIKiai.js";const Fe=({open:m,onOpenChange:F,onDelete:j,onClose:a,children:z,className:n,isLoading:x,title:l,description:g})=>e.jsx(we,{open:m,onOpenChange:a,children:e.jsxs(ve,{className:n||"md:max-w-[768px]",children:[g||"Are you sure delete this item?",e.jsxs(ye,{children:[a?e.jsx(U,{variant:"outline",onClick:a,children:"Close"}):null,j?e.jsx(e.Fragment,{children:x?e.jsx(ke,{}):e.jsx(U,{type:"submit",onClick:j,children:"Delete"})}):null]})]})});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=X("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=X("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),G=m=>({id:`simple-tab-${m}`,"aria-controls":`simple-tabpanel-${m}`}),Xe=({columns:m,buttonCustome:F,onExport:j,url:a,labelFilter:z="Search",onEdit:n,onDelete:x,onDetail:l,onCreate:g,defaultSearch:B,actionType:J,buttonActionCustome:T,deleteConfirmationText:K,titleConfirmationText:Te,isHistory:Q=!1,role:s})=>{var R,O,_;const[Y,Z]=i.useState([]),[E,L]=i.useState(!1),[d,ee]=i.useState({page:0,pageSize:10}),[u,se]=i.useState([]),[f,te]=i.useState({items:[]}),[A,N]=i.useState(null),[ae,v]=i.useState(!1),[y,ie]=i.useState(0),[ne,re]=i.useState(0),[w,le]=i.useState(""),[de,ce]=i.useState(""),{showToast:$}=je(),{props:I}=ue(),h=((R=I.auth)==null?void 0:R.permission)||[],k=i.useCallback(async(t,r,C,p,c,M)=>{L(!0);const pe=p.length>0?p[0].field:"id",me=p.length>0?p[0].sort:"asc",ge=c.items.map(o=>`${o.field}=${o.operator},${o.value}`).join("&");try{const o=`${B||"?"}page=${t+1}&per_page=${r}&search=${C}&sort_by=${pe}&sort_direction=${me}&approval=${M}&${ge}`;ce(o);const q=await H.get(`${a.url}${o}`);Z(q.data.data.data),re(q.data.data.total)}catch(o){console.error("Error fetching data:",o)}finally{L(!1)}},[a]);i.useEffect(()=>{k(d.page,d.pageSize,w,u,f,0)},[k,f,d,w,u]);const P=async t=>{var r,C,p;v(!0);try{const c=await H.delete(`${a.deleteUrl}/${t}`);$(((r=c==null?void 0:c.data)==null?void 0:r.message)||"Record deleted successfully","success"),v(!1),N(null),x&&await x(t),k(d.page,d.pageSize,w,u,f,0)}catch(c){if(v(!1),fe.isAxiosError(c)){const M=((p=(C=c.response)==null?void 0:C.data)==null?void 0:p.message)||"Failed to delete record";$(M,"error")}else $("An unexpected error occurred","error");v(!1)}},oe=t=>{N(t)},xe=n||x||l||a.detailUrl||a.editUrl||a.deleteUrl||T?[{field:"actions",headerName:"Actions",width:150,renderCell:t=>e.jsx(e.Fragment,{children:J==="dropdown"?e.jsxs(Ce,{children:[e.jsx(Se,{asChild:!0,children:e.jsxs(U,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"..."}),e.jsx($e,{className:"h-4 w-4"})]})}),e.jsxs(be,{align:"end",children:[e.jsx(Ne,{children:"Actions"}),(n||a.editUrl)&&y===0&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.update)??""))&&e.jsx(D,{onClick:()=>n&&n(t.row.id),children:e.jsxs("span",{className:"flex items-center text-sm space-x-2",children:[e.jsx("span",{children:"Edit"}),e.jsx(ze,{size:14})]})})}),e.jsx(V,{}),(a.deleteUrl||x)&&y===0&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.delete)??""))&&e.jsx(D,{className:"bg-red-400 text-white hover:!bg-red-500 hover:!text-white transition-all duration-300",onClick:()=>oe(t.row.id),children:e.jsxs("span",{className:"flex items-center  text-sm space-x-2",children:[e.jsx("span",{children:"Delete"}),e.jsx(Be,{size:14})]})})}),e.jsx(V,{}),(l||a.detailUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.detail)??""))&&e.jsx(D,{onClick:()=>{l&&l(t.row.id),a.detailUrl&&(window.location.href=`${a.detailUrl}/${t.row.id}`)},children:"View details"})})]})]}):e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(l||a.detailUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.detail)??""))&&e.jsx(S,{href:a.detailUrl===""?"#":`${a.detailUrl}/${t.row.id}`,onClick:r=>{l&&(r.preventDefault(),l&&l(t.row.id))},alt:"detail",children:e.jsx("i",{className:" ki-duotone ki-size text-info text-2xl"})})}),(n||a.editUrl)&&y===0&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.update)??""))&&e.jsx(S,{href:a.editUrl===""?"#":`${a.editUrl}/${t.row.id}`,onClick:r=>{n&&(r.preventDefault(),n&&n(t.row.id))},alt:"edit",children:e.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})})}),(a.deleteUrl||x)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.delete)??""))&&e.jsx(S,{href:"",onClick:()=>P(t.row.id),alt:"delete",children:e.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})}),T]})})}]:[],he=(t,r)=>{ie(r),k(d.page,d.pageSize,w,u,f,r)};return e.jsx(b,{children:e.jsx(b,{sx:{height:"45rem",width:"100%",overflowX:"auto"},children:e.jsxs(b,{sx:{width:"100%"},children:[Q&&((_=(O=I.auth)==null?void 0:O.user)==null?void 0:_.is_approval)&&e.jsx(b,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Me,{value:y,onChange:he,"aria-label":"dynamic tabs example",children:[e.jsx(W,{label:"List",...G(0)},0),e.jsx(W,{label:"Approval",...G(0)},1)]})}),e.jsx("div",{className:"lg:col-span-2 mt-2",children:e.jsx("div",{className:"grid",children:e.jsxs("div",{className:"card card-grid h-full min-w-full",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:e.jsxs("div",{className:"input input-sm max-w-48",children:[e.jsx("i",{className:"ki-filled ki-magnifier"}),e.jsx("input",{placeholder:z,type:"text",value:w,onChange:t=>le(t.target.value),style:{width:"100%",maxWidth:"200px",marginBottom:"10p"}})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(g||a.addUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.create)??""))&&e.jsxs(S,{href:a.addUrl??"#",className:"btn btn-success",onClick:t=>{g&&(t.preventDefault(),g())},style:{marginRight:"10px",marginBottom:"10px"},children:[e.jsx("i",{className:"ki-filled ki-additem"}),"Add New"]})}),j&&e.jsx(De,{className:"btn",variant:"contained",onClick:()=>j(de),color:"primary",startIcon:e.jsx("i",{className:"ki-filled ki-folder-down"}),style:{marginBottom:"10px"},children:"Export TXT"}),F]})]}),e.jsxs("div",{className:"card-body",children:[e.jsx(Fe,{isLoading:ae,description:K,open:A!==null,onClose:()=>{N(null)},onDelete:()=>P(A??0)}),e.jsx("div",{"data-datatable":"true","data-datatable-page-size":d.pageSize,children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx(Ue,{rows:Y,columns:[...m,...xe],loading:E,paginationMode:"server",rowCount:ne,paginationModel:d,onPaginationModelChange:ee,pageSizeOptions:[10,20],sortingMode:"server",sortModel:u,onSortModelChange:t=>se(t),filterMode:"server",filterModel:f,onFilterModelChange:t=>te(t)})})})]})]})})})]})})})};export{Fe as C,Xe as D};
