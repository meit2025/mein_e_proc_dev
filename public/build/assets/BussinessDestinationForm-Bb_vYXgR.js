import{r as K,j as e}from"./app-Ctvnwnyl.js";import{F as h,a as j,b as f,c as b}from"./form-Cam87w7j.js";import{B as Q}from"./button-BYFpWPz6.js";import{b as I}from"./index.esm-CH6O0ubk.js";/* empty css              */import{c as V}from"./tabs-Byf48YiW.js";import{C as S}from"./CustomDatePicker-CxO7hFh_.js";import{h as u}from"./moment-C5S46NFB.js";import{F as x}from"./formDropdown-BveLxYeX.js";import{DetailAttedances as W}from"./DetailAttedances-DEAj4g6T.js";import{DetailAllowance as X}from"./DetailAllowance-BUVzHgXg.js";import{ResultTotalItem as Y}from"./ResultTotalItem-D_yv63jq.js";import{C as Z}from"./checkbox-B7xY5iix.js";import"./app-DQK4SJPx.js";import"./index-C9FcN2Rg.js";import"./utils-DuaCSGO2.js";import"./index-_OLZzcaE.js";import"./index-WnXUKSQc.js";import"./index-Bb4qSo10.js";import"./index-DWTZdh32.js";import"./index-CLlsuzeC.js";import"./index-BD9S9B2V.js";import"./index-C7b3rV2y.js";import"./index-DmEkn0FS.js";import"./index-DZJELN6Z.js";import"./Combination-Cj59F2Zo.js";import"./createLucideIcon-GkFJEHL0.js";import"./TextField-Cvq4lUQZ.js";import"./createSvgIcon-CVJutCsf.js";import"./DefaultPropsProvider-yrEWbqjA.js";import"./useSlot-DuKlcj0D.js";import"./createSimplePaletteValueFilter-CpwnJQOf.js";import"./useControlled-C_WiV8w4.js";import"./FormHelperText-CMfROehW.js";import"./input-BGhrsul6.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-f4gyzx4O.js";import"./index-Dn0Lq5Og.js";function He({key:$,form:n,index:t,destination:a,updateDestination:d,listAllowances:g,setTotalAllowance:B,pajak:ee,purchasingGroup:te,dataTax:q,dataPurchasingGroup:E,dataDestination:O,type:w,btClone:A,setSelectedDates:m,selectedDates:v}){const{fields:G,update:T,append:L,remove:P}=I({control:n.control,name:`destinations.${t}.detail_attedances`}),{fields:C,update:se,append:re,remove:H,replace:M}=I({control:n.control,name:`destinations.${t}.allowances`});function U(){let s=u(a.business_trip_start_date).startOf("day");const r=u(a.business_trip_end_date).startOf("day");for(P(),H();s.isBefore(r)||s.isSame(r);){const o={date:s.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};L(o),s=s.add(1,"days")}function i(o){let p=u(a.business_trip_start_date).startOf("day");const R=u(a.business_trip_end_date).startOf("day"),D=[];for(;p.isBefore(R)||p.isSame(R);)D.push({date:p.toDate(),request_price:o}),p=p.add(1,"days");return D}console.log(g,"listAllowances");const l=g.map(o=>({name:o.name,code:o.code,default_price:parseInt(o.grade_price),type:o.type,subtotal:parseInt(o.grade_price),currency:o.currency_id,request_value:o.request_value,detail:o.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(o.grade_price)}]:i(o.grade_price)}));M(l)}const F=(s,r)=>{m(i=>{const l=[...i];return l[r]={...l[r],from:s},l})},k=(s,r)=>{d(r,{...a,business_trip_end_date:s}),m(i=>{const l=[...i];return l[r]={...l[r],to:s},l})},[N,c]=K.useState(),_={};N&&(_.selected=N);const y=(s,r)=>{r==="start"&&(d(s,{...a,business_trip_start_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],from:void 0},l})),r==="end"&&(d(s,{...a,business_trip_end_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],to:void 0},l})),c(void 0)};let z=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>y(t,"start"),children:"Reset"})}),J=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>y(t,"end"),children:"Reset"})});return e.jsxs(V,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:O,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,destination:s})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Restricted Area"}),e.jsx("td",{children:e.jsx(h,{control:n.control,name:`destinations.${t}.restricted_area`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(Z,{checked:a.restricted_area,onCheckedChange:r=>{d(t,{...a,restricted_area:r})}})}),e.jsx(b,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Pajak",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:q,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,pajak_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Purchasing Group",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:E,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,purchasing_group_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(h,{control:n.control,name:`destinations.${t}.business_trip_start_date`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(S,{initialDate:a.business_trip_start_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(F(void 0,t),c(void 0),d(t,{...a,business_trip_start_date:void 0,business_trip_end_date:void 0})):(F(r,t),c(r),d(t,{...a,business_trip_start_date:r,business_trip_end_date:r}))},disabled:!1,disabledDays:v,footer:z})}),e.jsx(b,{})]})}),e.jsx("span",{children:"To"}),e.jsx(h,{control:n.control,name:`destinations.${t}.business_trip_end_date`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(S,{initialDate:a.business_trip_end_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(k(void 0,t),c(void 0),d(t,{...a,business_trip_end_date:void 0})):(k(r,t),c(r),d(t,{...a,business_trip_end_date:r}))},disabled:!1,disabledDays:v,footer:J})}),e.jsx(b,{})]})}),e.jsx(Q,{type:"button",onClick:()=>U(),children:"Get Detail"})]})]})]}),e.jsx(W,{detailAttedanceFields:G,form:n,updateAttedanceFields:T,destinationIndex:t,type:w,btClone:A}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(X,{allowanceField:C,destinationIndex:t,form:n,type:w,btClone:A})]},t),e.jsx(Y,{allowanceField:C,destinationIndex:t,form:n,setTotalAllowance:B})]},$)}export{He as BussinessDestinationForm};
