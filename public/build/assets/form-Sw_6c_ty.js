import{r as s,j as e,u as Qe}from"./app-D8_IGLVi.js";import{F as Ze,a as A,b as E,c as _,d as D,e as X}from"./form-LmWjoeHk.js";import{z as N,t as et}from"./index-DSwJRTpy.js";import{B as qe}from"./button-BvcfEJId.js";import{u as tt,b as rt}from"./index.esm-BdxxVNAE.js";import{S as nt}from"./scroll-area-D2Za5zOd.js";import{S as pe,a as fe,b as he,c as xe,d as le}from"./select-lezAQztQ.js";import{I as se}from"./input-NYhmxLbQ.js";import{a as ee}from"./axiosInstance-DuZz-HMU.js";import{R as Me,a as Q}from"./radio-group-CcMiKQ0A.js";import{M as at}from"./MultiSelect-ByUVB23k.js";import{a as lt}from"./api-BySVmGlY.js";import{c as O,F as z}from"./utils-tOx6fG1W.js";import{R as st,P as it,O as ot,C as ct}from"./dialog-BfdwXA0n.js";import{P as q}from"./index-BvQVS8H4.js";import{u as H}from"./index-cy00EfdM.js";import{M as dt}from"./index-v_nXRjxs.js";import{P as ut,a as mt,b as pt}from"./popover-ypUol32A.js";import{L as ft}from"./LoadingSpin-DFrBFU8Q.js";import{C as ht}from"./chevrons-up-down-BkRzVD9i.js";import{c as xt}from"./createLucideIcon-Da4HO5iZ.js";import"./app-HlhieNAw.js";import"./index-Du0EdfFR.js";import"./index-CcTa2uZo.js";import"./Combination-B-lopDEQ.js";import"./index-Bi3J53kj.js";import"./index-B9WShZSz.js";import"./index-CfPf4i8I.js";import"./index-B2DMRqtT.js";import"./checkbox-CRHW-CaR.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=xt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var Ve=1,vt=.9,jt=.8,yt=.17,ge=.1,ve=.999,bt=.9999,wt=.99,St=/[\\\/_+.#"@\[\(\{&]/,Ct=/[\\\/_+.#"@\[\(\{&]/g,Et=/[\s-]/,Le=/[\s-]/g;function be(t,n,r,f,i,d,u){if(d===n.length)return i===t.length?Ve:wt;var g=`${i},${d}`;if(u[g]!==void 0)return u[g];for(var y=f.charAt(d),h=r.indexOf(y,i),p=0,x,k,C,R;h>=0;)x=be(t,n,r,f,h+1,d+1,u),x>p&&(h===i?x*=Ve:St.test(t.charAt(h-1))?(x*=jt,C=t.slice(i,h-1).match(Ct),C&&i>0&&(x*=Math.pow(ve,C.length))):Et.test(t.charAt(h-1))?(x*=vt,R=t.slice(i,h-1).match(Le),R&&i>0&&(x*=Math.pow(ve,R.length))):(x*=yt,i>0&&(x*=Math.pow(ve,h-i))),t.charAt(h)!==n.charAt(d)&&(x*=bt)),(x<ge&&r.charAt(h-1)===f.charAt(d+1)||f.charAt(d+1)===f.charAt(d)&&r.charAt(h-1)!==f.charAt(d))&&(k=be(t,n,r,f,h+1,d+2,u),k*ge>x&&(x=k*ge)),x>p&&(p=x),h=r.indexOf(y,h+1);return u[g]=p,p}function Ae(t){return t.toLowerCase().replace(Le," ")}function _t(t,n,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,be(t,n,Ae(t),Ae(n),0,0,{})}var De={exports:{}},Pe={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y=s;function Nt(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var kt=typeof Object.is=="function"?Object.is:Nt,It=Y.useState,Rt=Y.useEffect,Mt=Y.useLayoutEffect,Vt=Y.useDebugValue;function At(t,n){var r=n(),f=It({inst:{value:r,getSnapshot:n}}),i=f[0].inst,d=f[1];return Mt(function(){i.value=r,i.getSnapshot=n,je(i)&&d({inst:i})},[t,r,n]),Rt(function(){return je(i)&&d({inst:i}),t(function(){je(i)&&d({inst:i})})},[t]),Vt(r),r}function je(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!kt(t,r)}catch{return!0}}function Ft(t,n){return n()}var $t=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ft:At;Pe.useSyncExternalStore=Y.useSyncExternalStore!==void 0?Y.useSyncExternalStore:$t;De.exports=Pe;var qt=De.exports,Z='[cmdk-group=""]',ye='[cmdk-group-items=""]',Lt='[cmdk-group-heading=""]',Se='[cmdk-item=""]',Fe=`${Se}:not([aria-disabled="true"])`,we="cmdk-item-select",P="data-value",Dt=(t,n,r)=>_t(t,n,r),Ge=s.createContext(void 0),re=()=>s.useContext(Ge),Te=s.createContext(void 0),Ce=()=>s.useContext(Te),Oe=s.createContext(void 0),Ke=s.forwardRef((t,n)=>{let r=B(()=>{var a,m;return{search:"",value:(m=(a=t.value)!=null?a:t.defaultValue)!=null?m:"",filtered:{count:0,items:new Map,groups:new Set}}}),f=B(()=>new Set),i=B(()=>new Map),d=B(()=>new Map),u=B(()=>new Set),g=Ue(t),{label:y,children:h,value:p,onValueChange:x,filter:k,shouldFilter:C,loop:R,disablePointerSelection:j=!1,vimBindings:M=!0,...F}=t,$=H(),K=H(),U=H(),o=s.useRef(null),l=Wt();G(()=>{if(p!==void 0){let a=p.trim();r.current.value=a,S.emit()}},[p]),G(()=>{l(6,_e)},[]);let S=s.useMemo(()=>({subscribe:a=>(u.current.add(a),()=>u.current.delete(a)),snapshot:()=>r.current,setState:(a,m,v)=>{var c,b,w;if(!Object.is(r.current[a],m)){if(r.current[a]=m,a==="search")de(),oe(),l(1,ce);else if(a==="value"&&(v||l(5,_e),((c=g.current)==null?void 0:c.value)!==void 0)){let V=m??"";(w=(b=g.current).onValueChange)==null||w.call(b,V);return}S.emit()}},emit:()=>{u.current.forEach(a=>a())}}),[]),ne=s.useMemo(()=>({value:(a,m,v)=>{var c;m!==((c=d.current.get(a))==null?void 0:c.value)&&(d.current.set(a,{value:m,keywords:v}),r.current.filtered.items.set(a,Ee(m,v)),l(2,()=>{oe(),S.emit()}))},item:(a,m)=>(f.current.add(a),m&&(i.current.has(m)?i.current.get(m).add(a):i.current.set(m,new Set([a]))),l(3,()=>{de(),oe(),r.current.value||ce(),S.emit()}),()=>{d.current.delete(a),f.current.delete(a),r.current.filtered.items.delete(a);let v=W();l(4,()=>{de(),(v==null?void 0:v.getAttribute("id"))===a&&ce(),S.emit()})}),group:a=>(i.current.has(a)||i.current.set(a,new Set),()=>{d.current.delete(a),i.current.delete(a)}),filter:()=>g.current.shouldFilter,label:y||t["aria-label"],getDisablePointerSelection:()=>g.current.disablePointerSelection,listId:$,inputId:U,labelId:K,listInnerRef:o}),[]);function Ee(a,m){var v,c;let b=(c=(v=g.current)==null?void 0:v.filter)!=null?c:Dt;return a?b(a,r.current.search,m):0}function oe(){if(!r.current.search||g.current.shouldFilter===!1)return;let a=r.current.filtered.items,m=[];r.current.filtered.groups.forEach(c=>{let b=i.current.get(c),w=0;b.forEach(V=>{let L=a.get(V);w=Math.max(L,w)}),m.push([c,w])});let v=o.current;J().sort((c,b)=>{var w,V;let L=c.getAttribute("id"),ae=b.getAttribute("id");return((w=a.get(ae))!=null?w:0)-((V=a.get(L))!=null?V:0)}).forEach(c=>{let b=c.closest(ye);b?b.appendChild(c.parentElement===b?c:c.closest(`${ye} > *`)):v.appendChild(c.parentElement===v?c:c.closest(`${ye} > *`))}),m.sort((c,b)=>b[1]-c[1]).forEach(c=>{var b;let w=(b=o.current)==null?void 0:b.querySelector(`${Z}[${P}="${encodeURIComponent(c[0])}"]`);w==null||w.parentElement.appendChild(w)})}function ce(){let a=J().find(v=>v.getAttribute("aria-disabled")!=="true"),m=a==null?void 0:a.getAttribute(P);S.setState("value",m||void 0)}function de(){var a,m,v,c;if(!r.current.search||g.current.shouldFilter===!1){r.current.filtered.count=f.current.size;return}r.current.filtered.groups=new Set;let b=0;for(let w of f.current){let V=(m=(a=d.current.get(w))==null?void 0:a.value)!=null?m:"",L=(c=(v=d.current.get(w))==null?void 0:v.keywords)!=null?c:[],ae=Ee(V,L);r.current.filtered.items.set(w,ae),ae>0&&b++}for(let[w,V]of i.current)for(let L of V)if(r.current.filtered.items.get(L)>0){r.current.filtered.groups.add(w);break}r.current.filtered.count=b}function _e(){var a,m,v;let c=W();c&&(((a=c.parentElement)==null?void 0:a.firstChild)===c&&((v=(m=c.closest(Z))==null?void 0:m.querySelector(Lt))==null||v.scrollIntoView({block:"nearest"})),c.scrollIntoView({block:"nearest"}))}function W(){var a;return(a=o.current)==null?void 0:a.querySelector(`${Se}[aria-selected="true"]`)}function J(){var a;return Array.from(((a=o.current)==null?void 0:a.querySelectorAll(Fe))||[])}function ue(a){let m=J()[a];m&&S.setState("value",m.getAttribute(P))}function me(a){var m;let v=W(),c=J(),b=c.findIndex(V=>V===v),w=c[b+a];(m=g.current)!=null&&m.loop&&(w=b+a<0?c[c.length-1]:b+a===c.length?c[0]:c[b+a]),w&&S.setState("value",w.getAttribute(P))}function Ne(a){let m=W(),v=m==null?void 0:m.closest(Z),c;for(;v&&!c;)v=a>0?Ht(v,Z):Yt(v,Z),c=v==null?void 0:v.querySelector(Fe);c?S.setState("value",c.getAttribute(P)):me(a)}let ke=()=>ue(J().length-1),Ie=a=>{a.preventDefault(),a.metaKey?ke():a.altKey?Ne(1):me(1)},Re=a=>{a.preventDefault(),a.metaKey?ue(0):a.altKey?Ne(-1):me(-1)};return s.createElement(q.div,{ref:n,tabIndex:-1,...F,"cmdk-root":"",onKeyDown:a=>{var m;if((m=F.onKeyDown)==null||m.call(F,a),!a.defaultPrevented)switch(a.key){case"n":case"j":{M&&a.ctrlKey&&Ie(a);break}case"ArrowDown":{Ie(a);break}case"p":case"k":{M&&a.ctrlKey&&Re(a);break}case"ArrowUp":{Re(a);break}case"Home":{a.preventDefault(),ue(0);break}case"End":{a.preventDefault(),ke();break}case"Enter":if(!a.nativeEvent.isComposing&&a.keyCode!==229){a.preventDefault();let v=W();if(v){let c=new Event(we);v.dispatchEvent(c)}}}}},s.createElement("label",{"cmdk-label":"",htmlFor:ne.inputId,id:ne.labelId,style:Xt},y),ie(t,a=>s.createElement(Te.Provider,{value:S},s.createElement(Ge.Provider,{value:ne},a))))}),Pt=s.forwardRef((t,n)=>{var r,f;let i=H(),d=s.useRef(null),u=s.useContext(Oe),g=re(),y=Ue(t),h=(f=(r=y.current)==null?void 0:r.forceMount)!=null?f:u==null?void 0:u.forceMount;G(()=>{if(!h)return g.item(i,u==null?void 0:u.id)},[h]);let p=ze(i,d,[t.value,t.children,d],t.keywords),x=Ce(),k=T(l=>l.value&&l.value===p.current),C=T(l=>h||g.filter()===!1?!0:l.search?l.filtered.items.get(i)>0:!0);s.useEffect(()=>{let l=d.current;if(!(!l||t.disabled))return l.addEventListener(we,R),()=>l.removeEventListener(we,R)},[C,t.onSelect,t.disabled]);function R(){var l,S;j(),(S=(l=y.current).onSelect)==null||S.call(l,p.current)}function j(){x.setState("value",p.current,!0)}if(!C)return null;let{disabled:M,value:F,onSelect:$,forceMount:K,keywords:U,...o}=t;return s.createElement(q.div,{ref:te([d,n]),...o,id:i,"cmdk-item":"",role:"option","aria-disabled":!!M,"aria-selected":!!k,"data-disabled":!!M,"data-selected":!!k,onPointerMove:M||g.getDisablePointerSelection()?void 0:j,onClick:M?void 0:R},t.children)}),Gt=s.forwardRef((t,n)=>{let{heading:r,children:f,forceMount:i,...d}=t,u=H(),g=s.useRef(null),y=s.useRef(null),h=H(),p=re(),x=T(C=>i||p.filter()===!1?!0:C.search?C.filtered.groups.has(u):!0);G(()=>p.group(u),[]),ze(u,g,[t.value,t.heading,y]);let k=s.useMemo(()=>({id:u,forceMount:i}),[i]);return s.createElement(q.div,{ref:te([g,n]),...d,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},r&&s.createElement("div",{ref:y,"cmdk-group-heading":"","aria-hidden":!0,id:h},r),ie(t,C=>s.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?h:void 0},s.createElement(Oe.Provider,{value:k},C))))}),Tt=s.forwardRef((t,n)=>{let{alwaysRender:r,...f}=t,i=s.useRef(null),d=T(u=>!u.search);return!r&&!d?null:s.createElement(q.div,{ref:te([i,n]),...f,"cmdk-separator":"",role:"separator"})}),Ot=s.forwardRef((t,n)=>{let{onValueChange:r,...f}=t,i=t.value!=null,d=Ce(),u=T(p=>p.search),g=T(p=>p.value),y=re(),h=s.useMemo(()=>{var p;let x=(p=y.listInnerRef.current)==null?void 0:p.querySelector(`${Se}[${P}="${encodeURIComponent(g)}"]`);return x==null?void 0:x.getAttribute("id")},[]);return s.useEffect(()=>{t.value!=null&&d.setState("search",t.value)},[t.value]),s.createElement(q.input,{ref:n,...f,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":y.listId,"aria-labelledby":y.labelId,"aria-activedescendant":h,id:y.inputId,type:"text",value:i?t.value:u,onChange:p=>{i||d.setState("search",p.target.value),r==null||r(p.target.value)}})}),Kt=s.forwardRef((t,n)=>{let{children:r,label:f="Suggestions",...i}=t,d=s.useRef(null),u=s.useRef(null),g=re();return s.useEffect(()=>{if(u.current&&d.current){let y=u.current,h=d.current,p,x=new ResizeObserver(()=>{p=requestAnimationFrame(()=>{let k=y.offsetHeight;h.style.setProperty("--cmdk-list-height",k.toFixed(1)+"px")})});return x.observe(y),()=>{cancelAnimationFrame(p),x.unobserve(y)}}},[]),s.createElement(q.div,{ref:te([d,n]),...i,"cmdk-list":"",role:"listbox","aria-label":f,id:g.listId},ie(t,y=>s.createElement("div",{ref:te([u,g.listInnerRef]),"cmdk-list-sizer":""},y)))}),Ut=s.forwardRef((t,n)=>{let{open:r,onOpenChange:f,overlayClassName:i,contentClassName:d,container:u,...g}=t;return s.createElement(st,{open:r,onOpenChange:f},s.createElement(it,{container:u},s.createElement(ot,{"cmdk-overlay":"",className:i}),s.createElement(ct,{"aria-label":t.label,"cmdk-dialog":"",className:d},s.createElement(Ke,{ref:n,...g}))))}),zt=s.forwardRef((t,n)=>T(r=>r.filtered.count===0)?s.createElement(q.div,{ref:n,...t,"cmdk-empty":"",role:"presentation"}):null),Bt=s.forwardRef((t,n)=>{let{progress:r,children:f,label:i="Loading...",...d}=t;return s.createElement(q.div,{ref:n,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},ie(t,u=>s.createElement("div",{"aria-hidden":!0},u)))}),I=Object.assign(Ke,{List:Kt,Item:Pt,Input:Ot,Group:Gt,Separator:Tt,Dialog:Ut,Empty:zt,Loading:Bt});function Ht(t,n){let r=t.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function Yt(t,n){let r=t.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function Ue(t){let n=s.useRef(t);return G(()=>{n.current=t}),n}var G=typeof window>"u"?s.useEffect:s.useLayoutEffect;function B(t){let n=s.useRef();return n.current===void 0&&(n.current=t()),n}function te(t){return n=>{t.forEach(r=>{typeof r=="function"?r(n):r!=null&&(r.current=n)})}}function T(t){let n=Ce(),r=()=>t(n.snapshot());return qt.useSyncExternalStore(n.subscribe,r,r)}function ze(t,n,r,f=[]){let i=s.useRef(),d=re();return G(()=>{var u;let g=(()=>{var h;for(let p of r){if(typeof p=="string")return p.trim();if(typeof p=="object"&&"current"in p)return p.current?(h=p.current.textContent)==null?void 0:h.trim():i.current}})(),y=f.map(h=>h.trim());d.value(t,g,y),(u=n.current)==null||u.setAttribute(P,g),i.current=g}),i}var Wt=()=>{let[t,n]=s.useState(),r=B(()=>new Map);return G(()=>{r.current.forEach(f=>f()),r.current=new Map},[t]),(f,i)=>{r.current.set(f,i),n({})}};function Jt(t){let n=t.type;return typeof n=="function"?n(t.props):"render"in n?n.render(t.props):t}function ie({asChild:t,children:n},r){return t&&s.isValidElement(n)?s.cloneElement(Jt(n),{ref:n.ref},r(n.props.children)):r(n)}var Xt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Be=s.forwardRef(({className:t,...n},r)=>e.jsx(I,{ref:r,className:O("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...n}));Be.displayName=I.displayName;const He=s.forwardRef(({className:t,...n},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(dt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(I.Input,{ref:r,className:O("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...n})]}));He.displayName=I.Input.displayName;const Ye=s.forwardRef(({className:t,...n},r)=>e.jsx(I.List,{ref:r,className:O("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...n}));Ye.displayName=I.List.displayName;const We=s.forwardRef((t,n)=>e.jsx(I.Empty,{ref:n,className:"py-6 text-center text-sm",...t}));We.displayName=I.Empty.displayName;const Je=s.forwardRef(({className:t,...n},r)=>e.jsx(I.Group,{ref:r,className:O("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...n}));Je.displayName=I.Group.displayName;const Qt=s.forwardRef(({className:t,...n},r)=>e.jsx(I.Separator,{ref:r,className:O("-mx-1 h-px bg-border",t),...n}));Qt.displayName=I.Separator.displayName;const Xe=s.forwardRef(({className:t,...n},r)=>e.jsx(I.Item,{ref:r,className:O("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...n}));Xe.displayName=I.Item.displayName;function $e({url:t,filter:n,id:r,label:f,value:i,onSelectChange:d,defaultLabel:u,disabled:g,placeholder:y="Search items ..."}){var o;const[h,p]=s.useState(!1),[x,k]=s.useState([]),[C,R]=s.useState(!1),[j,M]=s.useState("");let F;async function $(){const l={filter:n,search:j};R(!0);try{let S=await ee.get(t,{params:l});R(!1),k(S.data.data)}catch(S){console.log(S)}}function K(l){l.key==="Enter"&&(clearTimeout(F),$())}s.useEffect(()=>(F=setTimeout(()=>{j&&$()},500),()=>clearTimeout(F)),[j]);function U(l){d(l),p(!1)}return s.useEffect(()=>{h?$():M("")},[h]),e.jsxs(ut,{open:h,onOpenChange:p,children:[e.jsx(mt,{asChild:!0,children:e.jsxs(qe,{variant:"outline",disabled:g,role:"combobox","aria-expanded":h,className:"w-[200px] text-xs justify-between",children:[e.jsx(ht,{className:"opacity-50"}),u&&x.length===0?u:null,i&&x.length>0?(o=x.find(l=>String(l[r])===String(i)))==null?void 0:o[f]:"",i===""&&(u===""||u===null)?y:""]})}),e.jsx(pt,{className:"w-[200px] p-0",children:e.jsxs(Be,{shouldFilter:!1,children:[e.jsx(He,{onKeyDown:K,onValueChange:l=>M(l),placeholder:y}),e.jsx(Ye,{className:"z-30",children:C?e.jsx("div",{className:"py-10 flex items-center justify-center h-64 w-full",children:e.jsx(ft,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(We,{children:["No Item found. ",x.length]}),x.length>0?e.jsx(Je,{className:"z-30",children:x.map(l=>e.jsxs(Xe,{className:"z-30",value:l[r],onSelect:S=>{U(l[r])},children:[l[f],e.jsx(gt,{className:O("ml-auto",i===l[r]?"opacity-100":"opacity-0")})]},l[r]))}):null]})})]})})]})}var Zt=(t=>(t[t.create=0]="create",t[t.edit=1]="edit",t[t.update=2]="update",t))(Zt||{});function Rr({onSuccess:t,type:n=z.create,detailUrl:r,id:f,listCurrency:i,listAllowanceCategory:d,listGrade:u,createUrl:g,editUrl:y}){const h=N.object({code:N.string().min(1,"Code is required"),name:N.string().min(1,"Name is required"),type:N.string().min(1,"Type is required"),material_number:N.string().min(1,"Material number required"),material_group:N.string().min(1,"Material Group required"),currency_id:N.string().min(1,"Currency is required"),allowance_category_id:N.string().min(1,"Allowance Category is required"),request_value:N.string().min(1,"Required"),grade_option:N.string().min(1,"Grade must be selected"),grade_all_price:N.string().optional(),grades:N.array(N.object({grade:N.string(),id:N.number(),plafon:N.string()}))}),[p,x]=s.useState([]),[k,C]=s.useState(""),R={code:"",name:"",type:"",currency_id:"",allowance_category_id:"",request_value:"unlimited",grade_option:"all",grade_all_price:"0",grades:[]},j=tt({resolver:et(h),defaultValues:R});async function M(){try{const o=await ee.get(r??""),l=o.data.data.allowance;U(l.material_group);const S=o.data.data.grades;j.reset({code:l.code,name:l.name,type:l.type,material_number:l.material_group,material_group:l.material_group,currency_id:l.currency_id,allowance_category_id:l.allowance_category_id,request_value:l.request_value,grade_option:l.grade_option,grade_all_price:l.grade_all_price,grades:S})}catch{}}const{fields:F}=rt({control:j.control,name:"grades"});console.log("type",n);const{showToast:$}=Qe(),K=async o=>{try{if(console.log(o),n===z.create){const l=await ee.post(g??"",o)}else if(n===z.edit){const l=await ee.put(y??"",o)}$("success","success"),t==null||t(!0)}catch(l){l.response&&$(l.response.data.message,"error")}};async function U(o){try{const l=await ee.get(lt(o));j.setValue("material_group",o),x(l.data.data)}catch(l){console.log(l)}}return s.useEffect(()=>{(n===z.detail||n===z.edit)&&M()},[n]),e.jsx(nt,{className:"h-[600px] w-full",children:e.jsx(Ze,{...j,children:e.jsxs("form",{onSubmit:j.handleSubmit(K),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"code",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsx(se,{type:"text",readOnly:n===z.edit,placeholder:"Insert code",...o,value:o.value||"",onChange:l=>o.onChange(l.target.value)})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"name",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsx(se,{type:"text",...o,value:o.value||"",onChange:l=>o.onChange(l.target.value)})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type"}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"type",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsxs(pe,{onValueChange:l=>o.onChange(l),value:o.value,children:[e.jsx(fe,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Select type"})}),e.jsxs(xe,{children:[e.jsx(le,{value:"daily",children:"DAILY"},"DAILY"),e.jsx(le,{value:"total",children:"Total"},"TOTAL")]})]})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"material_group",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsx($e,{onSelectChange:l=>{o.onChange(l),C("api/master/master-material/get-dropdown-master-material-number/by-material-group/"+l),j.setValue("material_number","")},value:o.value,placeholder:"Select material group",filter:["material_group"],id:"material_group",label:"material_group",url:"api/master/master-material/get-dropdown-master-material-group"})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Material Number ",j.getValues("material_number")]}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"material_number",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsx($e,{onSelectChange:l=>{o.onChange(l)},value:o.value,filter:["material_number"],id:"material_number",label:"material_number",url:k})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"currency_id",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsxs(pe,{onValueChange:l=>o.onChange(l),value:o.value,children:[e.jsx(fe,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Select Currency"})}),e.jsx(xe,{children:i.map(l=>e.jsxs(le,{value:l.code,children:[l.name," ",l.code]},l.code))})]})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Allowance Category"}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"allowance_category_id",render:({field:o})=>e.jsxs(E,{children:[e.jsx(_,{children:e.jsxs(pe,{onValueChange:l=>o.onChange(l),value:o.value,children:[e.jsx(fe,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Select Allowance Category"})}),e.jsx(xe,{children:d.map(l=>e.jsx(le,{value:l.id.toString(),children:l.name},l.id))})]})}),e.jsx(D,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(A,{control:j.control,name:"grade_option",render:({field:o})=>e.jsx(E,{children:e.jsx(_,{children:e.jsxs(Me,{onValueChange:o.onChange,defaultValue:o.value,className:"flex flex space-x-1",children:[e.jsxs(E,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(_,{children:e.jsx(Q,{value:"all"})}),e.jsx(X,{className:"text-xs",children:"All"})]}),e.jsxs(E,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(_,{children:e.jsx(Q,{value:"grade"})}),e.jsx(X,{className:"text-xs",children:"Grade"})]})]})})})}),j.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(A,{control:j.control,name:"grade_all_price",render:({field:o})=>e.jsx(E,{children:e.jsx(_,{children:e.jsx(se,{...o})})})})}):e.jsx("div",{children:e.jsx(at,{label:"grade",id:"id",options:u,value:j.getValues("grades").map(o=>o.id),onSelect:o=>{j.setValue("grades",o.map(l=>({id:l.id,grade:l.grade,plafon:""})))}})}),j.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:F.map((o,l)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Grade ",o.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(A,{control:j.control,name:`grades.${l}.plafon`,render:({field:S})=>e.jsx(E,{children:e.jsx(_,{children:e.jsx(se,{...S})})})})})})]},o))})}):null]})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Request Value ",j.getValues("request_value")]}),e.jsx("td",{children:e.jsx(A,{control:j.control,name:"request_value",render:({field:o})=>e.jsx(E,{children:e.jsx(_,{children:e.jsxs(Me,{onValueChange:o.onChange,defaultValue:o.value,className:"flex flex space-x-1",children:[e.jsxs(E,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(_,{children:e.jsx(Q,{value:"unlimited"})}),e.jsx(X,{className:"text-xs",children:"Unlimited"})]}),e.jsxs(E,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(_,{children:e.jsx(Q,{value:"up to max value"})}),e.jsx(X,{className:"text-xs",children:"Up To Max Value"})]}),e.jsxs(E,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(_,{children:e.jsx(Q,{value:"fixed value"})}),e.jsx(X,{className:"text-xs",children:"Fixed Value"})]})]})})})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(qe,{type:"submit",children:"Save"})})]})})})}export{Zt as AllowanceType,Rr as default};
