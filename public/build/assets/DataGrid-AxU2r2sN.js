import{j as e,r as n,u as ie,q as ne,a as y,b as de}from"./app-DROMi2zE.js";import{a as A}from"./axiosInstance-DE4TTdbo.js";import{D as re,b as le,c as ce,L as oe}from"./LoadingSpin-B_xvLmRj.js";import{B as $}from"./button-CdItXqcZ.js";import{D as xe,a as he,b as pe,c as me,d as S,e as R}from"./dropdown-menu-D04rb11S.js";import{e as ge}from"./index-DI89zKnQ.js";import{c as q}from"./createLucideIcon-7L4332i2.js";import{B as P,a as je}from"./ListItemText-BU5jZwup.js";import{D as ue}from"./DataGrid-D7ELEsrj.js";const fe=({open:k,onOpenChange:U,onDelete:g,onClose:t,children:D,className:i,isLoading:o,title:d,description:m})=>e.jsx(re,{open:k,onOpenChange:t,children:e.jsxs(le,{className:i||"md:max-w-[768px]",children:[m||"Are you sure delete this item?",e.jsxs(ce,{children:[t?e.jsx($,{variant:"outline",onClick:t,children:"Close"}):null,g?e.jsx(e.Fragment,{children:o?e.jsx(oe,{}):e.jsx($,{type:"submit",onClick:g,children:"Delete"})}):null]})]})});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=q("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Fe=({columns:k,buttonCustome:U,onExport:g,url:t,labelFilter:D="Search",onEdit:i,onDelete:o,onDetail:d,onCreate:m,defaultSearch:b,actionType:H,buttonActionCustome:F,deleteConfirmationText:O,titleConfirmationText:ke,role:s})=>{var T;const[V,W]=n.useState([]),[_,z]=n.useState(!1),[x,G]=n.useState({page:0,pageSize:10}),[j,X]=n.useState([]),[u,J]=n.useState({items:[]}),[B,v]=n.useState(null),[K,L]=n.useState(!1),[Q,Y]=n.useState(0),[f,Z]=n.useState(""),{showToast:C}=ie(),{props:E}=ne(),h=((T=E.auth)==null?void 0:T.permission)||[],N=n.useCallback(async(a,r,w,p,l)=>{z(!0);const M=p.length>0?p[0].field:"id",te=p.length>0?p[0].sort:"asc",ae=l.items.map(c=>`${c.field}=${c.operator},${c.value}`).join("&");try{const c=await A.get(`${t.url}${b||"?"}page=${a+1}&per_page=${r}&search=${w}&sort_by=${M}&sort_direction=${te}&${ae}`);W(c.data.data.data),Y(c.data.data.total)}catch(c){console.error("Error fetching data:",c)}finally{z(!1)}},[t]);n.useEffect(()=>{N(x.page,x.pageSize,f,j,u)},[N,u,x,f,j]);const I=async a=>{var r,w,p;L(!0);try{const l=await A.delete(`${t.deleteUrl}/${a}`);C(((r=l==null?void 0:l.data)==null?void 0:r.message)||"Record deleted successfully","success"),L(!1),v(null),o&&await o(a),N(x.page,x.pageSize,f,j,u)}catch(l){if(de.isAxiosError(l)){const M=((p=(w=l.response)==null?void 0:w.data)==null?void 0:p.message)||"Failed to delete record";C(M,"error")}else C("An unexpected error occurred","error")}},ee=a=>{v(a)},se=i||o||d||t.detailUrl||t.editUrl||t.deleteUrl||F?[{field:"actions",headerName:"Actions",width:150,renderCell:a=>e.jsx(e.Fragment,{children:H==="dropdown"?e.jsxs(xe,{children:[e.jsx(he,{asChild:!0,children:e.jsxs($,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"..."}),e.jsx(ge,{className:"h-4 w-4"})]})}),e.jsxs(pe,{align:"end",children:[e.jsx(me,{children:"Actions"}),(i||t.editUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.update)??""))&&e.jsx(S,{onClick:()=>i&&i(a.row.id),children:e.jsxs("span",{className:"flex items-center text-sm space-x-2",children:[e.jsx("span",{children:"Edit"}),e.jsx(we,{size:14})]})})}),e.jsx(R,{}),(t.deleteUrl||o)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.delete)??""))&&e.jsx(S,{className:"bg-red-400 text-white hover:!bg-red-500 hover:!text-white transition-all duration-300",onClick:()=>ee(a.row.id),children:e.jsxs("span",{className:"flex items-center  text-sm space-x-2",children:[e.jsx("span",{children:"Delete"}),e.jsx(ye,{size:14})]})})}),e.jsx(R,{}),(d||t.detailUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.detail)??""))&&e.jsx(S,{onClick:()=>{d&&d(a.row.id),t.detailUrl&&(window.location.href=`${t.detailUrl}/${a.row.id}`)},children:"View details"})})]})]}):e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(d||t.detailUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.detail)??""))&&e.jsx(y,{href:t.detailUrl===""?"#":`${t.detailUrl}/${a.row.id}`,onClick:r=>{d&&(r.preventDefault(),d&&d(a.row.id))},alt:"detail",children:e.jsx("i",{className:" ki-duotone ki-size text-info text-2xl"})})}),(i||t.editUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.update)??""))&&e.jsx(y,{href:t.editUrl===""?"#":`${t.editUrl}/${a.row.id}`,onClick:r=>{i&&(r.preventDefault(),i&&i(a.row.id))},alt:"edit",children:e.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})})}),(t.deleteUrl||o)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.delete)??""))&&e.jsx(y,{href:"",onClick:()=>I(a.row.id),alt:"delete",children:e.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})}),F]})})}]:[];return e.jsx(P,{children:e.jsx(P,{sx:{height:"45rem",width:"100%",overflowX:"auto"},children:e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"grid",children:e.jsxs("div",{className:"card card-grid h-full min-w-full",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:e.jsxs("div",{className:"input input-sm max-w-48",children:[e.jsx("i",{className:"ki-filled ki-magnifier"}),e.jsx("input",{placeholder:D,type:"text",value:f,onChange:a=>Z(a.target.value),style:{width:"100%",maxWidth:"200px",marginBottom:"10p"}})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(m||t.addUrl)&&e.jsx(e.Fragment,{children:(!s||h.includes((s==null?void 0:s.create)??""))&&e.jsxs(y,{href:t.addUrl??"#",className:"btn btn-success",onClick:a=>{m&&(a.preventDefault(),m())},style:{marginRight:"10px",marginBottom:"10px"},children:[e.jsx("i",{className:"ki-filled ki-additem"}),"Add New"]})}),g&&e.jsx(je,{className:"btn",variant:"contained",onClick:()=>g(),color:"primary",startIcon:e.jsx("i",{className:"ki-filled ki-folder-down"}),style:{marginBottom:"10px"},children:"Export TXT"}),U]})]}),e.jsxs("div",{className:"card-body",children:[e.jsx(fe,{isLoading:K,description:O,open:B!==null,onClose:()=>{v(null)},onDelete:()=>I(B??0)}),e.jsx("div",{"data-datatable":"true","data-datatable-page-size":x.pageSize,children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx(ue,{rows:V,columns:[...k,...se],loading:_,paginationMode:"server",rowCount:Q,paginationModel:x,onPaginationModelChange:G,pageSizeOptions:[10,20],sortingMode:"server",sortModel:j,onSortModelChange:a=>X(a),filterMode:"server",filterModel:u,onFilterModelChange:a=>J(a)})})})]})]})})})})})};export{fe as C,Fe as D};
