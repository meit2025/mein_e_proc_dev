import{q as x,r,j as a}from"./app-CW5Vjafz.js";import{a as R}from"./axiosInstance-DNepBn60.js";import{L as M}from"./Loading-BbboD5ro.js";import{F as _}from"./FormMapping-CimuELk4.js";import{F as k}from"./formTextArea-YzFPa6CW.js";import{u as q}from"./index.esm-C-voK3pQ.js";import{D as B}from"./detailApproval-DFCCa7oA.js";import{h as D}from"./moment-C5S46NFB.js";import{B as h}from"./Button-Qnk2p3fb.js";import{M as I}from"./TextField-B_IsTjm-.js";import{B as Y}from"./Box-5wzL-xQU.js";const E={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",pt:2,px:4,pb:3},U=({id:p,children:j,type:l,status_id:m})=>{x();const{auth:i}=x().props,e=q({mode:"onChange",reValidateMode:"onChange"}),[g,d]=r.useState(!1),[V,b]=r.useState(!1),[y,u]=r.useState(!1),c=r.useCallback(async()=>{var n;d(!0);try{const s=(await R.get("/api/approval/route/getApproval?id="+p+"&type="+l)).data;e.reset(s.data.data);const A=(s.data??[]).map(t=>{var v;return((v=t.user.divisions)==null?void 0:v.name)||null}),w=(s.data??[]).map(t=>t.user.name),o=(s.data??[]).find(t=>t.is_status===!1);m!==4&&(o==null?void 0:o.user_id)===((n=i==null?void 0:i.user)==null?void 0:n.id)&&b(!0);const F=(s.data??[]).map(t=>({status:t.status,name:t.user.name,dateApproved:D(t.updated_at).format("YYYY-MM-DD")}));e.setValue("approvalFromStatusRoute",F),e.setValue("approvalRequest",A),e.setValue("approvalFrom",w),e.setValue("approvalId",o==null?void 0:o.id),e.setValue("function_name",l.toLowerCase()),e.setValue("type",l.toLowerCase()),e.setValue("id",p)}catch{d(!1)}finally{d(!1)}},[e,p,l,m]);r.useEffect(()=>{c()},[c]);const C=()=>{u(!1),e.setValue("note",""),e.setValue("id_approval",""),e.setValue("status",""),e.setValue("type","")},f=n=>{u(!0),e.setValue("status",n)};return a.jsxs(a.Fragment,{children:[a.jsx(M,{isLoading:g}),a.jsxs("div",{className:"card card-grid h-full min-w-full p-4",children:[V&&a.jsx("div",{className:"card-header",children:a.jsxs("div",{children:[a.jsx(h,{variant:"contained",onClick:()=>f("Approved"),color:"primary",type:"button",children:"Approval"}),a.jsx(h,{onClick:()=>f("Rejected"),style:{marginLeft:"1rem"},variant:"contained",color:"error",type:"button",children:"Rejectd"})]})}),j,a.jsx(B,{methods:e}),a.jsx(I,{open:y,onClose:C,"aria-labelledby":"parent-modal-title","aria-describedby":"parent-modal-description",children:a.jsx(Y,{sx:{...E,width:900},children:a.jsx(_,{isCustom:!0,formCustom:a.jsx(a.Fragment,{children:a.jsx(k,{fieldLabel:"note",fieldName:"note",isRequired:!0,requiredMessage:"",rows:20,style:{width:"100%"}})}),methods:e,url:"api/approval/approval_or_rejceted"})})})]})]})};export{U as L};
