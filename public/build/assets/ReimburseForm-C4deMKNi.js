import{j as e,r as I,u as rt,q as at}from"./app-BqCDL8c3.js";import{B as nt}from"./button-Do0S2zVX.js";import{h as ve}from"./moment-C5S46NFB.js";import{z as u,t as ot}from"./index-LK9GZKoH.js";import{f as W}from"./rupiahCurrencyFormat-CP-6egij.js";import{d as it,F as v,a as S,b as C,c as N,f as lt,e as ct}from"./form-C8ue4uyJ.js";import{u as mt,b as dt}from"./index.esm-CW-kNtuj.js";import{T as Se}from"./textarea-D5F-mX8d.js";/* empty css                  */import{S as pt}from"./scroll-area-D_-gzESS.js";import{a as A}from"./axiosInstance-DP3s2P-G.js";import{S as Ce}from"./separator-BG-8tu_L.js";import{T as ut,a as ht,b as ft,c as gt}from"./tabs-DBpoHnfX.js";import{S as Z,a as H,b as J,c as K,d as X}from"./select-BJnLZhVR.js";import{F as re}from"./formDropdown-I_nigaBN.js";import{C as Ne}from"./CustomDatePicker-DD8byjnd.js";import{I as Fe}from"./input-D68Md8LX.js";import{ReimburseFormType as x}from"./listModel-B9Bg1Gxr.js";import{u as Q}from"./getDropdown-Ctv9Net5.js";import{G as jt,a as De,b as _t}from"./api-DXF7erOJ.js";import{L as xt}from"./LoadingSpin-BHqKbjtw.js";import{W as bt}from"./WorkflowComponent-C6-bY-XA.js";import{C as yt}from"./CustomStatus-3_6AuXLY.js";import{F as Ie}from"./FormHelperText-B2BVP8sg.js";import{B as wt}from"./Button-DFYokiKd.js";import"./app-DQK4SJPx.js";import"./index-BKjAiQLI.js";import"./index-Bb4qSo10.js";import"./utils-Bmn2FgM2.js";import"./createLucideIcon-DJ8Zjr5Z.js";import"./index-C7OoVIQE.js";import"./index-BaJnux_P.js";import"./index-D-trTuUB.js";import"./index-DWnsbcPI.js";import"./index-TsPq7m7D.js";import"./index-mS7XCVGk.js";import"./index-CrDGeyhI.js";import"./index-bfUZqGQ3.js";import"./index-CpfObVEz.js";import"./Combination-BrAfYrBM.js";import"./index-pQxaW5wF.js";import"./TextField-uf0MXs2P.js";import"./createSvgIcon-B1RYnwvB.js";import"./DefaultPropsProvider-kNkqDZEa.js";import"./useSlot-Ci8DR_rs.js";import"./createSimplePaletteValueFilter-DHbVBdJG.js";import"./useControlled-DDYpZkPn.js";function vt({isLoading:ae=!1,children:ne}){return e.jsx("div",{className:"",children:ae?e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-64 w-full flex justify-center items-center",children:e.jsx(xt,{})})}):ne})}const xs=({onSuccess:ae,currencies:ne,taxDefaultValue:ue,uomDefaultValue:he,categories:St,users:Ct,edit_url:Ee,update_url:Te,store_url:Re,type:j,currentUser:T})=>{const[qe,ke]=I.useState("form1"),{showToast:L}=rt();at().props;const{dataDropdown:$e,getDropdown:fe}=Q(jt),{dataDropdown:Ae,getDropdown:Le}=Q(),{dataDropdown:Be,getDropdown:Me}=Q(),{dataDropdown:Ve,getDropdown:ge}=Q("api/master-pr/purchasing-group/dropdown-list"),{dataDropdown:Pe,getDropdown:je}=Q("api/master/cost-center/dropdown-list"),[G,_e]=I.useState([]),[Ge,oe]=I.useState([]),[E,Ye]=I.useState(!1),[xe,ze]=I.useState(!1),[Oe,U]=I.useState(!1),[_,B]=I.useState([]),[Y,We]=I.useState({approvalRequest:[],approvalFrom:[],acknowledgeFrom:[],approvalFromStatusRoute:[]}),Ze=1*1024*1024,He=["image/jpeg","image/png","application/pdf","image/heic","image/heif"],Je=u.object({formCount:u.string().min(1,"total form must be have value"),remark_group:u.string().optional(),cost_center:u.string().min(1,"cost center required"),requester:u.string().min(1,"requester required"),value:u.number().optional(),user_id:u.string().optional(),forms:u.array(u.object({reimburseId:u.string().optional(),for:u.string().optional(),group:u.string().optional(),reimburse_type:u.string().min(1,"reimburse type is required"),short_text:u.string().min(1,"remarks is required"),balance:u.string(),currency:u.string().min(1,"currency required"),tax_on_sales:u.string().min(1,"tax required"),purchase_requisition_unit_of_measure:u.string().min(1,"uom required"),purchasing_group:u.string().min(1,"Purchasing Group required"),type:u.any(),item_delivery_data:u.date(),claim_date:u.date(),attachment:u.array(u.instanceof(File).refine(s=>He.includes(s.type),{message:"File type must be JPG, JPEG, PNG, HEIC, or PDF"}).refine(s=>s.size<=Ze,{message:"File size must be less than 1MB"})).min(j===x.create?1:0,"Attachment is required")}))});I.useEffect(()=>{Me("",{name:"mwszkz",id:"id",tabel:"pajaks",where:{key:"mwszkz",parameter:"V0"}}),Le("",{name:"unit_of_measurement_text",id:"id",tabel:"uoms",where:{key:"iso_code",parameter:"PCE"}}),ge("",{name:"purchasing_group_desc",id:"id",tabel:"purchasing_groups",idType:"string"}),je("",{name:"cost_center",id:"id",tabel:"master_cost_centers",idType:"string"}),fe("",{name:"name",id:"nip",tabel:"users"}),a.getValues("requester")!==""&&ee(0)},[]);const Ke={formCount:"1",remark_group:"test",cost_center:"",requester:String(T==null?void 0:T.is_admin)==="1"?"":T==null?void 0:T.nip,forms:[{reimburseId:"",for:"",group:"",reimburse_type:"",short_text:"",balance:"",currency:"IDR",tax_on_sales:ue,purchase_requisition_unit_of_measure:he,purchasing_group:"",type:"",item_delivery_data:new Date,claim_date:new Date,attachment:[]}]},a=mt({resolver:ot(Je),defaultValues:Ke}),{fields:ie,update:b}=dt({control:a.control,name:"forms"});async function Xe(){a.setValue("forms",[]),U(!0);try{const s=await A.get(Ee??""),t=s.data.data.group,n=s.data.data.forms;Ye(t.reimbursementStatus);const m=n.map(o=>({reimburseId:String(o.id),for:String(o.for),group:String(o.group),reimburse_type:o.reimburse_type.code,short_text:o.short_text,balance:j===x.edit?o.balance:"",currency:o.currency,tax_on_sales:String(o.tax_on_sales),purchase_requisition_unit_of_measure:String(o.purchase_requisition_unit_of_measure),purchasing_group:String(o.purchasing_group),type:o.type,item_delivery_data:new Date(o.item_delivery_data),claim_date:new Date(o.claim_date),attachment:[]}));a.setValue("formCount",n.length.toString()),a.setValue("remark_group",t.remark),a.setValue("cost_center",String(t.cost_center.id)),a.setValue("requester",t.requester);let d=0;for(const o of n)await ee(d,{reimburse_type:o.reimburse_type.code}),await be(d,{type:o.type,reimburse_type:o.reimburse_type.code}),await le(d,{reimburse_type:o.reimburse_type.code}),d++;a.setValue("forms",m),U(!1)}catch{U(!1)}}I.useEffect(()=>{(j===x.edit||j===x.clone)&&(U(!0),Xe())},[j]);const Qe=async s=>{s.length>0&&fe("",{name:"name",id:"nip",tabel:"users"})},ee=async(s,t=null)=>{const n=await A.get(De,{params:{user:a.getValues("requester"),hasValue:t!=null?t.reimburse_type:null},headers:{"Content-Type":"application/json"}});_e(m=>{const d=[...m];return d[s]=n.data.data,d})},Ue=async(s,t)=>{if(s&&s.length>0)try{const n=await A.get(De,{params:{search:s,user:a.getValues("requester")}});_e(m=>{const d=[...m];return d[t]=n.data.data,d})}catch(n){console.error("Error searching reimburse types:",n)}},be=async(s,t)=>{const n=await A.get(_t,{params:{user:a.getValues("requester"),familyRelationship:t.type=="Family"?"0":"1",reimburseType:t.reimburse_type},headers:{"Content-Type":"application/json"}});oe(m=>{const d=[...m];return d[s]=n.data.data,d})},et=s=>{for(let t=0;t<ie.length;t++)ee(t);if(s==null)for(let t=0;t<ie.length;t++)a.setValue(`forms.${t}.reimburse_type`,""),a.setValue(`forms.${t}.for`,"");B([]),oe([])};function tt(s){const t=[...a.getValues("forms")];for(let n=0;n<parseInt(s);n++)if(n+1>t.length){ee(n);const m={reimburseId:"",for:"",group:"",reimburse_type:"",short_text:"",balance:"",currency:"IDR",tax_on_sales:ue,purchase_requisition_unit_of_measure:he,purchasing_group:"",type:"",item_delivery_data:new Date,claim_date:new Date,attachment:[]};t.push(m)}a.setValue("forms",t)}const ye=s=>{ke(s)},st=async s=>{var n,m,d,o,h;if(_)for(let c=0;c<_.length;c++){if(s.forms.length==0||s.forms.length-1,((n=_[c])==null?void 0:n.type_limit)!=="Unlimited"&&parseInt((m=_[c])==null?void 0:m.limit)==0){L("Claim Limit for form "+(c+1)+" is Empty, Please Contact the Admin","error");return}if(s.forms[c].balance==""||parseInt(s.forms[c].balance)==0){L("Claim Balance for form "+(c+1)+" cannot be 0","error");return}if(parseInt(((d=_[c])==null?void 0:d.balance)??0)<parseInt(s.forms[c].balance??0)){L("Please check your balance input for forms "+(c+1)+"  is not must be above "+((o=_[c])==null?void 0:o.balance),"error");return}s.forms=s.forms.map(y=>({...y,claim_date:ve(y.claim_date).format("YYYY-MM-DD"),item_delivery_data:ve(y.item_delivery_data).format("YYYY-MM-DD")}))}const t=s.forms.reduce((c,y)=>c+parseInt(y.balance)||0,0);s.value=t,s.user_id=(s==null?void 0:s.requester)||"0";try{let c;j===x.edit?c=await A.put(Te??"",s,{headers:{"Content-Type":"multipart/form-data"}}):c=await A.post(Re??"",s,{headers:{"Content-Type":"multipart/form-data"}}),L((h=c==null?void 0:c.data)==null?void 0:h.data,"success"),ae()}catch{}};async function le(s,t=null){var d,o;const n=a.getValues(`forms.${s}`),m={user:a.getValues("requester"),reimbuse_type:t!=null?t.reimburse_type:n.reimburse_type};try{const h=await A.get("reimburse/data-limit-and-balance",{params:m});B(c=>{const q=a.getValues("forms").filter((F,w)=>w!==s&&F.reimburse_type===n.reimburse_type),M=q.reduce((F,w)=>F+parseInt(w.balance)||0,0),k=[...c];return k[s]={...h.data.data,balance:h.data.data.balance-M,limit:h.data.data.type_limit=="Unlimited"?h.data.data.type_limit:Math.max(0,h.data.data.limit-q.length)},k})}catch(h){L((o=(d=h==null?void 0:h.response)==null?void 0:d.data)==null?void 0:o.message,"error")}}const we=async()=>{var s,t,n,m,d,o,h,c,y,q,M,k;try{const w=a.getValues("forms").map((D,$)=>({index:$,value:D.balance?parseInt(D.balance):0}));if(w.some(D=>D.value===0)){const D=w.findIndex($=>$.value===0);L(`Please fill the balance for form ${D+1}`,"error");return}const R=await A.get("/check-approval",{params:{value:w==null?void 0:w[0].value,requester:a.getValues("requester"),type:"REIM"}});if(R.data.status_code===200){const D=(t=(s=R.data)==null?void 0:s.data)==null?void 0:t.approval.map(p=>(p==null?void 0:p.division_name)||null),$=(m=(n=R.data)==null?void 0:n.data)==null?void 0:m.approval.map(p=>(p==null?void 0:p.name)||null),z=[];(o=(d=R.data)==null?void 0:d.data)!=null&&o.hr&&z.push((y=(c=(h=R.data)==null?void 0:h.data)==null?void 0:c.hr)==null?void 0:y.name);const l=(((q=R.data.data)==null?void 0:q.approval)??[]).map(p=>({status:"",name:p.name,dateApproved:""}));We({approvalRequest:D,approvalFrom:$,acknowledgeFrom:z,approvalFromStatusRoute:l}),ze(!0)}}catch(F){L((k=(M=F==null?void 0:F.response)==null?void 0:M.data)==null?void 0:k.message,"error")}};return I.useEffect(()=>{a.getValues("forms").reduce((n,m)=>n+parseInt(m.balance)||0,0)>0&&xe===!0&&we()},[a.watch("forms"),a.watch("requester")]),e.jsx(pt,{className:"h-[600px] w-full",children:e.jsx(vt,{isLoading:Oe,children:e.jsx(it,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(st),children:[e.jsx("table",{className:"text-xs mt-4 reimburse-form-table font-thin w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Request Status"}),e.jsx("td",{children:E&&e.jsx(yt,{name:E==null?void 0:E.name,className:E==null?void 0:E.classname,code:E==null?void 0:E.code})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Remark"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:"remark_group",render:({field:s})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(Se,{placeholder:"Insert remark",...s})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Cost Center"}),e.jsx("td",{children:e.jsx(re,{fieldLabel:"",options:Pe,fieldName:"cost_center",disabled:j===x.edit,placeholder:"Cost Center",classNames:"mt-2 w-full",onChangeOutside:async(s,t)=>{s.length>0&&s!==(t==null?void 0:t.value)&&je(s,{name:"cost_center",id:"id",tabel:"master_cost_centers",idType:"string",search:s})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Employee"}),e.jsx("td",{children:e.jsx(re,{options:$e,fieldName:"requester",disabled:String(T==null?void 0:T.is_admin)==="0"||j===x.edit,placeholder:"Select Employee",onSearch:Qe,onChangeOutside:s=>et(s),classNames:"mt-2 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Number of Forms"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:"formCount",render:({field:s})=>{var t;return e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(Z,{disabled:j===x.edit,onValueChange:n=>{s.onChange(n),tt(n),ye(`form${parseInt(n)}`);const m=a.getValues("forms");if(m.length>parseInt(n)){const d=m.slice(0,parseInt(n));a.setValue("forms",d),B(o=>{let h=[...o];return h=h.slice(0,parseInt(n)),h})}},value:(t=s.value)==null?void 0:t.toString(),children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(J,{placeholder:"Select number of forms"})}),e.jsx(K,{children:Array.from({length:3},(n,m)=>m+1).map(n=>e.jsx(X,{value:n.toString(),children:n},n))})]})}),e.jsx(N,{})]})}})})]})]})}),e.jsx(Ce,{className:"my-4"}),e.jsxs(ut,{value:qe,onValueChange:ye,className:"w-full",children:[e.jsxs(ht,{className:"flex items-center justify-start space-x-4",children:[" ",Array.from({length:a.watch("formCount")||1}).map((s,t)=>e.jsxs(ft,{value:`form${t+1}`,children:["Form ",t+1]},t))]}),ie.map((s,t)=>{var n,m,d,o,h,c,y,q,M,k,F,w,ce,R,D,$,z;return e.jsxs(gt,{value:`form${t+1}`,children:[e.jsx(v,{control:a.control,name:`forms.${t}.reimburseId`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(Fe,{className:"sr-only",value:s.reimburseId,onChange:l.onChange})}),e.jsx(N,{})]})}),e.jsx("div",{children:e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Type of Reimbursement "}),e.jsxs("td",{children:[e.jsx(re,{options:G[t],fieldName:`forms.${t}.reimburse_type`,disabled:a.getValues("requester")==""||j===x.edit,placeholder:"Select Reimburse Type",onChangeOutside:(l,r)=>{const p=a.getValues("requester");if(l!==(r==null?void 0:r.value)&&p!==""&&Ue(l,t),r!=null&&r.value){let f=G[t].filter(g=>g.value==r.value)[0];b(t,{...s,reimburse_type:r==null?void 0:r.value,type:f.is_employee===1?"Employee":"Family"}),f.is_employee===1?le(t):(B(g=>{const i=[...g];return i[t]=[],i}),a.setValue(`forms.${t}.balance`,""),be(t,{type:"Family",reimburse_type:r==null?void 0:r.value}))}else{B(g=>{const i=[...g];return i[t]=[],i}),b(t,{...s,balance:""}),a.setValue(`forms.${t}.for`,""),oe(g=>{const i=[...g];return i[t]=[],i});const f=a.getValues("forms");f.forEach((g,i)=>{var O,me;if(i>t&&f[i].reimburse_type===s.reimburse_type){const te=((O=_[i])==null?void 0:O.balance)||0,de=((me=_[i])==null?void 0:me.limit)||0;B(P=>{var se;const V=[...P];return V[i]={...V[i],balance:te+parseInt(s.balance||"0")},((se=_[i])==null?void 0:se.type_limit)!=="Unlimited"&&(V[i]={...V[i],limit:de+1}),V}),a.setValue(`forms.${i}.balance`,"")}})}},classNames:"mt-2 w-full"}),((d=(m=(n=a.formState.errors)==null?void 0:n.forms)==null?void 0:m[t])==null?void 0:d.reimburse_type)&&e.jsx(Ie,{error:!0,children:(y=(c=(h=(o=a.formState.errors)==null?void 0:o.forms)==null?void 0:h[t])==null?void 0:c.reimburse_type)==null?void 0:y.message})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Family"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:`forms.${t}.for`,render:({field:l})=>{var r,p,f,g;return e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(Z,{disabled:((f=(p=(r=G==null?void 0:G[t])==null?void 0:r.filter(i=>(i==null?void 0:i.value)==a.getValues(`forms.${t}.reimburse_type`)))==null?void 0:p[0])==null?void 0:f.is_employee)===1||j===x.edit,onValueChange:i=>{b(t,{...s,for:i}),le(t,{reimburse_type:a.getValues(`forms.${t}.reimburse_type`)})},defaultValue:s==null?void 0:s.for,value:s.for,children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(J,{placeholder:"-"})}),e.jsx(K,{children:(g=Ge[t])==null?void 0:g.map(i=>e.jsx(X,{value:i.value.toString(),children:i.label},i.value))})]})}),e.jsx(N,{})]})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Purchasing Group"}),e.jsxs("td",{children:[e.jsx(re,{fieldLabel:"",options:Ve,fieldName:`forms.${t}.purchasing_group`,disabled:j===x.edit,placeholder:"Puchasing Group",classNames:"mt-2 w-full",onChangeOutside:async(l,r)=>{l.length>0&&l!==(r==null?void 0:r.value)&&await ge(l,{name:"purchasing_group_desc",id:"id",tabel:"purchasing_groups",idType:"string",search:l}),r!=null&&r.value&&b(t,{...s,purchasing_group:r==null?void 0:r.value})}}),((k=(M=(q=a.formState.errors)==null?void 0:q.forms)==null?void 0:M[t])==null?void 0:k.purchasing_group)&&e.jsx(Ie,{error:!0,children:(R=(ce=(w=(F=a.formState.errors)==null?void 0:F.forms)==null?void 0:w[t])==null?void 0:ce.purchasing_group)==null?void 0:R.message})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Tax"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:`forms.${t}.tax_on_sales`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(Z,{disabled:!0,onValueChange:r=>{b(t,{...s,tax_on_sales:r})},defaultValue:s.tax_on_sales,children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(J,{placeholder:"-"})}),e.jsx(K,{children:(Be??[]).map((r,p)=>e.jsxs(X,{value:r.value.toString(),children:[r.description," - ",r.label]},r.value))})]})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Uom"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:`forms.${t}.purchase_requisition_unit_of_measure`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(Z,{disabled:!0,onValueChange:r=>{b(t,{...s,purchase_requisition_unit_of_measure:String(r)})},defaultValue:s.purchase_requisition_unit_of_measure,children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(J,{placeholder:"-"})}),e.jsx(K,{children:(Ae??[]).map((r,p)=>e.jsx(X,{value:r.value.toString(),children:`${r.label} - ${r.iso_code}`},r.value))})]})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Remark"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:`forms.${t}.short_text`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(Se,{placeholder:"Insert remark",onChange:r=>{b(t,{...s,short_text:r.target.value})},defaultValue:s.short_text})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Current Balance"}),e.jsx("td",{children:e.jsx("span",{className:"font-bold",children:((D=_[t])==null?void 0:D.balance)&&W(($=_[t])==null?void 0:$.balance)})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Limit Claim"}),e.jsxs("td",{children:[e.jsx("span",{className:"font-bold",children:(z=_[t])==null?void 0:z.limit})," "]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Receipt Date"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:`forms.${t}.item_delivery_data`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(Ne,{disabled:j===x.edit,initialDate:l.value instanceof Date?l.value:new Date(l.value),onDateChange:r=>{l.onChange(r),b(t,{...s,item_delivery_data:r})}})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Claim Date"}),e.jsx("td",{children:e.jsx(v,{control:a.control,name:`forms.${t}.claim_date`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(Ne,{disabled:j===x.edit,initialDate:l.value instanceof Date?l.value:new Date(l.value),onDateChange:r=>{l.onChange(r),b(t,{...s,claim_date:r})}})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Reimburse Cost"}),e.jsxs("td",{className:"w-full grid grid-cols-7 gap-x-4",children:[e.jsx("div",{className:"col-span-3",children:e.jsx(v,{control:a.control,name:`forms.${t}.currency`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(Z,{disabled:j===x.edit,onValueChange:r=>{b(t,{...s,currency:r})},defaultValue:s.currency,children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(J,{placeholder:"-"})}),e.jsx(K,{children:ne.map(r=>e.jsxs(X,{value:r.code,children:[r.name," (",r.code,")"]},r.code))})]})}),e.jsx(lt,{className:"h-6"}),e.jsx(N,{})]})})}),e.jsx("div",{className:"col-span-4",children:e.jsx(v,{control:a.control,name:`forms.${t}.balance`,render:({field:l})=>{var r;return e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(Fe,{type:"text",placeholder:"0",onChange:p=>{var te;const f=p.target.value.replace(/[^0-9]/g,""),g=W(f,!1),i=parseInt(f)||0,O=((te=_[t])==null?void 0:te.balance)||0;if(i>O){p.target.value=W(f.slice(0,-1),!1);return}b(t,{...s,balance:f}),p.target.value=g,a.getValues("forms").forEach((de,P)=>{if(P>t&&de.reimburse_type===s.reimburse_type){const V=O-i;B(se=>{const pe=[...se];return pe[P]={...pe[P],balance:V},pe}),b(P,{...s,balance:""})}})},defaultValue:W(s.balance,!1),value:W(s.balance,!1),disabled:typeof _[t]>"u"||((r=_[t])==null?void 0:r.length)===0||j===x.edit})}),e.jsx(N,{})]})}})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"File Attachment"}),e.jsxs("td",{children:[e.jsx(v,{control:a.control,name:`forms.${t}.attachment`,render:({field:l})=>e.jsxs(S,{children:[e.jsx(ct,{className:"text-xs text-gray-500 font-extralight mb-1",children:"Max File: 1000KB, Extension : jpg,jpeg,png,pdf,heic"}),e.jsx(C,{children:e.jsx("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-xs shadow-sm transition-colors file:border-0 file:bg-transparent file:text-xs file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",type:"file",multiple:!0,accept:"image/*,.pdf,.heic",onChange:r=>{const p=r.target.files;if(p){const f=[...s.attachment],g=Array.from(p);f.push(...g),b(t,{...s,attachment:f})}}})}),e.jsx(N,{})]})}),e.jsx("div",{className:"mt-2",children:s.attachment&&s.attachment.length>0&&e.jsx("ul",{children:s.attachment.map((l,r)=>e.jsxs("li",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:l.name}),e.jsx("button",{type:"button",className:"text-red-500 ml-2",onClick:()=>{const p=s.attachment.filter((f,g)=>g!==r);b(t,{...s,attachment:p})},children:"Delete"})]},r))})})]})]})]})})})]},t)})]}),e.jsx(wt,{onClick:async()=>await we(),variant:"contained",color:"primary",type:"button",children:"Check Approval"}),e.jsx("div",{className:"my-2",children:xe&&e.jsx(bt,{workflowApproval:{approvalRequest:Y.approvalRequest,approvalFrom:Y.approvalFrom,acknowledgeFrom:Y.acknowledgeFrom},workflowApprovalStep:Y.approvalFromStatusRoute,workflowApprovalDiagram:Y.approvalFrom})}),e.jsx(Ce,{className:"my-4"}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(nt,{type:"submit",className:"w-32",children:"Submit"})})]})})})})};export{xs as ReimburseForm};
