import{r as C,u as P,j as e}from"./app-IQwIjIau.js";import{F as U,a as d,b as l,c as t,d as c,e as m}from"./form-B2mg5zRK.js";import{z as n,t as Y}from"./index-BxkK7xV6.js";import{F as x,B as k}from"./button-Y24lxrSy.js";import{u as z,b as $}from"./index.esm-BNAaWfT5.js";import{T as H}from"./textarea-0din5DI3.js";import{S as N}from"./scroll-area-CulWtV1S.js";import{S as j,a as u,b as p,c as g,d as h}from"./select-BLw5suOl.js";import{I as f}from"./input-BAlMeipZ.js";import{a as v}from"./axiosInstance-hLWWsmsQ.js";import{R as V,a as _}from"./radio-group-jMFJpNqV.js";import{M as J}from"./MultiSelect-D19VdeNc.js";import{a as K}from"./api-BySVmGlY.js";import"./app-wnGHkkFm.js";import"./index-Ht2wqHtY.js";import"./react-icons.esm-sEdd_eQx.js";import"./index-BBxVCVUD.js";import"./Combination-CbByGIRC.js";import"./index-DarIWjgc.js";import"./index-9aZaOJ5R.js";import"./index-BqCNLysa.js";var Q=(i=>(i[i.create=0]="create",i[i.edit=1]="edit",i[i.update=2]="update",i))(Q||{});function ve({onSuccess:i,type:o=x.create,detailUrl:F,id:W,listCurrency:q,listAllowanceCategory:M,listGrade:S,listMaterial:X,createUrl:I,editUrl:T,listMaterialGroup:A}){const G=n.object({code:n.string().min(1,"Code is required"),name:n.string().min(1,"Name is required"),type:n.string().min(1,"Type is required"),material_number:n.string().min(1,"Material number required"),material_group:n.string().min(1,"Material Group required"),currency_id:n.string().min(1,"Currency is required"),formula:n.string().min(1,"Formula is required"),allowance_category_id:n.string().min(1,"Allowance Category is required"),request_value:n.string().min(1,"Required"),grade_option:n.string().min(1,"Grade must be selected"),grade_all_price:n.string().optional(),grades:n.array(n.object({grade:n.string(),id:n.number(),plafon:n.string()}))}),[R,L]=C.useState([]),E={code:"",name:"",type:"",currency_id:"",formula:"",allowance_category_id:"",request_value:"unlimited",grade_option:"all",grade_all_price:"0",grades:[]},s=z({resolver:Y(G),defaultValues:E});async function D(){try{const a=await v.get(F??""),r=a.data.data.allowance;w(r.material_group);const y=a.data.data.grades;s.reset({code:r.code,name:r.name,type:r.type,material_number:r.material_group,material_group:r.material_group,currency_id:r.currency_id,formula:r.formula,allowance_category_id:r.allowance_category_id,request_value:r.request_value,grade_option:r.grade_option,grade_all_price:r.grade_all_price,grades:y})}catch{}}const{fields:B}=$({control:s.control,name:"grades"});console.log("type",o);const{showToast:b}=P(),O=async a=>{try{if(console.log(a),o===x.create){const r=await v.post(I??"",a)}else if(o===x.edit){const r=await v.put(T??"",a)}b("success","success"),i==null||i(!0)}catch{i==null||i(!1),b("Please Check the input","error")}};async function w(a){try{const r=await v.get(K(a));s.setValue("material_group",a),L(r.data.data)}catch(r){console.log(r)}}return C.useEffect(()=>{(o===x.detail||o===x.edit)&&D()},[]),e.jsx(N,{className:"h-[600px] w-full",children:e.jsx(U,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(O),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"code",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsx(f,{type:"text",readOnly:o===x.edit,placeholder:"Insert code",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"name",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsx(f,{type:"text",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"type",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsxs(j,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(u,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select type"})}),e.jsxs(g,{children:[e.jsx(h,{value:"daily",children:"DAILY"},"DAILY"),e.jsx(h,{value:"total",children:"Total"},"TOTAL")]})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"material_group",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsxs(j,{onValueChange:r=>{w(r)},value:a.value,children:[e.jsx(u,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Material Number"})}),e.jsx(g,{children:A.map(r=>e.jsx(h,{value:r,children:r},r))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Material Number ",s.getValues("material_number")]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"material_number",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsxs(j,{onValueChange:r=>a.onChange(r),defaultValue:s.getValues("material_number"),children:[e.jsx(u,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Material Number"})}),e.jsx(g,{children:R.map(r=>e.jsx(h,{value:r.material_number,children:r.material_number},r.material_number))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"currency_id",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsxs(j,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(u,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Currency"})}),e.jsx(g,{children:q.map(r=>e.jsxs(h,{value:r.code,children:[r.name," ",r.code]},r.code))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Allowance Category"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"allowance_category_id",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsxs(j,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(u,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Allowance Category"})}),e.jsx(g,{children:M.map(r=>e.jsx(h,{value:r.id.toString(),children:r.name},r.id))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purpose Type"}),e.jsx("td",{children:e.jsx(N,{className:"h-[250px] border rounded-lg p-6 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Formula"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"formula",render:({field:a})=>e.jsxs(l,{children:[e.jsx(t,{children:e.jsx(H,{placeholder:"Insert formula",...a})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(d,{control:s.control,name:"grade_option",render:({field:a})=>e.jsx(l,{children:e.jsx(t,{children:e.jsxs(V,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(_,{value:"all"})}),e.jsx(m,{className:"text-xs",children:"All"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(_,{value:"grade"})}),e.jsx(m,{className:"text-xs",children:"Grade"})]})]})})})}),s.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(d,{control:s.control,name:"grade_all_price",render:({field:a})=>e.jsx(l,{children:e.jsx(t,{children:e.jsx(f,{...a})})})})}):e.jsx("div",{children:e.jsx(J,{label:"grade",id:"id",options:S,value:s.getValues("grades").map(a=>a.id),onSelect:a=>{s.setValue("grades",a.map(r=>({id:r.id,grade:r.grade,plafon:0})))}})}),s.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:B.map((a,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Grade ",a.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(d,{control:s.control,name:`grades.${r}.plafon`,render:({field:y})=>e.jsx(l,{children:e.jsx(t,{children:e.jsx(f,{...y})})})})})})]},a))})}):null]})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Request Value ",s.getValues("request_value")]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"request_value",render:({field:a})=>e.jsx(l,{children:e.jsx(t,{children:e.jsxs(V,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(_,{value:"unlimited"})}),e.jsx(m,{className:"text-xs",children:"Unlimited"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(_,{value:"up to max value"})}),e.jsx(m,{className:"text-xs",children:"Up To Max Value"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(_,{value:"fixed value"})}),e.jsx(m,{className:"text-xs",children:"Fixed Value"})]})]})})})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(k,{type:"submit",children:"Save"})})]})})})}export{Q as AllowanceType,ve as default};
