import{r as i,u as L,j as e,b as f,a as O}from"./app-OCxfqGpa.js";import{l as k}from"./axiosInstance-CJuOVE_4.js";import{B as $,b as T,D as X}from"./DataGrid-CnwByQhs.js";const K=({columns:C,buttonCustome:S,onExport:y,url:a,labelFilter:b="Search",onEdit:d,onDelete:n,onDetail:c,defaultSearch:v})=>{const[U,M]=i.useState([]),[z,N]=i.useState(!1),[l,B]=i.useState({page:0,pageSize:10}),[x,R]=i.useState([]),[h,A]=i.useState({items:[]}),[F,I]=i.useState(0),[g,P]=i.useState(""),{showToast:j}=L(),u=i.useCallback(async(t,p,m,o,s)=>{N(!0);const w=o.length>0?o[0].field:"id",E=o.length>0?o[0].sort:"asc",G=s.items.map(r=>`${r.field}=${r.operator},${r.value}`).join("&");try{const r=await k.get(`${a.url}${v||"?"}page=${t+1}&per_page=${p}&search=${m}&sort_by=${w}&sort_direction=${E}&${G}`);M(r.data.data.data),I(r.data.data.total)}catch(r){console.error("Error fetching data:",r)}finally{N(!1)}},[a]);i.useEffect(()=>{u(l.page,l.pageSize,g,x,h)},[u,h,l,g,x]);const W=async t=>{var p,m,o;try{const s=await k.delete(`${a.deleteUrl}/${t}`);console.log(s==null?void 0:s.data),j(((p=s==null?void 0:s.data)==null?void 0:p.message)||"Record deleted successfully","success"),n&&await n(t),u(l.page,l.pageSize,g,x,h)}catch(s){if(O.isAxiosError(s)){const w=((o=(m=s.response)==null?void 0:m.data)==null?void 0:o.message)||"Failed to delete record";j(w,"error")}else j("An unexpected error occurred","error")}},_=d||n||c||a.detailUrl||a.editUrl||a.deleteUrl?[{field:"actions",headerName:"Actions",width:150,renderCell:t=>e.jsx(e.Fragment,{children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(c||a.detailUrl)&&e.jsx(f,{href:`${a.detailUrl}/${t.row.id}`,onClick:()=>c&&c(t.row.id),alt:"detail",children:e.jsx("i",{className:" ki-duotone ki-size text-info text-2xl"})}),(d||a.editUrl)&&e.jsx(f,{href:`${a.editUrl}/${t.row.id}`,onClick:()=>d&&d(t.row.id),alt:"edit",children:e.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})}),(a.deleteUrl||n)&&e.jsx(f,{href:"",onClick:()=>W(t.row.id),alt:"delete",children:e.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})]})})}]:[];return e.jsx($,{children:e.jsx($,{sx:{height:"45rem",width:"100%",overflowX:"auto"},children:e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"grid",children:e.jsxs("div",{className:"card card-grid h-full min-w-full",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:e.jsxs("div",{className:"input input-sm max-w-48",children:[e.jsx("i",{className:"ki-filled ki-magnifier"}),e.jsx("input",{placeholder:b,type:"text",value:g,onChange:t=>P(t.target.value),style:{width:"100%",maxWidth:"200px",marginBottom:"10p"}})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[a.addUrl&&e.jsxs(f,{href:a.addUrl??"#",className:"btn btn-success",style:{marginRight:"10px",marginBottom:"10px"},children:[e.jsx("i",{className:"ki-filled ki-additem"}),"Add New"]}),y&&e.jsx(T,{className:"btn",variant:"contained",onClick:()=>y(),color:"primary",startIcon:e.jsx("i",{className:"ki-filled ki-folder-down"}),style:{marginBottom:"10px"},children:"Export"}),S]})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{"data-datatable":"true","data-datatable-page-size":l.pageSize,children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx(X,{rows:U,columns:[...C,..._],loading:z,paginationMode:"server",rowCount:F,paginationModel:l,onPaginationModelChange:B,pageSizeOptions:[10,20],sortingMode:"server",sortModel:x,onSortModelChange:t=>R(t),filterMode:"server",filterModel:h,onFilterModelChange:t=>A(t)})})})})]})})})})})};export{K as D};
