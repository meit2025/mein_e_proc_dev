import{j as s,r as N,u as T,b as w}from"./app-KJM3UHcm.js";import{F as A}from"./formInput-DGJo588I.js";import{F as I}from"./formDropdown-Be-7mJ3Y.js";import{F as R}from"./formCheckbox-BiZ8bf7h.js";import{a as E,C as S,F as k}from"./index.esm-p30U0Lp5.js";import{A as $,T as P,C as V,I as B}from"./TextField-DQlJY1w7.js";import{F as C}from"./FormHelperText-H8Jp4z2H.js";import{F as H}from"./formTextArea-B1UXTqDz.js";import{F as W}from"./formSwitch-lWlXwz5p.js";import{a as _}from"./axiosInstance-ajWTG04w.js";import{L as z}from"./Loading-C9moxGQ9.js";const D=({fieldLabel:e,fieldName:a,isRequired:p=!1,disabled:d=!1,style:h,requiredMessage:j,options:o=[],placeholder:q,classNames:g,onChangeOutside:x})=>{const{control:b,formState:{errors:m}}=E();return s.jsx(S,{name:a,control:b,rules:{required:p?j??`${e} is required`:!1},render:({field:u})=>{var f;return s.jsxs("div",{style:h,className:g,children:[s.jsx($,{...u,multiple:!0,options:o,getOptionLabel:t=>t.label,isOptionEqualToValue:(t,i)=>t.value===i,onChange:(t,i)=>{u.onChange(i.map(l=>l.value)),x&&x(i.map(l=>l.value))},value:o.filter(t=>{var i;return(i=u.value)==null?void 0:i.includes(t.value)}),disabled:d,renderInput:t=>s.jsx(P,{...t,label:e,placeholder:q,error:!!m[a],required:p}),renderTags:(t,i)=>t.map((l,r)=>N.createElement(V,{label:l.label,...i({index:r}),key:r}))}),m[a]&&s.jsx(C,{error:!0,children:String((f=m[a])==null?void 0:f.message)})]})}})},G=({fieldLabel:e,fieldName:a,isRequired:p=!1,disabled:d=!1,style:h,requiredMessage:j,allowedExtensions:o=[],classNames:q,onFileChangeOutside:g})=>{const[x,b]=N.useState(null),{control:m,formState:{errors:u},setError:f,clearErrors:t}=E(),i=(l,r)=>{var y;const n=l.target.files?l.target.files[0]:null;if(n){const F=(y=n.name.split(".").pop())==null?void 0:y.toLowerCase();if(o.length>0&&F&&!o.includes(F)){r(null),b(null),f(a,{type:"manual",message:`Invalid file type. Allowed types: ${o.join(", ")}`});return}t(a),b(n.name),r(n),g&&g(n)}else r(null),b(null),t(a)};return s.jsx(S,{name:a,control:m,rules:{required:p?j??`${e} is required`:!1},render:({field:l})=>{var r;return s.jsxs("div",{style:h,className:q,children:[s.jsx("label",{children:e}),s.jsx(B,{type:"file",disabled:d,onChange:n=>i(n,l.onChange)}),x&&s.jsxs("p",{children:["Selected file: ",x]}),u[a]&&s.jsx(C,{error:!0,children:String((r=u[a])==null?void 0:r.message)})]})}})},J=({model:e,onChangeOutside:a})=>{switch(e.type){case"input":return s.jsx(A,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,type:e.texttype,requiredMessage:e.requiredMessage,placeholder:e.placeholder,minLength:e.minLength,maxLength:e.maxLength,classNames:e.classNames,icon:e.icon});case"textarea":return s.jsx(H,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames});case"select":return s.jsx(I,{options:e.options??[],fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames,onChangeOutside:a});case"checkbox":return s.jsx(R,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,classNames:e.classNames});case"multiselect":return s.jsx(D,{options:e.options??[],fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,placeholder:e.placeholder,classNames:e.classNames,onChangeOutside:a});case"switch":return s.jsx(W,{fieldLabel:e.label??"",fieldName:e.name??"",isRequired:e.required,disabled:e.disabled,style:e.style,requiredMessage:e.requiredMessage,classNames:e.classNames});case"file":return s.jsx(G,{fieldLabel:e.label??"",fieldName:e.name??"",allowedExtensions:e.allowedExtensions,disabled:e.disabled,onFileChangeOutside:a});default:return null}},te=({formModel:e,url:a,redirectUrl:p,methods:d,onSave:h,isLoading:j,classForm:o,isCustom:q=!1,formCustom:g,formLogic:x,disableButtonSubmit:b=!1})=>{const{setError:m,watch:u}=d,{showToast:f}=T(),[t,i]=N.useState(!1),l=async r=>{var n,y,F,L;i(!0);try{const c=await _.post(a,r,{headers:{"Content-Type":"application/json"}});f(c.data.message??"success","success"),h&&await h(c),p&&setTimeout(()=>{window.location.href=p},2e3)}catch(c){if(w.isAxiosError(c)&&((y=(n=c.response)==null?void 0:n.data)!=null&&y.message)&&f(c.response.data.message,"error"),w.isAxiosError(c)&&((L=(F=c.response)==null?void 0:F.data)!=null&&L.errors)){const v=c.response.data.errors;Object.keys(v).forEach(M=>{m(M,{type:"server",message:v[M].join(", ")})})}}i(!1)};return s.jsxs(k,{...d,children:[s.jsx(z,{isLoading:j||t}),s.jsxs("form",{onSubmit:d.handleSubmit(l),children:[s.jsxs("div",{className:o,children:[q?s.jsx(s.Fragment,{children:g}):s.jsx(s.Fragment,{children:(e??[]).map((r,n)=>s.jsx("div",{className:`mt-8 ${r.classPosition}`,children:r.fieldCustome?r.fieldCustomeValue:s.jsx(s.Fragment,{children:!r.conditional||u(r.parameterConditional??"")===r.conditional?s.jsx(J,{model:r}):null})},n))}),x]}),!b&&s.jsx("div",{className:"flex justify-end mt-8",children:s.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",children:"Submit"})})]})]})};export{te as F};
