import{r as b,u as B,j as e}from"./app-J3C_gNYK.js";import{F as U,a as d,b as n,c as i,d as x,e as E}from"./form-CfE7Jfyn.js";import{z as t,t as $}from"./index-D-lnPlpe.js";import{B as Y}from"./button-CGaoiNOe.js";import{u as O,b as z}from"./index.esm-BvbBLOu8.js";import{S as q}from"./scroll-area-Cc0rEE6R.js";import{S as k,a as H,b as J,c as K,d as y}from"./select-a0WdTGIU.js";import{I as c}from"./input-DU9_6gxV.js";import{a as p}from"./axiosInstance-Bk-VVKCf.js";import{F as u}from"./utils-DDnST7vQ.js";import{M as Q}from"./MultiSelect-Wm6mYoSY.js";import{R as W,a as v}from"./radio-group-CzcJ4LJc.js";import{L as X}from"./Loading-CxioakGc.js";import{F as N}from"./formDropdown-DnZo0FH_.js";import{u as S}from"./getDropdown-dOHWYze0.js";const m="/api/master/reimburse-type",ge=`${m}/`,Z=`${m}/create`,_e=o=>`${m}/edit/${o}`,fe=o=>`${m}/update/${o}`,be=`${m}/delete`;function ee({onSuccess:o,type:h=u.create,listGrades:M,editURL:w,updateURL:I,id:ae}){const R=t.object({code:t.string(),name:t.string().min(1,"Name is required"),is_employee:t.boolean(),limit:t.number(),material_group:t.number("Material Group must choose"),material_number:t.number("Material Number must choose"),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string()}))}),[F,j]=b.useState(!1),{dataDropdown:T,getDropdown:g}=S(),{dataDropdown:C,getDropdown:_}=S(),D={code:"",name:"",material_group:null,material_number:null,is_employee:!0,grade_option:"all",grade_all_price:"0",grades:[]},s=O({resolver:$(R),defaultValues:D});async function G(){try{const r=(await p.get(w)).data.data;s.reset({code:r.code,name:r.name,limit:r.limit,is_employee:r.is_employee,material_group:parseInt(r.material_group),material_number:parseInt(r.material_number),grade_option:r.grade_option,grade_all_price:r.grade_all_price,grades:r.grades})}catch{}}const{fields:P}=z({control:s.control,name:"grades"}),{showToast:f}=B(),A=async a=>{var r;j(!0);try{let l;h===u.edit?l=await p.put(I??"",a):l=await p.post(Z??"",a),o&&o(!0),f((r=l==null?void 0:l.data)==null?void 0:r.message,"success")}catch(l){o&&o(!1),f(l.message,"error")}j(!1)},L=async a=>{a.length>0&&g("",{name:"material_group",id:"id",tabel:"material_groups",search:a})},V=async a=>{a.length>0&&_(a,{name:"material_number",id:"id",tabel:"master_materials"})};return b.useEffect(()=>{g("",{name:"material_group",id:"id",tabel:"material_groups"}),_("",{name:"material_number",id:"id",tabel:"master_materials"}),h===u.edit&&G(),document.body.style.removeProperty("pointer-events")},[]),e.jsxs(q,{className:"h-[600px] w-full",children:[e.jsx(X,{isLoading:F}),e.jsx(U,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(A),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"code",render:({field:a})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(c,{type:"text",placeholder:"Insert code",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value),disabled:h===u.edit})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"name",render:({field:a})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(c,{type:"text",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"For"}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"is_employee",render:({field:a})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs(k,{onValueChange:r=>a.onChange(r==="true"),value:a.value?"true":"false",children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(J,{placeholder:"-"})}),e.jsxs(K,{children:[e.jsx(y,{value:"true",children:"Employee"},"is_employee"),e.jsx(y,{value:"false",children:"Family"},"is_employee")]})]})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Limit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(d,{control:s.control,name:"limit",render:({field:a})=>e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(c,{onChange:r=>a.onChange(Number(r.target.value)),value:a.value})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(d,{control:s.control,name:"grade_option",render:({field:a})=>e.jsx(n,{children:e.jsx(i,{children:e.jsxs(W,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex space-x-1",children:[e.jsxs(n,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(i,{children:e.jsx(v,{value:"all"})}),e.jsx(E,{className:"text-xs",children:"All"})]}),e.jsxs(n,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(i,{children:e.jsx(v,{value:"grade"})}),e.jsx(E,{className:"text-xs",children:"Grade"})]})]})})})}),s.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(d,{control:s.control,name:"grade_all_price",render:({field:a})=>e.jsx(n,{children:e.jsx(i,{children:e.jsx(c,{...a})})})})}):e.jsx("div",{children:e.jsx(Q,{label:"grade",id:"id",options:M,value:s.getValues("grades").map(a=>a.id),onSelect:a=>{s.setValue("grades",a.map(r=>({id:r.id,grade:r.grade,plafon:0})))}})}),s.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:P.map((a,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Balance ",a.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(d,{control:s.control,name:`grades.${r}.plafon`,render:({field:l})=>e.jsx(n,{children:e.jsx(i,{children:e.jsx(c,{...l})})})})})})]},a))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(N,{options:T,fieldName:"material_group",isRequired:!0,disabled:!1,placeholder:"Material Group",onSearch:L,classNames:"mt-2 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(N,{options:C,fieldName:"material_number",isRequired:!0,disabled:!1,placeholder:"Material Number",onSearch:V,classNames:"mt-2 w-full"})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(Y,{type:"submit",children:"Save"})})]})})]})}const Ee=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{be as D,_e as E,ge as L,ee as R,fe as U,Ee as f};
