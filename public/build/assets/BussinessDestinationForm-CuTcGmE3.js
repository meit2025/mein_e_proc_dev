import{r as L,j as e}from"./app-DMbYu23H.js";import{F as b,a as w,b as g,c as D}from"./form-DAJC2tdp.js";import{B as P}from"./button-CdAWgLfw.js";import{b as A}from"./index.esm-9prihnaX.js";/* empty css              */import{c as H}from"./tabs-DDnMQn7T.js";import{C as F}from"./CustomDatePicker-CRtKJv0I.js";import{h as p}from"./moment-C5S46NFB.js";import{F as m}from"./formDropdown-DhQUIe5D.js";import{DetailAttedances as M}from"./DetailAttedances-C4cBXGkz.js";import{DetailAllowance as U}from"./DetailAllowance-Bg9l3bBu.js";import{ResultTotalItem as z}from"./ResultTotalItem-BKH8rWsi.js";import"./app-DQK4SJPx.js";import"./index-CYVWaTbN.js";import"./utils-BPR6Gueu.js";import"./index-Bpll8WDK.js";import"./index-Bb4qSo10.js";import"./index-BB6B68ni.js";import"./index-BWNEL0Uj.js";import"./index-vKjFY2i_.js";import"./index-oj98Poo4.js";import"./index-BcsUD2_l.js";import"./index-CqFfvC-k.js";import"./index-DU4hmR3a.js";import"./popover-Bz1dJhvO.js";import"./Combination-Cf3yjNO6.js";import"./createLucideIcon-D83whIT_.js";import"./TextField-BbStw1b9.js";import"./createSvgIcon-D2fxEQ7_.js";import"./DefaultPropsProvider-D12x4N75.js";import"./useSlot-zf9WQjYL.js";import"./createSimplePaletteValueFilter-CNMyxT__.js";import"./useControlled-Kc6UHPtc.js";import"./FormHelperText-YAEbLzUn.js";import"./input-BmO4evuK.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-C4VpsnHH.js";function qe({form:o,index:s,destination:l,updateDestination:n,listAllowances:y,setTotalAllowance:N,pajak:J,purchasingGroup:K,dataTax:C,dataPurchasingGroup:S,dataDestination:I,type:u,btClone:h}){const{fields:k,update:B,append:$,remove:q}=A({control:o.control,name:`destinations.${s}.detail_attedances`}),{fields:_,update:Q,append:V,remove:O,replace:R}=A({control:o.control,name:`destinations.${s}.allowances`});function v(){let t=p(l.business_trip_start_date).startOf("day");const a=p(l.business_trip_end_date).startOf("day");for(q(),O();t.isBefore(a)||t.isSame(a);){const r={date:t.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};$(r),t=t.add(1,"days")}function d(r){let c=p(l.business_trip_start_date).startOf("day");const f=p(l.business_trip_end_date).startOf("day"),x=[];for(;c.isBefore(f)||c.isSame(f);)x.push({date:c.toDate(),request_price:r}),c=c.add(1,"days");return x}const i=y.map(r=>({name:r.name,code:r.code,default_price:parseInt(r.grade_price),type:r.type,subtotal:parseInt(r.grade_price),currency:r.currency_id,request_value:r.request_value,detail:r.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(r.grade_price)}]:d(r.grade_price)}));console.log(i,"allowancesForm"),R(i)}const[E,j]=L.useState([]),G=(t,a)=>{n(a,{...l,business_trip_start_date:t}),console.log(a),j(d=>{const i=[...d];return i[a]={...i[a],start:t},i})},T=(t,a)=>{n(a,{...l,business_trip_end_date:t}),j(d=>{const i=[...d];return i[a]={...i[a],end:t},i})};return console.log(E,"Destination"),e.jsxs(H,{value:`destination${s+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:I,fieldName:`destinations.${s}.destination`,isRequired:!0,disabled:!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:t=>{n(s,{...l,destination:t})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Pajak",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:C,fieldName:`destinations.${s}.pajak_id`,isRequired:!0,disabled:!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:t=>{n(s,{...l,pajak_id:t})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Purchasing Group",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:S,fieldName:`destinations.${s}.purchasing_group_id`,isRequired:!0,disabled:!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:t=>{n(s,{...l,purchasing_group_id:t})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(b,{control:o.control,name:`destinations.${s}.business_trip_start_date`,render:({field:t})=>e.jsxs(w,{children:[e.jsx(g,{children:e.jsx(F,{initialDate:l.business_trip_start_date,onDateChange:a=>{G(a,s)},disabled:!1,disabledDays:[]})}),e.jsx(D,{})]})}),e.jsx("span",{children:"To"}),e.jsx(b,{control:o.control,name:`destinations.${s}.business_trip_end_date`,render:({field:t})=>e.jsxs(w,{children:[e.jsx(g,{children:e.jsx(F,{initialDate:l.business_trip_end_date,onDateChange:a=>{T(a,s)},disabled:!1,disabledDays:[]})}),e.jsx(D,{})]})}),e.jsx(P,{type:"button",onClick:()=>v(),children:"Get Detail"})]})]})]}),e.jsx(M,{detailAttedanceFields:k,form:o,updateAttedanceFields:B,destinationIndex:s,type:u,btClone:h}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(U,{allowanceField:_,destinationIndex:s,form:o,type:u,btClone:h})]},s),e.jsx(z,{allowanceField:_,destinationIndex:s,form:o,setTotalAllowance:N})]})}export{qe as BussinessDestinationForm};
