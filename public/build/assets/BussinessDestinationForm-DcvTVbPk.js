import{r as K,j as e}from"./app-DYsPJ8P4.js";import{F as j,a as f,b,c as x}from"./form-C6zc_rA8.js";import{B as Q}from"./button-B_QfvaQ2.js";import{b as D}from"./index.esm-Bjjr4Qw4.js";/* empty css              */import{c as V}from"./tabs-CYT-IGL1.js";import{C as I}from"./CustomDatePicker-CeOWd_f8.js";import{h as u}from"./moment-C5S46NFB.js";import{F as w}from"./formDropdown-CGZz-9Yv.js";import{DetailAttedances as W}from"./DetailAttedances-C6V4CdUM.js";import{DetailAllowance as X}from"./DetailAllowance-CePkjrGB.js";import{ResultTotalItem as Y}from"./ResultTotalItem-CCNVgMfI.js";import{C as Z}from"./checkbox-BRmEj8Mi.js";import"./app-DQK4SJPx.js";import"./index-Dvk9T3vt.js";import"./utils-DP-9WHbz.js";import"./index-DCsr_m9R.js";import"./index-Bb4qSo10.js";import"./index-D5uES62b.js";import"./index-velUouE2.js";import"./index-BndFF8U9.js";import"./index-BUlfZ7hH.js";import"./index-CB6QIvXA.js";import"./index-BJYzaqat.js";import"./index-CMZNEjtW.js";import"./popover-BcBX-Mct.js";import"./Combination-BenByMUd.js";import"./createLucideIcon-pqGE68O5.js";import"./TextField-DsD1CAPc.js";import"./createSvgIcon-DePMKZKr.js";import"./DefaultPropsProvider-BOgTbiBS.js";import"./useSlot-Bp-41szG.js";import"./createSimplePaletteValueFilter-Dh5Il_gA.js";import"./useControlled-Dd3nGp4b.js";import"./FormHelperText-BxEzD13e.js";import"./input-oFfgWh1r.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-yq91yk_W.js";import"./index-CF28-CNO.js";function Me({key:S,form:n,index:t,destination:a,updateDestination:d,listAllowances:$,setTotalAllowance:B,pajak:ee,purchasingGroup:te,dataTax:q,dataPurchasingGroup:E,dataDestination:O,type:g,btClone:A,setSelectedDates:m,selectedDates:h}){const{fields:G,update:T,append:L,remove:P}=D({control:n.control,name:`destinations.${t}.detail_attedances`}),{fields:F,update:se,append:re,remove:H,replace:M}=D({control:n.control,name:`destinations.${t}.allowances`});function U(){let s=u(a.business_trip_start_date).startOf("day");const r=u(a.business_trip_end_date).startOf("day");for(P(),H();s.isBefore(r)||s.isSame(r);){const o={date:s.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};L(o),s=s.add(1,"days")}function i(o){let p=u(a.business_trip_start_date).startOf("day");const y=u(a.business_trip_end_date).startOf("day"),R=[];for(;p.isBefore(y)||p.isSame(y);)R.push({date:p.toDate(),request_price:o}),p=p.add(1,"days");return R}const l=$.map(o=>({name:o.name,code:o.code,default_price:parseInt(o.grade_price),type:o.type,subtotal:parseInt(o.grade_price),currency:o.currency_id,request_value:o.request_value,detail:o.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(o.grade_price)}]:i(o.grade_price)}));console.log(l,"allowancesForm"),M(l)}const C=(s,r)=>{m(i=>{const l=[...i];return l[r]={...l[r],from:s},l})},v=(s,r)=>{d(r,{...a,business_trip_end_date:s}),m(i=>{const l=[...i];return l[r]={...l[r],to:s},l})},[k,c]=K.useState(),_={};k&&(_.selected=k);const N=(s,r)=>{r==="start"&&(d(s,{...a,business_trip_start_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],from:void 0},l})),r==="end"&&(d(s,{...a,business_trip_end_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],to:void 0},l})),c(void 0)};let z=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>N(t,"start"),children:"Reset"})}),J=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>N(t,"end"),children:"Reset"})});return console.log(h,"selectedDatesxwerewferge"),e.jsxs(V,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(w,{fieldLabel:"",options:O,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,destination:s})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Restricted Area"}),e.jsx("td",{children:e.jsx(j,{control:n.control,name:`destinations.${t}.restricted_area`,render:({field:s})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(Z,{checked:a.restricted_area,onCheckedChange:r=>{d(t,{...a,restricted_area:r})}})}),e.jsx(x,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Pajak",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(w,{fieldLabel:"",options:q,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,pajak_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Purchasing Group",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(w,{fieldLabel:"",options:E,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,purchasing_group_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(j,{control:n.control,name:`destinations.${t}.business_trip_start_date`,render:({field:s})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(I,{initialDate:a.business_trip_start_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(C(void 0,t),c(void 0),d(t,{...a,business_trip_start_date:void 0})):(C(r,t),c(r),d(t,{...a,business_trip_start_date:r}))},disabled:!1,disabledDays:h,footer:z})}),e.jsx(x,{})]})}),e.jsx("span",{children:"To"}),e.jsx(j,{control:n.control,name:`destinations.${t}.business_trip_end_date`,render:({field:s})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(I,{initialDate:a.business_trip_end_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(v(void 0,t),c(void 0),d(t,{...a,business_trip_end_date:void 0})):(v(r,t),c(r),d(t,{...a,business_trip_end_date:r}))},disabled:!1,disabledDays:h,footer:J})}),e.jsx(x,{})]})}),e.jsx(Q,{type:"button",onClick:()=>U(),children:"Get Detail"})]})]})]}),e.jsx(W,{detailAttedanceFields:G,form:n,updateAttedanceFields:T,destinationIndex:t,type:g,btClone:A}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(X,{allowanceField:F,destinationIndex:t,form:n,type:g,btClone:A})]},t),e.jsx(Y,{allowanceField:F,destinationIndex:t,form:n,setTotalAllowance:B})]},S)}export{Me as BussinessDestinationForm};
