import{r as b,u as z,j as e}from"./app-Ccg0rK5P.js";import{F as O,a as o,b as l,c as i,d,e as y}from"./form-CP_tihsD.js";import{z as t,t as U}from"./index-BHqF9g1S.js";import{B as Y}from"./button-CrWHOi-a.js";import{u as $,b as k}from"./index.esm-sWff9vC1.js";import{S as H}from"./scroll-area-D0YvIFHn.js";import{S as v,a as N,b as w,c as C,d as x}from"./select-CDdJaQ7n.js";import{I as m}from"./input-Bmzg1aDV.js";import{a as p}from"./axiosInstance-NzqJUoCL.js";import{F as h}from"./utils-BxH0655H.js";import{M as J}from"./MultiSelect-CB4fcIHi.js";import{R as K,a as F}from"./radio-group-CPUNwH0R.js";import{C as Q}from"./api-BBkWHPRN.js";import{L as X}from"./Loading-YiCrxiv8.js";import{F as S}from"./formDropdown-DqtCG97D.js";import{u as M}from"./getDropdown-BhJOeKT9.js";import"./app-HlhieNAw.js";import"./index-cUwhs4EX.js";import"./index-BVi_cE7c.js";import"./index-gJHXcEkY.js";import"./Combination-BzC-iJQT.js";import"./index-DZoyLqkb.js";import"./index-BZSNuBM1.js";import"./index-Hc4OiIvN.js";import"./index-BTbjKoTW.js";import"./checkbox-BuoAvbKw.js";import"./index-C48WW_ql.js";import"./TextField-Bxse_w0o.js";import"./useSlot-BG4mNQXr.js";import"./FormHelperText-C9NCUW-3.js";import"./createSimplePaletteValueFilter-75UGS21f.js";function Ve({onSuccess:c,type:u=h.create,listGrades:G,editURL:I,updateURL:V,id:Z}){const R=t.object({code:t.string(),name:t.string().min(1,"Name is required"),is_employee:t.boolean(),family_status:t.string().optional(),limit:t.number(),material_group:t.number("Material Group must choose"),material_number:t.number("Material Number must choose"),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string()}))}),[E,j]=b.useState(!1),{dataDropdown:A,getDropdown:g}=M(),{dataDropdown:D,getDropdown:f}=M(),L={code:"",name:"",material_group:null,material_number:null,family_status:"",is_employee:!0,grade_option:"all",grade_all_price:"0",grades:[]},s=$({resolver:U(R),defaultValues:L});async function T(){try{const a=(await p.get(I)).data.data;s.reset({code:a.code,name:a.name,limit:a.limit,is_employee:a.is_employee,family_status:a.family_status,material_group:parseInt(a.material_group),material_number:parseInt(a.material_number),grade_option:a.grade_option,grade_all_price:a.grade_all_price,grades:a.grades})}catch{}}const{fields:B}=k({control:s.control,name:"grades"}),{showToast:_}=z(),P=async r=>{var a;j(!0);try{let n;u===h.edit?n=await p.put(V??"",r):n=await p.post(Q??"",r),c&&c(!0),_((a=n==null?void 0:n.data)==null?void 0:a.message,"success")}catch(n){c&&c(!1),_(n.message,"error")}j(!1)},W=async r=>{r.length>0&&g("",{name:"material_group",id:"id",tabel:"material_groups",search:r})},q=async r=>{r.length>0&&f(r,{name:"material_number",id:"id",tabel:"master_materials"})};return b.useEffect(()=>{g("",{name:"material_group",id:"id",tabel:"material_groups"}),f("",{name:"material_number",id:"id",tabel:"master_materials"}),u===h.edit&&T(),document.body.style.removeProperty("pointer-events")},[]),e.jsxs(H,{className:"h-[600px] w-full",children:[e.jsx(X,{isLoading:E}),e.jsx(O,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(P),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"code",render:({field:r})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(m,{type:"text",placeholder:"Insert code",...r,value:r.value||"",onChange:a=>r.onChange(a.target.value),disabled:u===h.edit})}),e.jsx(d,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"name",render:({field:r})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(m,{type:"text",...r,value:r.value||"",onChange:a=>r.onChange(a.target.value)})}),e.jsx(d,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"For"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"is_employee",render:({field:r})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs(v,{onValueChange:a=>r.onChange(a==="true"),value:r.value?"true":"false",children:[e.jsx(N,{className:"w-[200px]",children:e.jsx(w,{placeholder:"-"})}),e.jsxs(C,{children:[e.jsx(x,{value:"true",children:"Employee"},"is_employee"),e.jsx(x,{value:"false",children:"Family"},"is_employee")]})]})}),e.jsx(d,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Family Status"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"family_status",render:({field:r})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs(v,{onValueChange:a=>r.onChange(a),value:r.value,disabled:s.getValues("is_employee")===!0,children:[e.jsx(N,{className:"w-[200px]",children:e.jsx(w,{placeholder:"Child / Wife"})}),e.jsxs(C,{children:[e.jsx(x,{value:"wife",children:"Wife"}),e.jsx(x,{value:"child",children:"Child"})]})]})}),e.jsx(d,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Limit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"limit",render:({field:r})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(m,{onChange:a=>r.onChange(Number(a.target.value)),value:r.value})}),e.jsx(d,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(o,{control:s.control,name:"grade_option",render:({field:r})=>e.jsx(l,{children:e.jsx(i,{children:e.jsxs(K,{onValueChange:r.onChange,defaultValue:r.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(i,{children:e.jsx(F,{value:"all"})}),e.jsx(y,{className:"text-xs",children:"All"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(i,{children:e.jsx(F,{value:"grade"})}),e.jsx(y,{className:"text-xs",children:"Grade"})]})]})})})}),s.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(o,{control:s.control,name:"grade_all_price",render:({field:r})=>e.jsx(l,{children:e.jsx(i,{children:e.jsx(m,{...r})})})})}):e.jsx("div",{children:e.jsx(J,{label:"grade",id:"id",options:G,value:s.getValues("grades").map(r=>r.id),onSelect:r=>{s.setValue("grades",r.map(a=>({id:a.id,grade:a.grade,plafon:0})))}})}),s.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:B.map((r,a)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Balance Grade ",r.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(o,{control:s.control,name:`grades.${a}.plafon`,render:({field:n})=>e.jsx(l,{children:e.jsx(i,{children:e.jsx(m,{...n})})})})})})]},r))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(S,{options:A,fieldName:"material_group",isRequired:!0,disabled:!1,placeholder:"Material Group",onSearch:W,classNames:"mt-2 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(S,{options:D,fieldName:"material_number",isRequired:!0,disabled:!1,placeholder:"Material Number",onSearch:q,classNames:"mt-2 w-full"})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(Y,{type:"submit",children:"Save"})})]})})]})}export{Ve as default};
