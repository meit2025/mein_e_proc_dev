import{j as e}from"./app-CJZqQ82i.js";import{F as w,a as g,b as A,c as F}from"./form-DukKFxJ6.js";import{B as L}from"./button-Bat54kDi.js";import{b as D}from"./index.esm-DqnfJiyN.js";/* empty css              */import{c as P}from"./tabs-WjIGx7wo.js";import{C as y}from"./CustomDatePicker-QfE7n95N.js";import{h as p}from"./moment-C5S46NFB.js";import{F as m}from"./formDropdown-CQalYfic.js";import{DetailAttedances as H}from"./DetailAttedances-BcU1J_K9.js";import{DetailAllowance as M}from"./DetailAllowance-CPH6keG4.js";import{ResultTotalItem as U}from"./ResultTotalItem-DO6e7yig.js";import"./app-DQK4SJPx.js";import"./index-Cu0kE3YA.js";import"./utils-D5HqyF9D.js";import"./index-BonP_6Lo.js";import"./index-Bb4qSo10.js";import"./index-Bvh0zi4I.js";import"./index-BTPwzZHn.js";import"./index-CGLhm4aY.js";import"./index-BWDERLxW.js";import"./index-CKU5GWe1.js";import"./index-CBfTN1Kg.js";import"./index-COWT4z8f.js";import"./popover-Cr44m7Pu.js";import"./Combination-BMbBjtWH.js";import"./createLucideIcon-DEjcTvf6.js";import"./TextField-B0RpZte3.js";import"./createSvgIcon-DS_EE36X.js";import"./DefaultPropsProvider-p5gtanHx.js";import"./extends-CF3RwP-h.js";import"./useSlot-DiPdkj72.js";import"./createSimplePaletteValueFilter-BSvBJbeQ.js";import"./useControlled-BSjgerOj.js";import"./FormHelperText-DcA8acLs.js";import"./input-BZh8lZtj.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-D6Ag6dXY.js";function qe({form:l,index:s,destination:i,updateDestination:n,listAllowances:N,setTotalAllowance:C,pajak:z,purchasingGroup:J,dataTax:I,dataPurchasingGroup:k,dataDestination:B,type:u,btClone:h,setSelectedDates:_,selectedDates:j}){const{fields:S,update:$,append:q,remove:O}=D({control:l.control,name:`destinations.${s}.detail_attedances`}),{fields:f,update:K,append:Q,remove:R,replace:v}=D({control:l.control,name:`destinations.${s}.allowances`});function G(){let t=p(i.business_trip_start_date).startOf("day");const a=p(i.business_trip_end_date).startOf("day");for(O(),R();t.isBefore(a)||t.isSame(a);){const r={date:t.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};q(r),t=t.add(1,"days")}function d(r){let c=p(i.business_trip_start_date).startOf("day");const x=p(i.business_trip_end_date).startOf("day"),b=[];for(;c.isBefore(x)||c.isSame(x);)b.push({date:c.toDate(),request_price:r}),c=c.add(1,"days");return b}const o=N.map(r=>({name:r.name,code:r.code,default_price:parseInt(r.grade_price),type:r.type,subtotal:parseInt(r.grade_price),currency:r.currency_id,request_value:r.request_value,detail:r.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(r.grade_price)}]:d(r.grade_price)}));console.log(o,"allowancesForm"),v(o)}const T=(t,a)=>{n(a,{...i,business_trip_start_date:t}),console.log(a),_(d=>{const o=[...d];return o[a]={...o[a],from:t},o})},E=(t,a)=>{n(a,{...i,business_trip_end_date:t}),_(d=>{const o=[...d];return o[a]={...o[a],to:t},o})};return e.jsxs(P,{value:`destination${s+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:B,fieldName:`destinations.${s}.destination`,isRequired:!0,disabled:!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:t=>{n(s,{...i,destination:t})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Pajak",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:I,fieldName:`destinations.${s}.pajak_id`,isRequired:!0,disabled:!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:t=>{n(s,{...i,pajak_id:t})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Purchasing Group",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(m,{fieldLabel:"",options:k,fieldName:`destinations.${s}.purchasing_group_id`,isRequired:!0,disabled:!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:t=>{n(s,{...i,purchasing_group_id:t})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(w,{control:l.control,name:`destinations.${s}.business_trip_start_date`,render:({field:t})=>e.jsxs(g,{children:[e.jsx(A,{children:e.jsx(y,{initialDate:i.business_trip_start_date,onDateChange:a=>{T(a,s)},disabled:!1,disabledDays:j})}),e.jsx(F,{})]})}),e.jsx("span",{children:"To"}),e.jsx(w,{control:l.control,name:`destinations.${s}.business_trip_end_date`,render:({field:t})=>e.jsxs(g,{children:[e.jsx(A,{children:e.jsx(y,{initialDate:i.business_trip_end_date,onDateChange:a=>{E(a,s)},disabled:!1,disabledDays:j})}),e.jsx(F,{})]})}),e.jsx(L,{type:"button",onClick:()=>G(),children:"Get Detail"})]})]})]}),e.jsx(H,{detailAttedanceFields:S,form:l,updateAttedanceFields:$,destinationIndex:s,type:u,btClone:h}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(M,{allowanceField:f,destinationIndex:s,form:l,type:u,btClone:h})]},s),e.jsx(U,{allowanceField:f,destinationIndex:s,form:l,setTotalAllowance:C})]})}export{qe as BussinessDestinationForm};
