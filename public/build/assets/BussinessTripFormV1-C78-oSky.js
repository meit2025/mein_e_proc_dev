import{r as g,j as e}from"./app-CNv1wH9b.js";import{F as B,a as h,b as j,d as p,e as m}from"./form-Zal1Ebfd.js";import{z as s,t as L,I as _}from"./index-DIDMXgCk.js";import{B as V}from"./button-pR9Y3bbt.js";import{u as O,b as w}from"./index.esm-CIV15JQO.js";import{T as P}from"./textarea-CTIheEZM.js";/* empty css              */import{S as G}from"./scroll-area-B_5qWdwW.js";import{S as H}from"./separator-Buw4W9o6.js";import{T as I,a as z,b as U,c as J}from"./tabs-2_Ktptw_.js";import{h as u,C as W}from"./moment-DHdWAAgq.js";import{S,a as $,b as M,c as F,d as Y}from"./select-b8gemuwG.js";import{C as E}from"./CustomDatePicker-BmA8CTRj.js";import"./axiosInstance-B1I-V4H3.js";/* empty css            */import"./index-CSig4B4g.js";import"./index-D0bqUqHg.js";import"./index-C-VBh36K.js";import"./Combination-CGvGELnX.js";import"./react-icons.esm-kJ1vbc__.js";import"./createLucideIcon-SK_CF5kc.js";import"./index-DkGOhDxu.js";import"./index-Cv7lGjtw.js";s.object({remark:s.string().min(1).max(50),reimburse_cost:s.number()});const T=25e3,Ye=({users:i,listPurposeType:t,listBusinessTrip:n})=>{const d=s.object({purpose_type_id:s.string().min(1,"Purpose type required"),request_no:s.string().min(1," required"),remark:s.string().optional(),total_destination:s.number().min(1,"Total Destinantion Required"),destinations:s.array(s.object({destination:s.string().optional(),business_trip_start_date:s.date().optional(),business_trip_end_date:s.date().optional(),detail_attedances:s.array(s.object({date:s.date().optional(),shift_code:s.string().optional(),shift_end:s.string().optional(),start_time:s.string().optional(),end_time:s.string().optional()})),allowances:s.array(s.object({name:s.string().optional(),code:s.string().optional(),default_price:s.number().optional(),type:s.string().optional(),subtotal:s.number().optional(),currency:s.string().optional(),detail:s.array(s.object({date:s.date().optional(),request_price:s.any().optional()}))}))}))}),[c,o]=g.useState("1"),l=O({resolver:L(d),defaultValues:{purpose_type_id:"",request_no:"",remark:"",total_destination:1,destinations:[{detail_attedances:[],allowances:[],destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date}]}}),[a,y]=g.useState([]),b=r=>{o(r),A()},v=r=>{console.log("values bg",r)};function A(){let r=[],x=parseInt(c);for(let f=0;f<x;f++)r.push({destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date,allowances:[],detail_attedances:[]});console.log(r),l.setValue("destinations",r)}const{fields:C,append:q,remove:k,update:N}=w({control:l.control,name:"destinations"});return g.useEffect(()=>{A()},[c,a]),e.jsx(G,{className:"h-[600px] w-full ",children:e.jsx(B,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(v),children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Declaration No."}),e.jsx("td",{children:"Test-12321"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request No."}),e.jsxs("td",{children:[" ",e.jsx(h,{control:l.control,name:"request_no",render:({field:r})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(S,{onValueChange:x=>r.onChange(x),value:r.value,children:[e.jsx($,{className:"w-[200px] py-2",children:e.jsx(M,{placeholder:"-- Select One --"})}),e.jsx(F,{children:n.map(x=>e.jsx(Y,{value:x.id.toString(),children:x.request_no}))})]})}),e.jsx(m,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(h,{control:l.control,name:"remark",render:({field:r})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(P,{placeholder:"Insert remark",...r,rows:4,className:"w-[300px]"})}),e.jsx(m,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Attachment"}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Extension"}),e.jsx("td",{className:"text-gray-500 text-xs font-extralight",children:"doc,jpg,ods,png,txt,pdf"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Total Destination"}),e.jsxs("td",{children:[" ",e.jsx(h,{control:l.control,name:"total_destination",render:({field:r})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(S,{value:c,onValueChange:b,children:[e.jsx($,{className:"w-[200px] py-2",children:e.jsx(M,{placeholder:"-- Select Bussiness Trip --"})}),e.jsx(F,{children:Array.from({length:5},(x,f)=>e.jsxs(Y,{value:(f+1).toString(),children:[" ",f+1," "]}))})]})}),e.jsx(m,{})]})})]})]})]}),e.jsx(H,{className:"my-4"}),e.jsx(K,{updateDestination:N,destinationField:C,form:l,listAllowances:a,totalDestination:l.getValues("total_destination").toString()}),e.jsx(V,{type:"submit",children:"submit"})]})})})};function K({totalDestination:i,listAllowances:t,destinationField:n,form:d,updateDestination:c}){return g.useState(),g.useState(),g.useState(0),e.jsxs(I,{defaultValue:"destination1",className:"w-full",children:[e.jsx(z,{className:"flex items-center justify-start space-x-4",children:n.map((o,l)=>e.jsxs(U,{value:`destination${l+1}`,children:["Destination ",l+1]}))}),n.map((o,l)=>e.jsx(Q,{listAllowances:t,updateDestination:c,destination:o,form:d,index:l}))]})}function Q({form:i,index:t,destination:n,updateDestination:d,listAllowances:c}){const{fields:o,update:l,append:a,remove:y}=w({control:i.control,name:`destinations.${t}.detail_attedances`}),{fields:b,update:v,append:A,remove:C,replace:q}=w({control:i.control,name:`destinations.${t}.allowances`});function k(){let r=u(n.business_trip_start_date),x=u(n.business_trip_end_date);y(),C(),console.log(r.format("DD/MM/YYYY")),console.log(x.format("DD/MM/YYYY"));let f=[];for(;r.format("DD/MM/YYYY")<=x.format("DD/MM/YYYY");){const D={date:r.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};f.push({date:r.toDate(),request_price:0}),r=r.add(1,"days"),a(D)}let R=c.map(D=>({name:D.name,code:D.code,default_price:T,type:D.type,subtotal:T,currency:D.currency_id,detail:D.type=="TOTAL"?[{date:void 0,request_price:T}]:f}));q(R)}function N(r){d(t,{...n,business_trip_end_date:r})}return e.jsx(J,{value:`destination${t+1}`,children:e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",n.destination]}),e.jsx("td",{children:e.jsx(h,{control:i.control,name:`destinations.${t}.destination`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(S,{onValueChange:x=>{d(t,{...n,destination:x})},defaultValue:n.destination,children:[e.jsx($,{className:"w-[200px]",children:e.jsx(M,{placeholder:"Destination"})}),e.jsxs(F,{children:[e.jsx(Y,{value:"jakarta",children:"Jakarta"}),e.jsx(Y,{value:"banyuwangi",children:"Banyuwangi"})]})]})}),e.jsx(m,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",u(n.business_trip_start_date).format("DD-MM-YYYY"),u(n.business_trip_end_date).format("DD-MM-YYYY")]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(h,{control:i.control,name:`destinations.${t}.business_trip_start_date`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(E,{initialDate:n.business_trip_start_date,onDateChange:x=>{d(t,{...n,business_trip_start_date:x})}})}),e.jsx(m,{})]})}),e.jsx("span",{children:"To"}),e.jsx(h,{control:i.control,name:`destinations.${t}.business_trip_end_date`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(E,{initialDate:n.business_trip_end_date,onDateChange:x=>{N(x)}})}),e.jsx(m,{})]})}),e.jsx(V,{type:"button",onClick:()=>k(),children:"Get Detail"})]})]})]}),e.jsx(X,{detailAttedanceFields:o,form:i,updateAttedanceFields:l,destinationIndex:t}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(Z,{allowanceField:b,destinationIndex:t,form:i})]})})}function X({form:i,destinationIndex:t,detailAttedanceFields:n,updateAttedanceFields:d}){const c=i.watch(`destinations.${t}.detail_attedances`);return g.useEffect(()=>{},[c]),g.useEffect(()=>{console.log(n)},[n]),e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsx("div",{className:"mb-4 text-sm",children:"Detail Attedance: "})})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("table",{className:"detail-attedance text-xs",children:[e.jsxs("thead",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Shift code"}),e.jsx("th",{children:"Shift Start"}),e.jsx("th",{children:"Shift End"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"})]}),e.jsx("tbody",{children:n.map((o,l)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[u(o.date).format("DD/MM/YYYY"),e.jsx(h,{control:i.control,name:`destinations.${t}.detail_attedances.${l}.date`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{defaultValue:u(a.value).format("YYYY-MM-DD"),onChange:a.onChange,type:"hidden"})}),e.jsx(m,{})]})})]}),e.jsxs("td",{children:[o.shift_code,e.jsx(h,{control:i.control,name:`destinations.${t}.detail_attedances.${l}.shift_code`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{defaultValue:u(a.value).format("YYYY-MM-DD"),onChange:a.onChange,type:"hidden"})}),e.jsx(m,{})]})})]}),e.jsxs("td",{children:[o.shift_start,e.jsx(h,{control:i.control,name:`destinations.${t}.detail_attedances.${l}.shift_start`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{defaultValue:u(a.value).format("YYYY-MM-DD"),onChange:a.onChange,type:"hidden"})}),e.jsx(m,{})]})})]}),e.jsxs("td",{children:[o.shift_end,e.jsx(h,{control:i.control,name:`destinations.${t}.detail_attedances.${l}.shift_end`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{defaultValue:u(a.value).format("YYYY-MM-DD"),onChange:a.onChange,type:"hidden"})}),e.jsx(m,{})]})})]}),e.jsx("td",{children:e.jsx(h,{control:i.control,name:`destinations.${t}.detail_attedances.${l}.start_time`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{defaultValue:a.value,onChange:a.onChange})}),e.jsx(m,{})]})})}),e.jsx("td",{children:e.jsx(h,{control:i.control,name:`destinations.${t}.detail_attedances.${l}.end_time`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{defaultValue:a.value,onChange:a.onChange})}),e.jsx(m,{})]})})})]},o.index))})]})})})]})}function Z({form:i,destinationIndex:t,allowanceField:n,allowanceIndex:d}){return console.log("allowance field",n),console.log("allowance index",d),e.jsx("table",{className:"w-full allowance-table",children:n.map((c,o)=>e.jsx(ee,{form:i,allowance:c,index:o,destinationIndex:t,allowanceIndex:d}))})}function ee({form:i,allowance:t,index:n,destinationIndex:d,allowanceIndex:c}){const[o,l]=g.useState(!1),a=y=>{l(b=>!b)};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:260,style:{verticalAlign:"middle"},className:"text-sm",children:t.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="TOTAL"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="TOTAL"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{form:i,allowanceIndex:n,type:t.type,destinationIndex:d}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",t.detail.length," Days * 0 * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-sm",style:{padding:"2px 5px"},children:"= IDR 150000"})})}),t.type=="TOTAL"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>a(),children:e.jsxs(V,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},t.id),o&&e.jsx(e.Fragment,{children:t.detail.map((y,b)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-end",style:{verticalAlign:"middle"},children:e.jsx("span",{className:"text-sm",children:"10/10/2024"})}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(h,{control:i.control,name:`destinations.${d}.allowances.${c}.detail.${b}.request_price`,render:({field:v})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{value:v.value,onChange:v.onChange})}),e.jsx(m,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},y.id))})]})}function te({form:i,type:t,allowanceIndex:n,destinationIndex:d}){const{fields:c}=w({control:i.control,name:`destinations.${d}.allowances.${n}.detail`});return console.log(c," allowance input nih"),console.log(d,n),e.jsx(e.Fragment,{children:c.map((o,l)=>t=="TOTAL"?e.jsx(h,{control:i.control,name:`destinations.${d}.allowances.${n}.detail.${l}.request_price`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{value:a.value,onChange:a.onChange})}),e.jsx(m,{})]})}):e.jsxs("div",{children:[e.jsxs("span",{className:"mr-4",children:[u(o.date).format("DD/MM/YYYY"),":"]}),e.jsx(h,{control:i.control,name:`destinations.${d}.allowances.${n}.detail.${l}.request_price`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(_,{type:"",defaultValue:25e3,onChange:a.onChange})}),e.jsx(m,{})]})})]}))})}export{te as AllowanceInputForm,ee as AllowanceRowInput,K as BussinesTripDestination,Q as BussinessDestinationForm,Ye as BussinessTripFormV1,Z as DetailAllowance,X as DetailAttedances};
