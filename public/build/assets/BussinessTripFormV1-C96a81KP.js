import{j as e,r as D,b as re}from"./app-CHqHR3rt.js";import{F as le,a as j,b as m,c as _,d as g,e as ie}from"./form-aBRhSH0C.js";import{z as o,t as oe}from"./index-Cnza9c68.js";import{d as ce}from"./index-CvrrVNsH.js";import{B as H}from"./button-DxJ3h_Kc.js";import{a as de,C as pe,u as xe,b as X,c as G}from"./index.esm-DKZBJb2f.js";import{T as he}from"./textarea-C4hiO_1P.js";/* empty css              */import{S as ue}from"./scroll-area-3I4pWDLj.js";import{S as je}from"./separator-DYM-ozuN.js";import{T as me,a as _e,b as ge,c as fe}from"./tabs-D7FCnP7y.js";import{h as S}from"./moment-C5S46NFB.js";import{S as V,a as q,b as E,c as k,d as A}from"./select-DTMeD_cu.js";import{C as J}from"./CustomDatePicker-DULZuBDu.js";import{I as Y}from"./input-NYAmqhv-.js";import{G as be}from"./api-BEQetkWJ.js";import{a as we}from"./axiosInstance-EUpOR8yR.js";import{BusinessTripType as K}from"./models-nkwaxrfb.js";import{C as ye,G as ve}from"./api-kPGf3tEJ.js";import{S as De}from"./Switch-Bclfjedy.js";import{F as Ce}from"./FormHelperText-D30AOrov.js";import{C as Se}from"./chevrons-up-down-C9MZERl8.js";import"./app-HlhieNAw.js";import"./utils-CFc7qyF9.js";import"./index-CPwlOFcP.js";import"./index-DsA8yvK6.js";import"./index-CGO3ZbOX.js";import"./index-Vrbad9ql.js";import"./index-CRL0OvPM.js";import"./index-Xv1Rbf_f.js";import"./Combination-DNM4ssDG.js";import"./index-DJLJo_HP.js";import"./popover-B4tosTAh.js";import"./createLucideIcon-ZWUX4xP4.js";import"./createSimplePaletteValueFilter-VXDozjod.js";import"./SwitchBase-BAYTIv5o.js";const Ne=({fieldLabel:l,fieldName:a,isRequired:i=!1,disabled:h=!1,style:f,requiredMessage:u,classNames:x,defaultChecked:n=!1,note:c,onChanges:w})=>{var b;const{control:C,formState:{errors:d}}=de();return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[l&&e.jsxs("label",{className:"form-label max-w-32",children:[l," ",e.jsxs("span",{className:"text-red-700",children:[" ",i?"*":""]})]}),e.jsx(pe,{name:a,control:C,rules:{required:i?u??`${l} is required`:!1},render:({field:r})=>e.jsx("div",{style:f,className:x,children:e.jsx(De,{...r,checked:!!(r.value??n),onChange:$=>{r.onChange($),w&&w($)},disabled:h})})}),e.jsx("span",{children:c})]}),e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label max-w-32",children:""}),d[a]&&e.jsx(Ce,{error:!0,children:String((b=d[a])==null?void 0:b.message)})]})]})};o.object({remark:o.string().min(1).max(50),reimburse_cost:o.number()});const ft=({users:l,listPurposeType:a,pajak:i,costcenter:h,purchasingGroup:f,type:u,id:x,role:n,idUser:c,listDestination:w=[]})=>{const C=o.object({purpose_type_id:o.string().min(1,"Purpose type required"),request_for:o.string().min(1,"Request for required"),cost_center_id:o.string().min(1,"Cost Center for required"),pajak_id:o.string().min(1,"Pajak for required"),purchasing_group_id:o.string().min(1,"Purchasing Group for required"),remark:o.string().min(1,"Remark is required"),attachment:o.instanceof(File).nullable().optional(),total_destination:o.number().min(1,"Total Destinantion Required"),cash_advance:o.boolean().nullable().optional(),total_percent:o.string().nullable().optional(),total_cash_advance:o.string().nullable().optional(),destinations:o.array(o.object({destination:o.string().min(1,"Destinantion Required"),business_trip_start_date:o.date().optional(),business_trip_end_date:o.date().optional(),detail_attedances:o.array(o.object({date:o.date().optional(),shift_code:o.string().optional(),shift_start:o.string().optional(),shift_end:o.string().optional(),start_time:o.string().optional(),end_time:o.string().optional()})),allowances:o.array(o.object({name:o.string().optional(),code:o.string().optional(),default_price:o.number().optional(),type:o.string().optional(),subtotal:o.number().optional(),currency:o.string().optional(),detail:o.array(o.object({date:o.date().nullish(),request_price:o.any().optional()}))}))}))}),[d,b]=D.useState("1");console.log("list destiantion",w);const r=xe({resolver:oe(C),defaultValues:{purpose_type_id:"",request_for:"",cost_center_id:"",pajak_id:"",purchasing_group_id:"",remark:"",attachment:null,total_destination:1,cash_advance:!1,total_percent:"0",total_cash_advance:"0",destinations:[{detail_attedances:[],allowances:[],destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date}]}});async function $(){const s=ve(x);try{const p=(await re.get(s)).data.data;console.log(p," Response Detailxxxx"),console.log(p.destinations," Data Response Detailxxxx"),r.setValue("purpose_type_id",p.purpose_type_id),r.setValue("request_for",p.request_for.id),r.setValue("cost_center_id",p.cost_center_id),r.setValue("pajak_id",p.pajak_id),r.setValue("purchasing_group_id",p.purchasing_group_id),r.setValue("remark",p.remarks),r.setValue("total_destination",p.total_destination),console.log(r.getValues("destinations"),"Form Destinations"),r.setValue("destinations",[]),r.setValue("destinations",p.destinations.map(N=>({destination:N.destination,business_trip_start_date:new Date(N.business_trip_start_date),business_trip_end_date:new Date(N.business_trip_end_date),detail_attedances:N.detail_attedances,allowances:N.allowances})))}catch{}}const[R,I]=D.useState([]),[T,y]=D.useState(n==="user"?c.toString():"");async function P(s){r.setValue("purpose_type_id",s||"");const t=n=="user"?c||"":T||"",p=be(s,t);try{const N=await we.get(p);I(N.data.data)}catch{}}const L=s=>{r.setValue("total_destination",parseInt(s,10)),b(s),F()},v=async s=>{try{const t=new FormData;t.append("purpose_type_id",s.purpose_type_id??""),t.append("request_for",s.request_for??""),t.append("cost_center_id",s.cost_center_id??""),t.append("pajak_id",s.pajak_id??""),t.append("purchasing_group_id",s.purchasing_group_id??""),t.append("remark",s.remark??""),t.append("attachment",s.attachment??""),t.append("total_destination",`${s.total_destination}`),t.append("cash_advance",`${s.cash_advance}`),t.append("total_percent",`${s.total_percent}`),t.append("total_cash_advance",`${s.total_cash_advance}`),s.destinations.forEach((p,N)=>{const ne={...p,business_trip_start_date:S(p.business_trip_start_date).format("YYYY-MM-DD"),business_trip_end_date:S(p.business_trip_end_date).format("YYYY-MM-DD"),detail_attedances:p.detail_attedances.map(M=>({...M,date:S(M.date).format("YYYY-MM-DD")})),allowances:p.allowances.map(M=>({...M,detail:M.detail.map(B=>({...B,date:(B==null?void 0:B.date)!=null?S(B.date).format("YYYY-MM-DD"):null}))}))};t.append(`destinations[${N}]`,JSON.stringify(ne))}),console.log(t," test"),await ce.Inertia.post(ye,t,{headers:{"Content-Type":"multipart/form-data"}}),Ee("succesfully created data","success")}catch{}};function F(){const s=[],t=parseInt(d);for(let p=0;p<t;p++)s.push({destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date,allowances:[],detail_attedances:[]});r.setValue("destinations",s)}const{fields:O,append:z,remove:ke,update:Q}=X({control:r.control,name:"destinations"});D.useEffect(()=>{x&&u==K.edit&&$()},[]),D.useEffect(()=>{u==K.create&&F()},[d,R,x,u,n,c]);const[Z,ee]=D.useState(!1),te=s=>{ee(s)},U=G({control:r.control,name:"total_percent"}),[se,ae]=D.useState(0),W=se;return D.useEffect(()=>{const t=parseFloat((U||"0").toString())/100*W;r.setValue("total_cash_advance",t.toFixed(0))},[U,W]),e.jsx(ue,{className:"h-[600px] w-full ",children:e.jsx(le,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(v),children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request No."}),e.jsx("td",{children:"ODR-YYYY-MM-XXXXXXXX"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request For"}),e.jsx("td",{children:e.jsx(j,{control:r.control,name:"request_for",render:({field:s})=>(n==="user"&&!s.value&&s.onChange(c.toString()),e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{onValueChange:t=>{y(t),s.onChange(t)},value:s.value,disabled:n==="user",children:[e.jsx(q,{className:"w-[200px] py-2",children:e.jsx(E,{placeholder:"-- Select Business Purpose Type --"})}),e.jsx(k,{children:n==="admin"?l.map(t=>e.jsx(A,{value:t.id.toString(),children:t.name},t.id)):l.filter(t=>t.id===c).map(t=>e.jsx(A,{value:t.id.toString(),children:t.name},t.id))})]})}),e.jsx(g,{})]}))})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussiness Trip Purpose Type"}),e.jsxs("td",{children:[" ",e.jsx(j,{control:r.control,name:"purpose_type_id",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{onValueChange:t=>P(t),value:s.value,children:[e.jsx(q,{className:"w-[200px]",children:e.jsx(E,{placeholder:"-- Select Bussiness Purpose Type --"})}),e.jsx(k,{children:a.map(t=>e.jsx(A,{value:t.id.toString(),children:t.name}))})]})}),e.jsx(g,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Cost Center"}),e.jsxs("td",{children:[" ",e.jsx(j,{control:r.control,name:"cost_center_id",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(q,{className:"w-[200px]",children:e.jsx(E,{placeholder:"-- Select Cost Center --"})}),e.jsx(k,{children:h.map(t=>e.jsx(A,{value:t.id.toString(),children:t.cost_center}))})]})}),e.jsx(g,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsxs("td",{children:[" ",e.jsx(j,{control:r.control,name:"pajak_id",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(q,{className:"w-[200px]",children:e.jsx(E,{placeholder:"-- Select Pajak --"})}),e.jsx(k,{children:i.map(t=>e.jsx(A,{value:t.id.toString(),children:t.mwszkz}))})]})}),e.jsx(g,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsxs("td",{children:[" ",e.jsx(j,{control:r.control,name:"purchasing_group_id",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{onValueChange:t=>s.onChange(t),value:s.value,children:[e.jsx(q,{className:"w-[200px]",children:e.jsx(E,{placeholder:"-- Select Purchasing Group --"})}),e.jsx(k,{children:f.map(t=>e.jsx(A,{value:t.id.toString(),children:t.purchasing_group}))})]})}),e.jsx(g,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(j,{control:r.control,name:"remark",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(he,{placeholder:"Insert remark",...s,rows:4,className:"w-[300px]"})}),e.jsx(g,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Attachment"}),e.jsx("td",{children:e.jsx(j,{control:r.control,name:"attachment",render:({field:s})=>e.jsxs(m,{children:[e.jsx(ie,{className:"text-xs text-gray-500 font-extralight mb-1",children:"Max File: 1000KB"}),e.jsx(_,{children:e.jsx("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-xs shadow-sm transition-colors file:border-0 file:bg-transparent file:text-xs file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",type:"file",onChange:t=>{var N;const p=(N=t.target.files)==null?void 0:N[0];p?s.onChange(p):s.onChange(null)}})}),e.jsx(g,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Extension"}),e.jsx("td",{className:"text-gray-500 text-xs font-extralight",children:"doc,jpg,ods,png,txt,pdf"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Total Destination"}),e.jsxs("td",{children:[" ",e.jsx(j,{control:r.control,name:"total_destination",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{value:s.value.toString(),onValueChange:L,children:[e.jsx(q,{className:"w-[200px] py-2",children:e.jsx(E,{placeholder:"-- Select Bussiness Trip --"})}),e.jsx(k,{children:Array.from({length:5},(t,p)=>e.jsxs(A,{value:(p+1).toString(),children:[" ",p+1," "]}))})]})}),e.jsx(g,{})]})})]})]})]}),e.jsx(je,{className:"my-4"}),e.jsx(Te,{updateDestination:Q,destinationField:O,listDestination:w,form:r,listAllowances:R,totalDestination:r.getValues("total_destination").toString(),setTotalAllowance:ae}),e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Cash Advance"}),e.jsx("td",{className:"w-[50%] pb-0",children:e.jsx(Ne,{fieldName:"cash_advance",isRequired:!1,disabled:!1,onChanges:s=>te(s.target.checked)})})]}),Z&&e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Total Percent"}),e.jsxs("td",{className:"w-[50%]",children:[e.jsx(j,{control:r.control,name:"total_percent",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{value:s.value||void 0,onValueChange:t=>s.onChange(t),children:[e.jsx(q,{className:"w-[50%] mb-2",children:e.jsx(E,{placeholder:"-- Select Option --"})}),e.jsxs(k,{children:[e.jsx(A,{value:"10",children:"10"}),e.jsx(A,{value:"25",children:"25"}),e.jsx(A,{value:"50",children:"50"})]})]})}),e.jsx(g,{})]})}),e.jsx(j,{control:r.control,name:"total_cash_advance",render:({field:s})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{value:s.value||"",readOnly:!0,className:"w-[50%]"})}),e.jsx(g,{})]})})]})]})})]}),e.jsx(H,{type:"submit",children:"submit"})]})})})};function Te({totalDestination:l,listAllowances:a,destinationField:i,form:h,updateDestination:f,setTotalAllowance:u,listDestination:x=[]}){return D.useState(),D.useState(),D.useState(0),e.jsxs(me,{defaultValue:"destination1",className:"w-full",children:[e.jsx(_e,{className:"flex items-center justify-start space-x-4",children:i.map((n,c)=>e.jsxs(ge,{value:`destination${c+1}`,children:["Destination ",c+1]}))}),i.map((n,c)=>e.jsx(Ae,{listAllowances:a,updateDestination:f,destination:n,form:h,index:c,setTotalAllowance:u,listDestination:x}))]})}function Ae({form:l,index:a,destination:i,updateDestination:h,listAllowances:f,setTotalAllowance:u,listDestination:x}){const{fields:n,update:c,append:w,remove:C}=X({control:l.control,name:`destinations.${a}.detail_attedances`}),{fields:d,update:b,append:r,remove:$,replace:R}=X({control:l.control,name:`destinations.${a}.allowances`});function I(){let T=S(i.business_trip_start_date).startOf("day");const y=S(i.business_trip_end_date).startOf("day");for(C(),$();T.isBefore(y)||T.isSame(y);){const v={date:T.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};w(v),T=T.add(1,"days")}function P(v){let F=S(i.business_trip_start_date).startOf("day");const O=S(i.business_trip_end_date).startOf("day"),z=[];for(;F.isBefore(O)||F.isSame(O);)z.push({date:F.toDate(),request_price:v}),F=F.add(1,"days");return z}const L=f.map(v=>({name:v.name,code:v.code,default_price:parseInt(v.grade_price),type:v.type,subtotal:parseInt(v.grade_price),currency:v.currency_id,request_value:v.request_value,detail:v.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(v.grade_price)}]:P(v.grade_price)}));R(L)}return e.jsxs(fe,{value:`destination${a+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",i.destination]}),e.jsx("td",{children:e.jsx(j,{control:l.control,name:`destinations.${a}.destination`,render:({field:T})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsxs(V,{onValueChange:y=>{h(a,{...i,destination:y})},defaultValue:i.destination,children:[e.jsx(q,{className:"w-[200px]",children:e.jsx(E,{placeholder:"Destination"})}),e.jsx(k,{children:x.map(y=>e.jsx(A,{value:y.destination,className:"uppercase",children:y.destination}))})]})}),e.jsx(g,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(j,{control:l.control,name:`destinations.${a}.business_trip_start_date`,render:({field:T})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(J,{initialDate:i.business_trip_start_date,onDateChange:y=>{h(a,{...i,business_trip_start_date:y})}})}),e.jsx(g,{})]})}),e.jsx("span",{children:"To"}),e.jsx(j,{control:l.control,name:`destinations.${a}.business_trip_end_date`,render:({field:T})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(J,{initialDate:i.business_trip_end_date,onDateChange:y=>{console.log("end date",y),h(a,{...i,business_trip_end_date:y})}})}),e.jsx(g,{})]})}),e.jsx(H,{type:"button",onClick:()=>I(),children:"Get Detail"})]})]})]}),e.jsx(Fe,{detailAttedanceFields:n,form:l,updateAttedanceFields:c,destinationIndex:a}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(Ve,{allowanceField:d,destinationIndex:a,form:l})]},a),e.jsx($e,{allowanceField:d,destinationIndex:a,form:l,setTotalAllowance:u})]})}function $e({allowanceField:l,destinationIndex:a,form:i,setTotalAllowance:h}){const[f,u]=D.useState(0);D.useEffect(()=>{const n=l.reduce((C,d,b)=>{const r=i.getValues(`destinations.${a}.allowances.${b}.detail`),$=x(d,r);return C+$},0),w=i.getValues("destinations").reduce((C,d,b)=>{const $=(d.allowances||[]).reduce((R,I,T)=>{const y=i.getValues(`destinations.${b}.allowances.${T}.detail`),P=x(I,y);return R+P},0);return C+$},0);u(n),h(w)},[l,i.watch()]);const x=(n,c)=>{var w;return n.type==="total"?parseFloat(((w=c==null?void 0:c[0])==null?void 0:w.request_price)||0):c==null?void 0:c.reduce((C,d)=>C+parseFloat(d.request_price||0),0)};return e.jsx(e.Fragment,{children:e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-[50%]",children:"Item"}),e.jsx("th",{className:"w-[50%]",children:"Sub Total"})]})}),e.jsx("tbody",{children:l.map((n,c)=>e.jsx(Ye,{allowance:n,destinationIndex:a,form:i,allowanceIndex:c}))}),e.jsx("tfoot",{className:"mt-4",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{children:e.jsx("i",{children:"Total Allowance"})}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:e.jsx("i",{children:"IDR"})}),e.jsx("span",{children:e.jsx("i",{children:f})})]})]})})]})})}function Ye({allowance:l,destinationIndex:a,form:i,allowanceIndex:h}){const f=G({control:i.control,name:`destinations.${a}.allowances.${h}.detail.0.request_price`}),u=G({control:i.control,name:`destinations.${a}.allowances.${h}.detail`}),x=()=>{if(l.type==="total")return parseFloat(f||0)*1;{let n=0;return u==null||u.forEach(c=>{const w=parseFloat(c.request_price||0);n+=w}),n}};return e.jsxs("tr",{children:[e.jsx("td",{children:l.name}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:"IDR"}),e.jsx("span",{children:x()})]})]},l.id)}function Fe({form:l,destinationIndex:a,detailAttedanceFields:i,updateAttedanceFields:h}){const f=l.watch(`destinations.${a}.detail_attedances`);return D.useEffect(()=>{},[f]),D.useEffect(()=>{},[i]),e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsx("div",{className:"mb-4 text-sm",children:"Detail Attedance: "})})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("table",{className:"detail-attedance text-xs",children:[e.jsxs("thead",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Shift code"}),e.jsx("th",{children:"Shift Start"}),e.jsx("th",{children:"Shift End"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"})]}),e.jsx("tbody",{children:i.map((u,x)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[S(u.date).format("DD/MM/YYYY"),e.jsx(j,{control:l.control,name:`destinations.${a}.detail_attedances.${x}.date`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(g,{})]})})]}),e.jsxs("td",{children:[u.shift_code,e.jsx(j,{control:l.control,name:`destinations.${a}.detail_attedances.${x}.shift_code`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(g,{})]})})]}),e.jsxs("td",{children:[u.shift_start,e.jsx(j,{control:l.control,name:`destinations.${a}.detail_attedances.${x}.shift_start`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(g,{})]})})]}),e.jsxs("td",{children:[u.shift_end,e.jsx(j,{control:l.control,name:`destinations.${a}.detail_attedances.${x}.shift_end`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{defaultValue:S(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(g,{})]})})]}),e.jsx("td",{children:e.jsx(j,{control:l.control,name:`destinations.${a}.detail_attedances.${x}.start_time`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(g,{})]})})}),e.jsx("td",{children:e.jsx(j,{control:l.control,name:`destinations.${a}.detail_attedances.${x}.end_time`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(g,{})]})})})]},u.index))})]})})})]})}function Ve({form:l,destinationIndex:a,allowanceField:i}){return e.jsx("table",{className:"w-full allowance-table",children:i.map((h,f)=>e.jsx(qe,{form:l,allowance:h,destinationIndex:a,allowanceIndex:f}))})}function qe({form:l,allowance:a,destinationIndex:i,allowanceIndex:h}){const[f,u]=D.useState(!1),x=d=>{u(b=>!b)},n=G({control:l.control,name:`destinations.${i}.allowances.${h}.detail.0.request_price`}),c=G({control:l.control,name:`destinations.${i}.allowances.${h}.detail`}),w=()=>{if(a.type==="total")return parseFloat(n||0)*1;{let d=0;return c==null||c.forEach(b=>{const r=parseFloat(b.request_price||0);d+=r}),d}},C=d=>b=>{const r=parseFloat(b.target.value)||0;a.request_value==="unlimited"?d.onChange(b):a.request_value==="up to max value"?r<=a.subtotal?d.onChange(b):alert(`Value cannot exceed the subtotal of IDR ${a.subtotal}`):a.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:a.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:a.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:a.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{control:l.control,name:`destinations.${i}.allowances.${h}.detail.0.request_price`,render:({field:d})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{value:d.value,onChange:C(d)})}),e.jsx(g,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",a.detail.length," Days * ",a.subtotal," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",w()]})})}),a.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>x(),children:e.jsxs(H,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},a.id),f&&e.jsx(e.Fragment,{children:a.detail.map((d,b)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:S(d.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(j,{control:l.control,name:`destinations.${i}.allowances.${h}.detail.${b}.request_price`,render:({field:r})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{value:r.value,onChange:C(r)})}),e.jsx(g,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},d.id))})]})}function bt({form:l,type:a,allowanceIndex:i,destinationIndex:h}){const{fields:f}=X({control:l.control,name:`destinations.${h}.allowances.${i}.detail`});return e.jsx(e.Fragment,{children:f.map((u,x)=>e.jsx(j,{control:l.control,name:`destinations.${h}.allowances.${x}.detail.${x}.request_price`,render:({field:n})=>e.jsxs(m,{children:[e.jsx(_,{children:e.jsx(Y,{value:n.value,onChange:n.onChange})}),e.jsx(g,{})]})}))})}function Ee(l,a){throw new Error("Function not implemented.")}export{bt as AllowanceInputForm,qe as AllowanceRowInput,Te as BussinesTripDestination,Ae as BussinessDestinationForm,ft as BussinessTripFormV1,Ve as DetailAllowance,Fe as DetailAttedances,Ye as ResultPerItem,$e as ResultTotalItem};
