import{j as e,r,u as ye,q as ke,a as C,b as E}from"./app-Quslzo8E.js";import{a as z}from"./axiosInstance-BCVKf1Qx.js";import{D as Ce,b as Ne,c as Se}from"./dialog-Yy7k_rsn.js";import{B}from"./button-C_X5wg-I.js";import{L as be}from"./LoadingSpin-Dlnq6t_B.js";import{D as $e,a as Me,b as Fe,c as Ue,d as A,e as X}from"./dropdown-menu-o8gLGHYp.js";import{D as De}from"./index-DA-pli0p.js";import{c as Y}from"./createLucideIcon-F83Ii-lr.js";import{B as U}from"./Box-D761tN_x.js";import{T as ze,a as J}from"./Tabs-DMhMSguU.js";import{B as K}from"./Button-J75ZqqqO.js";import{D as Ae}from"./DataGrid-C1t9U2AS.js";const Be=({open:j,onOpenChange:T,onDelete:N,onClose:u,children:t,className:$,isLoading:d,title:x,description:l})=>e.jsx(Ce,{open:j,onOpenChange:u,children:e.jsxs(Ne,{className:$||"md:max-w-[768px]",children:[l||"Are you sure delete this item?",e.jsxs(Se,{children:[u?e.jsx(B,{variant:"outline",onClick:u,children:"Close"}):null,N?e.jsx(e.Fragment,{children:d?e.jsx(be,{}):e.jsx(B,{type:"submit",onClick:N,children:"Delete"})}):null]})]})});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=Y("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=Y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Q=j=>({id:`simple-tab-${j}`,"aria-controls":`simple-tabpanel-${j}`}),Ke=({columns:j,buttonCustome:T,onExport:N,onExportXls:u,url:t,labelFilter:$="Search",onEdit:d,onDelete:x,onDetail:l,onCreate:D,onClone:M,defaultSearch:L,actionType:Z,buttonActionCustome:I,deleteConfirmationText:ee,titleConfirmationText:Ie,isHistory:se=!1,role:s})=>{var H,V,W;const[ae,te]=r.useState([]),[ie,_]=r.useState(!1),[c,ne]=r.useState({page:0,pageSize:10}),[w,re]=r.useState([]),[v,le]=r.useState({items:[]}),[P,F]=r.useState(null),[ce,h]=r.useState(!1),[g,de]=r.useState(0),[oe,xe]=r.useState(0),[y,he]=r.useState(""),[R,pe]=r.useState(""),{showToast:k}=ye(),{props:O}=ke(),p=((H=O.auth)==null?void 0:H.permission)||[],S=r.useCallback(async(a,i,f,o,n,b)=>{_(!0);const ue=o.length>0?o[0].field:"id",we=o.length>0?o[0].sort:"desc",ve=n.items.map(m=>`${m.field}=${m.operator},${m.value}`).join("&");try{const m=`${L||"?"}page=${a+1}&per_page=${i}&search=${f}&sort_by=${ue}&sort_direction=${we}&approval=${b}&${ve}`;pe(m);const G=await z.get(`${t.url}${m}`);te(G.data.data.data),xe(G.data.data.total)}catch(m){console.error("Error fetching data:",m)}finally{_(!1)}},[t]);r.useEffect(()=>{S(c.page,c.pageSize,y,w,v,0)},[S,v,c,y,w]);const q=async a=>{var i,f,o;h(!0);try{const n=await z.delete(`${t.deleteUrl}/${a}`);k(((i=n==null?void 0:n.data)==null?void 0:i.message)||"Record deleted successfully","success"),h(!1),F(null),x&&await x(a),S(c.page,c.pageSize,y,w,v,0)}catch(n){if(h(!1),E.isAxiosError(n)){const b=((o=(f=n.response)==null?void 0:f.data)==null?void 0:o.message)||"Failed to delete record";k(b,"error")}else k("An unexpected error occurred","error");h(!1)}},me=async a=>{var i,f,o;h(!0);try{const n=await z.post("api/approval/approval_or_rejceted",{id:a,type:t.cancelApproval,status:"Cancel",function_name:t.cancelApproval});k(((i=n==null?void 0:n.data)==null?void 0:i.message)||"cancel successfully","success"),h(!1),F(null),x&&await x(a),S(c.page,c.pageSize,y,w,v,0)}catch(n){if(h(!1),E.isAxiosError(n)){const b=((o=(f=n.response)==null?void 0:f.data)==null?void 0:o.message)||"Failed to cancel record";k(b,"error")}else k("An unexpected error occurred","error");h(!1)}},ge=a=>{F(a)},fe=d||x||l||t.detailUrl||t.editUrl||t.deleteUrl||I?[{field:"actions",headerName:"Actions",width:250,renderCell:a=>e.jsx(e.Fragment,{children:Z==="dropdown"?e.jsxs($e,{children:[e.jsx(Me,{asChild:!0,children:e.jsxs(B,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"..."}),e.jsx(De,{className:"h-4 w-4"})]})}),e.jsxs(Fe,{align:"end",children:[e.jsx(Ue,{children:"Actions"}),(d||t.editUrl)&&g===0&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.update)??""))&&e.jsx(A,{onClick:()=>d&&d(a.row.id),children:e.jsxs("span",{className:"flex items-center text-sm space-x-2",children:[e.jsx("span",{children:"Edit"}),e.jsx(Te,{size:14})]})})}),e.jsx(X,{}),(t.deleteUrl||x)&&g===0&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.delete)??""))&&e.jsx(A,{className:"bg-red-400 text-white hover:!bg-red-500 hover:!text-white transition-all duration-300",onClick:()=>ge(a.row.id),children:e.jsxs("span",{className:"flex items-center  text-sm space-x-2",children:[e.jsx("span",{children:"Delete"}),e.jsx(Le,{size:14})]})})}),e.jsx(X,{}),(l||t.detailUrl)&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.detail)??""))&&e.jsx(A,{onClick:()=>{l&&l(a.row.id),t.detailUrl&&(window.location.href=`${t.detailUrl}/${a.row.id}`)},children:"View details"})})]})]}):e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(l||t.detailUrl)&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.detail)??""))&&e.jsx(C,{href:t.detailUrl===""?"#":`${t.detailUrl}/${a.row.id}`,onClick:i=>{l&&(i.preventDefault(),l&&l(a.row.id))},alt:"detail",children:e.jsx("i",{className:" ki-duotone ki-size text-info text-2xl"})})}),(M||t.clone)&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.create)??""))&&g===0&&e.jsx(C,{href:t.clone===""?"#":`${t.clone}/${a.row.id}`,onClick:i=>{M&&(i.preventDefault(),M&&M(a.row.id))},alt:"detail",children:e.jsx("i",{className:" ki-filled ki-copy text-warning text-2xl"})})}),(d||t.editUrl)&&g===0&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.update)??""))&&e.jsx(C,{href:t.editUrl===""?"#":`${t.editUrl}/${a.row.id}`,onClick:i=>{d&&(i.preventDefault(),d&&d(a.row.id))},alt:"edit",children:e.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})})}),(t.deleteUrl||x)&&g===0&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.delete)??""))&&e.jsx(C,{href:"",onClick:()=>q(a.row.id),alt:"delete",children:e.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})}),t.cancelApproval&&a.row.status_id===1&&g===0?e.jsx(e.Fragment,{children:e.jsx(C,{href:"",onClick:()=>me(a.row.id),alt:"delete",children:e.jsx("i",{className:"ki-filled ki-cross-square text-danger text-2xl"})})}):e.jsx(e.Fragment,{}),I]})})}]:[],je=(a,i)=>{de(i),S(c.page,c.pageSize,y,w,v,i)};return e.jsx(U,{children:e.jsx(U,{sx:{height:"45rem",width:"100%",overflowX:"auto"},children:e.jsxs(U,{sx:{width:"100%"},children:[se&&((W=(V=O.auth)==null?void 0:V.user)==null?void 0:W.is_approval)&&e.jsx(U,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(ze,{value:g,onChange:je,"aria-label":"dynamic tabs example",children:[e.jsx(J,{label:"List",...Q(0)},0),e.jsx(J,{label:"Approval",...Q(0)},1)]})}),e.jsx("div",{className:"lg:col-span-2 mt-2",children:e.jsx("div",{className:"grid",children:e.jsxs("div",{className:"card card-grid h-full min-w-full",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:e.jsxs("div",{className:"input input-sm max-w-48",children:[e.jsx("i",{className:"ki-filled ki-magnifier"}),e.jsx("input",{placeholder:$,type:"text",value:y,onChange:a=>he(a.target.value),style:{width:"100%",maxWidth:"200px",marginBottom:"10p"}})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[(D||t.addUrl)&&e.jsx(e.Fragment,{children:(!s||p.includes((s==null?void 0:s.create)??""))&&e.jsxs(C,{href:t.addUrl??"#",className:"btn btn-success",onClick:a=>{D&&(a.preventDefault(),D())},style:{marginRight:"10px",marginBottom:"10px"},children:[e.jsx("i",{className:"ki-filled ki-additem"}),"Add New"]})}),N&&e.jsx(K,{className:"btn",variant:"contained",onClick:()=>N(R),color:"primary",startIcon:e.jsx("i",{className:"ki-filled ki-folder-down"}),style:{marginBottom:"10px"},children:"Export TXT"}),u&&e.jsx(K,{className:"btn",variant:"contained",onClick:()=>u(R),color:"primary",startIcon:e.jsx("i",{className:"ki-filled ki-folder-down"}),style:{marginBottom:"10px"},children:"Export Excel"}),T]})]}),e.jsxs("div",{className:"card-body",children:[e.jsx(Be,{isLoading:ce,description:ee,open:P!==null,onClose:()=>{F(null)},onDelete:()=>q(P??0)}),e.jsx("div",{"data-datatable":"true","data-datatable-page-size":c.pageSize,children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx(Ae,{rows:ae,columns:[...j,...fe],loading:ie,paginationMode:"server",rowCount:oe,paginationModel:c,onPaginationModelChange:ne,pageSizeOptions:[10,20],sortingMode:"server",sortModel:w,onSortModelChange:a=>re(a),filterMode:"server",filterModel:v,onFilterModelChange:a=>le(a)})})})]})]})})})]})})})};export{Be as C,Ke as D};
