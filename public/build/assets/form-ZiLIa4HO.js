import{r as p,u as V,j as t}from"./app-CV10uzWG.js";import{F as A}from"./form-KSID0OHU.js";import{z as i,t as v}from"./index-7N5pB95g.js";import{B}from"./button-UlT1BOWX.js";import{u as I}from"./index.esm-Dzxxg8en.js";import{S as M}from"./scroll-area-BpFf_0v8.js";import{F as x}from"./formDropdown-B0kDHCmL.js";import{u as y}from"./getDropdown-E9AyxCIu.js";import{a as m}from"./axiosInstance-BcPhbij1.js";import{F as c}from"./utils-BPWnHuGG.js";import{M as C}from"./MultiSelect-Cbp65CyH.js";import{a as O}from"./api-BBkWHPRN.js";import"./app-HlhieNAw.js";import"./index-qPAGw66Z.js";import"./TextField-BZk5FbFx.js";import"./useSlot-CHK5ZbNp.js";import"./FormHelperText-9PHiKM0M.js";import"./createSimplePaletteValueFilter-J8Gigk6S.js";import"./index-DO9JY6h7.js";import"./checkbox-C2CdRnNj.js";import"./index-C5Q3lYX0.js";import"./index-NPO0cpzr.js";import"./index-CEI-hFq8.js";function ne({onSuccess:o,type:d=c.create,storeURL:j,editURL:g,updateURL:w}){const[R,u]=p.useState([]);p.useState(null);const{dataDropdown:_,getDropdown:h}=y(),{dataDropdown:T,getDropdown:f}=y(),E=i.object({period:i.number("Period must choose"),type:i.number("Type must choose"),users:i.array(i.number().optional())}),S={period:null,type:null,users:[]},a=I({resolver:v(E),defaultValues:S});async function D(){try{const r=(await m.get(g)).data.data;n(r.type),a.reset({period:r.period,type:r.type,users:r.users})}catch{}}const{showToast:b}=V(),F=async e=>{var r;try{let s;d===c.edit?s=await m.put(w??"",e):s=await m.post(j??"",e),o==null||o(!0),b((r=s==null?void 0:s.data)==null?void 0:r.data,"success")}catch(s){o==null||o(!1),b(s.message,"error")}},N=async e=>{e.length>0&&h(e,{name:"code",id:"id",tabel:"master_type_reimburses"})},P=async e=>{e.length>0&&f(e,{name:"code",id:"id",tabel:"master_period_reimburses"})},n=async e=>{try{const s=(await m.get(O(e))).data.data.map(l=>({id:l.id,name:l.name,nip:l.nip}));u(s)}catch(r){console.error("Error fetching users:",r),u([])}},U=e=>{a.setValue("type",e),n(e)};return p.useEffect(()=>{h("",{name:"code",id:"id",tabel:"master_type_reimburses"}),f("",{name:"code",id:"id",tabel:"master_period_reimburses"}),d===c.edit?D():a.getValues("type")&&n(a.getValues("type"))},[d]),t.jsx(M,{className:"h-[600px] w-full",children:t.jsx(A,{...a,children:t.jsxs("form",{onSubmit:a.handleSubmit(F),children:[t.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[t.jsxs("tr",{children:[t.jsx("td",{width:200,children:"Type"}),t.jsx("td",{children:t.jsx(x,{options:_,fieldName:"type",isRequired:!0,disabled:!1,placeholder:"Reimburse Type",onSearch:N,onChangeOutside:e=>U(e),classNames:"mt-2 w-full"})})]}),t.jsxs("tr",{children:[t.jsx("td",{width:200,children:"Period"}),t.jsx("td",{children:t.jsx(x,{options:T,fieldName:"period",isRequired:!0,disabled:!1,placeholder:"Reimburse Period",onSearch:P,classNames:"mt-2 w-full"})})]}),t.jsxs("tr",{children:[t.jsxs("td",{width:200,children:["Users ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("td",{children:t.jsx(C,{onSelect:e=>{a.setValue("users",e.map(r=>r.id))},value:a.getValues("users"),id:"id",label:"name",options:R})})]})]}),t.jsx("div",{className:"flex justify-end items-center",children:t.jsx(B,{type:"submit",children:"Save"})})]})})})}export{ne as default};
