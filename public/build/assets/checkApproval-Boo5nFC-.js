import{r as p,u as N,j as a}from"./app-oDap9ILf.js";import{a as R}from"./index.esm-Dv3C6sg_.js";import{a as C}from"./axiosInstance-lCBVT6Sr.js";import{L as D}from"./Loading-OqSXRo09.js";import{W as S}from"./WorkflowComponent-BeQnBTM7.js";import{F as v}from"./formDropdown-BZxpw_ek.js";import{u as P}from"./getDropdown-IwOMFLUg.js";import{B as T}from"./Button-D6dqsbry.js";import"./app-HlhieNAw.js";import"./index-Dnwhm5k9.js";import"./createLucideIcon-BwlCn8yS.js";import"./TextField-437Zs68i.js";import"./useSlot-Bpw8ZwCk.js";import"./FormHelperText-B-hD-o5w.js";import"./extends-CF3RwP-h.js";import"./createSimplePaletteValueFilter-CgIJCn2I.js";const X=({isDisabled:L})=>{const{getValues:_,watch:i}=R(),[f,e]=p.useState(!1),[h,g]=p.useState(!1),[t,w]=p.useState({approvalRequest:[],approvalFrom:[],acknowledgeFrom:[]}),{dataDropdown:y,getDropdown:x}=P(),{showToast:r}=N(),b=i("document_type"),k=i("metode_approval"),A=async()=>{var n,m,u,d;try{const o=_();if(console.log(o),o.document_type===null||o.document_type===void 0){e(!1),r("Please input Document Type","error");return}if(o.purchasing_groups===null||o.purchasing_groups===void 0){e(!1),r("Please input purchasing group","error");return}if(o.total_all_amount===null||o.total_all_amount===void 0){e(!1),r("Please input Item","error");return}if(o.user_id===null||o.user_id===void 0){e(!1),r("Please input Item","error");return}if(o.document_type==="ZENT"){if(o.metode_approval===null||o.metode_approval===void 0){e(!1),r("Please select metode approval","error");return}if(o.metode_approval==="chooses_approval"&&(o.chooses_approval_id===null||o.chooses_approval_id===void 0)){e(!1),r("Please select chooses approval","error");return}}const s=await C.get("/check-approval",{params:{document_type_id:o.document_type,purchasing_group_id:o.purchasing_groups,value:o.total_all_amount,user_id:o.user_id,type:"PR",metode_approval:o.metode_approval,chooses_approval_id:o.chooses_approval_id}});if(s.data.status_code===200){const F=(m=(n=s.data)==null?void 0:n.data)==null?void 0:m.approval_route.map(l=>{var c;return((c=l.user.divisions)==null?void 0:c.name)||null}),j=(d=(u=s.data)==null?void 0:u.data)==null?void 0:d.approval_route.map(l=>l.user.name);w({approvalRequest:F,approvalFrom:j,acknowledgeFrom:[]}),g(!0)}e(!1)}catch{e(!1)}};return p.useEffect(()=>{x("",{name:"name",id:"id",tabel:"approval_tracking_number_chooses"})},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"card card-grid h-full min-w-full p-4",children:[a.jsx(D,{isLoading:f}),a.jsxs("div",{className:"card-body",children:[a.jsx("div",{className:"flex justify-start mt-4 mb-2",children:a.jsx(T,{onClick:async()=>await A(),variant:"contained",color:"primary",type:"button",children:"Check Approval"})}),b==="ZENT"&&a.jsxs(a.Fragment,{children:[a.jsx(v,{options:[{label:"Approval",value:"approval"},{label:"Chooses Approval Tracking Number",value:"chooses_approval"},{label:"Automatic Approval Tracking Number",value:"automatic_approval_by_purchasing_group"}],fieldLabel:"Metode Approval",fieldName:"metode_approval",disabled:!1,style:{width:"58.5rem"},placeholder:"Metode Approval",classNames:"mt-2"}),k==="chooses_approval"&&a.jsx(v,{options:y,fieldLabel:"Select Chooses approval",fieldName:"chooses_approval_id",isRequired:!0,disabled:!1,style:{width:"58.5rem"},placeholder:"Select Chooses approval",classNames:"mt-2"})]}),h&&a.jsx(S,{workflowApproval:{approvalRequest:t.approvalRequest,approvalFrom:t.approvalFrom,acknowledgeFrom:t.acknowledgeFrom},workflowApprovalStep:t.approvalFrom,workflowApprovalDiagram:t.approvalFrom})]})]})})};export{X as default};
