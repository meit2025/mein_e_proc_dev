import{r as K,j as e}from"./app-B0sgHWss.js";import{F as h,a as j,b as f,c as b}from"./form-CEbJJ39S.js";import{B as Q}from"./button-C9EraPp_.js";import{b as D}from"./index.esm-DLrvskkb.js";/* empty css              */import{c as V}from"./tabs-8xs0cqs6.js";import{C as I}from"./CustomDatePicker-CnfPoUtw.js";import{h as u}from"./moment-C5S46NFB.js";import{F as x}from"./formDropdown-BC2KZl3P.js";import{DetailAttedances as W}from"./DetailAttedances-m9bAjb3d.js";import{DetailAllowance as X}from"./DetailAllowance-D-_wIsyd.js";import{ResultTotalItem as Y}from"./ResultTotalItem-DGt7pi6z.js";import{C as Z}from"./checkbox-BeAm6vzQ.js";import"./app-DQK4SJPx.js";import"./index-D8iPwMcx.js";import"./utils-CGK61d1g.js";import"./index-CjH9nTmJ.js";import"./index-LmE4SYfz.js";import"./index-Bb4qSo10.js";import"./index-CHFn1bBq.js";import"./index-55BNGkH-.js";import"./index-D4jP3VR_.js";import"./index-Pr610DSO.js";import"./index-DgcUBo_l.js";import"./index-BL04p_kt.js";import"./Combination-BrLhy7PS.js";import"./createLucideIcon-BCE2JZgR.js";import"./TextField-BkzN09f4.js";import"./createSvgIcon-CLp3oxdu.js";import"./DefaultPropsProvider-BHe5EYJc.js";import"./useSlot-DC-8qNYn.js";import"./createSimplePaletteValueFilter-CnABCHS0.js";import"./useControlled-C8tB4uCv.js";import"./FormHelperText-Ca2avC5g.js";import"./input-Ct7pWzd8.js";import"./rupiahCurrencyFormat-CP-6egij.js";import"./chevrons-up-down-Dbf_E47R.js";import"./index-Cp6z5WuG.js";function He({key:S,form:n,index:t,destination:a,updateDestination:d,listAllowances:$,setTotalAllowance:B,pajak:ee,purchasingGroup:te,dataTax:q,dataPurchasingGroup:E,dataDestination:O,type:g,btClone:w,setSelectedDates:m,selectedDates:A}){const{fields:G,update:T,append:L,remove:P}=D({control:n.control,name:`destinations.${t}.detail_attedances`}),{fields:v,update:se,append:re,remove:H,replace:M}=D({control:n.control,name:`destinations.${t}.allowances`});function U(){let s=u(a.business_trip_start_date).startOf("day");const r=u(a.business_trip_end_date).startOf("day");for(P(),H();s.isBefore(r)||s.isSame(r);){const o={date:s.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};L(o),s=s.add(1,"days")}function i(o){let p=u(a.business_trip_start_date).startOf("day");const y=u(a.business_trip_end_date).startOf("day"),R=[];for(;p.isBefore(y)||p.isSame(y);)R.push({date:p.toDate(),request_price:o}),p=p.add(1,"days");return R}const l=$.map(o=>({name:o.name,code:o.code,default_price:parseInt(o.grade_price),type:o.type,subtotal:parseInt(o.grade_price),currency:o.currency_id,request_value:o.request_value,detail:o.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(o.grade_price)}]:i(o.grade_price)}));M(l)}const C=(s,r)=>{m(i=>{const l=[...i];return l[r]={...l[r],from:s},l})},F=(s,r)=>{d(r,{...a,business_trip_end_date:s}),m(i=>{const l=[...i];return l[r]={...l[r],to:s},l})},[N,c]=K.useState(),_={};N&&(_.selected=N);const k=(s,r)=>{r==="start"&&(d(s,{...a,business_trip_start_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],from:void 0},l})),r==="end"&&(d(s,{...a,business_trip_end_date:null}),m(i=>{const l=[...i];return l[s]={...l[s],to:void 0},l})),c(void 0)};let z=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>k(t,"start"),children:"Reset"})}),J=e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>k(t,"end"),children:"Reset"})});return e.jsxs(V,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:O,fieldName:`destinations.${t}.destination`,isRequired:!0,disabled:!1,placeholder:"Select Destination",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,destination:s})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200}),e.jsxs("td",{className:"flex gap-2",children:[e.jsx(h,{control:n.control,name:`destinations.${t}.restricted_area`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(Z,{checked:a.restricted_area,onCheckedChange:r=>{d(t,{...a,restricted_area:r})}})}),e.jsx(b,{})]})}),"Restricted Area"]})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Pajak",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:q,fieldName:`destinations.${t}.pajak_id`,isRequired:!0,disabled:!1,placeholder:"Select Pajak",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,pajak_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Purchasing Group",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("td",{children:e.jsx(x,{fieldLabel:"",options:E,fieldName:`destinations.${t}.purchasing_group_id`,isRequired:!0,disabled:!1,placeholder:"Select Purchasing Group",classNames:"mt-2 w-full",onChangeOutside:s=>{d(t,{...a,purchasing_group_id:s})}})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Bussines Trip Date",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(h,{control:n.control,name:`destinations.${t}.business_trip_start_date`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(I,{initialDate:a.business_trip_start_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(C(void 0,t),c(void 0),d(t,{...a,business_trip_start_date:void 0,business_trip_end_date:void 0})):(C(r,t),c(r),d(t,{...a,business_trip_start_date:r,business_trip_end_date:r}))},disabled:!1,disabledDays:A,footer:z})}),e.jsx(b,{})]})}),e.jsx("span",{children:"To"}),e.jsx(h,{control:n.control,name:`destinations.${t}.business_trip_end_date`,render:({field:s})=>e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(I,{initialDate:a.business_trip_end_date,modifiers:_,onDayClick:(r,i)=>{i.selected?(F(void 0,t),c(void 0),d(t,{...a,business_trip_end_date:void 0})):(F(r,t),c(r),d(t,{...a,business_trip_end_date:r}))},disabled:!1,disabledDays:A,footer:J})}),e.jsx(b,{})]})}),e.jsx(Q,{type:"button",onClick:()=>U(),children:"Get Detail"})]})]})]}),e.jsx(W,{detailAttedanceFields:G,form:n,updateAttedanceFields:T,destinationIndex:t,type:g,btClone:w}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(X,{allowanceField:v,destinationIndex:t,form:n,type:g,btClone:w})]},t),e.jsx(Y,{allowanceField:v,destinationIndex:t,form:n,setTotalAllowance:B})]},S)}export{He as BussinessDestinationForm};
