import{j as e,r as $}from"./app-CI-zEn35.js";import{F as m,a as h,b as j,c as u}from"./form--2fID3m4.js";import{B as C}from"./button-DD8Twa0k.js";import{c as g}from"./index.esm-CcRmhU4Z.js";/* empty css              */import{I as v}from"./input-CWTpTUVh.js";import{h as F}from"./moment-C5S46NFB.js";import{f as y}from"./rupiahCurrencyFormat-CP-6egij.js";import{C as D}from"./chevrons-up-down-D6DGU5WN.js";import"./app-DQK4SJPx.js";import"./index-BQaVeSfQ.js";import"./utils-DH4RFaGN.js";import"./index-BM2MB-d3.js";import"./index-CHFGND18.js";import"./index-Bb4qSo10.js";import"./createLucideIcon-BJNLPZTQ.js";function G({form:i,destinationIndex:t,allowanceField:a,type:r,btClone:p}){return e.jsx("table",{className:"w-full allowance-table",children:a.map((o,d)=>e.jsx(R,{form:i,allowance:o,destinationIndex:t,allowanceIndex:d,type:r,btClone:p}))})}function R({form:i,allowance:t,destinationIndex:a,allowanceIndex:r,type:p,btClone:o}){const[d,f]=$.useState(!1),A=s=>{f(l=>!l)},N=g({control:i.control,name:`destinations.${a}.allowances.${r}.detail.0.request_price`}),c=g({control:i.control,name:`destinations.${a}.allowances.${r}.detail`}),b=()=>{if(t.type==="total")return parseFloat(N||0)*1;{let s=0;return c==null||c.forEach(l=>{const n=parseFloat(l.request_price||0);s+=n}),s}},x=s=>l=>{const n=parseFloat(l.target.value)||0;t.request_value==="unlimited"?s.onChange(l):t.request_value==="up to max value"?n<=t.subtotal?s.onChange(l):alert(`Value cannot exceed the subtotal of IDR ${t.subtotal}`):t.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:t.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{control:i.control,name:`destinations.${a}.allowances.${r}.detail.0.request_price`,render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(v,{value:s.value,onChange:x(s)})}),e.jsx(u,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",t.detail.length," Days * ",y(t.subtotal)," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",y(b())]})})}),t.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>A(),children:e.jsxs(C,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},t.id),d&&e.jsx(e.Fragment,{children:t.detail.map((s,l)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:F(s.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(m,{control:i.control,name:`destinations.${a}.allowances.${r}.detail.${l}.request_price`,render:({field:n})=>e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(v,{value:n.value,onChange:x(n)})}),e.jsx(u,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},s.id))})]})}export{R as AllowanceRowInput,G as DetailAllowance};
