import{r as v,j as a,x as D}from"./app-BAUvTBFc.js";import{a as Z,c as b}from"./index.esm-B6Hu-QJz.js";import{F as n}from"./formDropdown-Clcoci-J.js";import{F as l}from"./formInput-Dz2lP4q6.js";import{F as q}from"./formSwitch-CYKenpUM.js";import{F as ee}from"./formTextArea-CcwvFk32.js";import{columnsItem as te}from"./listModel-BkH9xzZv.js";import{u as d}from"./getDropdown-Do5db5up.js";import{B as ae}from"./Button-AUytoaS2.js";import{B as se}from"./Box-u7Px2cum.js";import{D as re}from"./DataGrid-DVA3gIQo.js";import"./app-ffJwujpg.js";import"./TextField-CWWepeO9.js";import"./createSvgIcon-SegsbWm-.js";import"./DefaultPropsProvider-DO-4iv4g.js";import"./useSlot-Dy9wHqJW.js";import"./createSimplePaletteValueFilter-DVHk4EXB.js";import"./CircularProgress-DDQWZ2S0.js";import"./FormHelperText-eTmSuhr1.js";import"./mergeSlotProps-JanglAjM.js";import"./rupiahCurrencyFormat-D0mkqwcl.js";import"./Switch-CnxAcj8C.js";import"./SwitchBase-cqEw4_Wq.js";import"./Typography-C9PTza9e.js";import"./CustomStatus-D4ERwI-h.js";import"./utils-C9i4vpEf.js";import"./createLucideIcon-OouD056Q.js";import"./page-DZboPOZw.js";import"./moment-C5S46NFB.js";import"./axiosInstance-cq675ARv.js";import"./index-KY1zmAli.js";import"./index-Dnd4iUQs.js";import"./ListItemText-B9jyYUKb.js";import"./FormControlLabel-QXc_KGVu.js";import"./KeyboardArrowRight-DusmPGhS.js";const Pe=({dataIndex:m,subAsset:A,FetchDataValue:L,disable:s})=>{const{getValues:x,setValue:t,watch:R}=Z(),{dataDropdown:C,getDropdown:g}=d(),{dataDropdown:F,getDropdown:M}=d(),{dataDropdown:k,getDropdown:E}=d(),{dataDropdown:S,getDropdown:T}=d(),{dataDropdown:I,getDropdown:V}=d(),{dataDropdown:$,getDropdown:P}=d(),{dataDropdown:B,getDropdown:O}=d(),{dataDropdown:G,getDropdown:U}=d(),{dataDropdown:y,getDropdown:w}=d();b({name:"total_item"});const W=R(`vendors[${m}].units`),u=b({name:"item_account_assignment_categories"}),N=b({name:"document_type"}),z=b({name:"item_is_cashAdvance"});v.useEffect(()=>{M("",{name:"desc",id:"cost_center",tabel:"master_cost_centers"}),g("",{name:"name_one",id:"id",tabel:"master_business_partners"}),T("",{name:"material_group_desc",id:"material_group",tabel:"material_groups"}),P("",{name:"description",id:"mwszkz",tabel:"pajaks"}),O("",{name:"unit_of_measurement_text",id:"commercial",tabel:"uoms"}),U("",{name:"desc",id:"order_number",tabel:"master_orders"}),w("",{name:"desc",id:"asset",tabel:"master_assets",where:{groupBy:"asset,desc"}})},[]),v.useEffect(()=>{E("",{name:"description",id:"account",tabel:"account_assignment_categories",attribut:N})},[N]);const H=async e=>{V("",{name:"material_number",id:"material_number",tabel:"master_materials",attribut:e,where:{key:"material_group",parameter:e}})},K=async()=>{const e=x(),p={id:e.item_id??`random-generated-id-${Math.random().toString(36).substr(2,9)}`,qty:e.item_qty,unit_price:e.item_unit_price,total_amount:e.item_qty*e.item_unit_price,account_assignment_categories:e.item_account_assignment_categories,cost_center:e.item_cost_center,material_group:e.item_material_group,material_number:e.item_material_number,uom:e.item_uom,tax:e.item_tax,short_text:e.item_short_text,order_number:e.item_order_number,asset_number:e.item_asset_number,sub_asset_number:e.item_sub_asset_number,is_cashAdvance:e.item_is_cashAdvance,cash_advance_purchases:{dp:e.item_dp,reference:e.item_reference,document_header_text:e.item_document_header_text,document_date:e.item_document_date,due_on:e.item_due_on,text:e.item_text_cash_advance}},_=x(`vendors[${m}].units`)||[];let r=[];e.action==="edit"?r=_.map((i,c)=>i.id===e.indexEdit?p:i):r=[..._,p];const h=r.reduce((i,c)=>i+parseInt(c.total_amount),0),f=r.reduce((i,c)=>c.unit_price>i?parseInt(c.unit_price):i,0);t("amount_max",f),t(`vendors[${m}].units`,r),t("total_all_amount",h),t("indexEdit",0),t("item_id",null),Q()},Q=()=>{t("indexEdit",""),t("action","create"),t("item_account_assignment_categories",""),t("item_asset_number",""),t("item_cost_center",""),t("item_document_date",""),t("item_document_header_text",""),t("item_dp",""),t("item_due_on",""),t("item_id",""),t("item_is_cashAdvance",""),t("item_material_group",""),t("item_material_number",""),t("item_order_number",""),t("item_qty",""),t("item_reference",""),t("item_short_text",""),t("item_sub_asset_number",""),t("item_tax",""),t("item_text_cash_advance",""),t("item_unit_price",""),t("item_uom",""),t("cash_advance_purchases",null)},X=(e,o)=>{var _,r,h,f,i,c,j;console.log(o,e.id);const p=e.id??`random-generated-id-${Math.random().toString(36).substr(2,9)}`;t("indexEdit",p),t("action","edit"),t("item_account_assignment_categories",e.account_assignment_categories??""),t("item_asset_number",e.asset_number??""),t("item_cost_center",e.cost_center??""),t("item_id",p),t("item_is_cashAdvance",((_=e.cash_advance_purchases)==null?void 0:_.reference)!==null),t("item_material_group",e.material_group??""),t("item_material_number",e.material_number??""),t("item_order_number",e.order_number??""),t("item_qty",e.qty??"0"),t("item_short_text",e.short_text??""),t("item_sub_asset_number",e.sub_asset_number??""),t("item_tax",e.tax??""),t("item_unit_price",e.unit_price??"0"),t("item_uom",e.uom??""),t("item_reference",((r=e.cash_advance_purchases)==null?void 0:r.reference)??""),t("item_dp",((h=e.cash_advance_purchases)==null?void 0:h.dp)??""),t("item_due_on",((f=e.cash_advance_purchases)==null?void 0:f.due_on)??""),t("item_text_cash_advance",((i=e.cash_advance_purchases)==null?void 0:i.text)??""),t("item_document_date",((c=e.cash_advance_purchases)==null?void 0:c.document_date)??""),t("item_document_header_text",((j=e.cash_advance_purchases)==null?void 0:j.document_header_text)??"")},Y=(e,o)=>{const _=(x(`vendors[${m}].units`)||[]).filter((r,h)=>r.id!==e.id);t(`vendors[${m}].units`,_)},J=[{field:"actions",headerName:"Actions",width:150,renderCell:e=>a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",gap:"10px"},children:[a.jsx(D,{type:"button",onClick:o=>{o.preventDefault(),X(e.row,e)},href:"#",children:a.jsx("i",{className:" ki-duotone ki-notepad-edit text-success text-2xl"})}),a.jsx(D,{type:"button",onClick:o=>{o.preventDefault(),Y(e.row)},href:"#",children:a.jsx("i",{className:" ki-duotone ki-trash-square text-danger text-2xl"})})]})}];return a.jsxs("div",{children:[a.jsx(n,{options:C,fieldLabel:"Select Vendor",fieldName:`vendors[${m}].vendor`,isRequired:!0,style:{width:"56.5rem"},placeholder:"Select Vendor",classNames:"mt-2",disabled:s}),a.jsx(q,{fieldLabel:"Vendor Winner",fieldName:`vendors[${m}].winner`,isRequired:!1,disabled:s}),!s&&a.jsxs("div",{className:"card mt-2",children:[a.jsx("div",{className:"card-header",children:a.jsx("p",{children:"item"})}),a.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[a.jsx(l,{fieldLabel:"Qty",fieldName:"item_qty",isRequired:!1,type:"number",placeholder:"Enter your qty",disabled:s}),a.jsx(l,{fieldLabel:"Unit Price",fieldName:"item_unit_price",isRequired:!1,disabled:s,type:"number",placeholder:"Unit Price"}),a.jsx(n,{options:k,fieldLabel:"Account Assignment",fieldName:"item_account_assignment_categories",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Account Assignment",classNames:"mt-2"}),(u==="K"||u==="V"||u==="W"||u==="Y")&&a.jsx(n,{options:F,fieldLabel:"Cost Center",fieldName:"item_cost_center",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Cost Center",classNames:"mt-2"}),a.jsx(n,{options:S,fieldLabel:"Material Group",fieldName:"item_material_group",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Material Group",classNames:"mt-2",onChangeOutside:async(e,o)=>{await H(e)}}),a.jsx(n,{options:I,fieldLabel:"Material number",fieldName:"item_material_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Material number",classNames:"mt-2"}),a.jsx(n,{options:B,fieldLabel:"Uom",fieldName:"item_uom",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Purchase requisition unit of measure",classNames:"mt-2"}),a.jsx(n,{options:$,fieldLabel:"Tax on sales",fieldName:"item_tax",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Tax on sales",classNames:"mt-2"}),a.jsx(ee,{fieldLabel:"Short Text",fieldName:"item_short_text",isRequired:!1,disabled:s,maxLength:40,classNames:"mt-4",style:{width:"56.5rem"}}),u==="F"&&a.jsx(n,{options:G,fieldLabel:"Order Number",fieldName:"item_order_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Order Number",classNames:"mt-2"}),u==="A"&&a.jsxs(a.Fragment,{children:[a.jsx(n,{options:y,fieldLabel:"Main Asset Number",fieldName:"item_asset_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Main Asset",classNames:"mt-2",onChangeOutside:(e,o)=>{L(e,m)},onSearch:async e=>(await w("",{name:"desc",id:"asset",tabel:"master_assets",search:e,where:{groupBy:"asset,desc"}}),y??[]),onFocus:async()=>{const e=x("item_asset_number");await g("",{name:"desc",id:"asset",tabel:"master_assets",hasValue:{key:e?"id":"",value:e??""},where:{groupBy:"asset,desc"}})}}),a.jsx(n,{options:A[m],fieldLabel:"Sub Asset",fieldName:"item_sub_asset_number",isRequired:!1,disabled:s,style:{width:"56.5rem"},placeholder:"Sub Asset Number",classNames:"mt-2"})]}),a.jsx(q,{fieldLabel:"cash Advance",fieldName:"item_is_cashAdvance",isRequired:!1,disabled:s}),z&&a.jsxs(a.Fragment,{children:[a.jsx("hr",{}),a.jsx(l,{fieldLabel:"Persantase DP Number",fieldName:"cash_advance_purchases.dp",isRequired:!0,disabled:s,type:"number",placeholder:"Persantase DP Number",maxLength:100,minLength:1}),a.jsx(l,{fieldLabel:"reference",fieldName:"item_reference",isRequired:!1,disabled:s,type:"text",placeholder:"Enter reference"}),a.jsx(l,{fieldLabel:"Document Header Text",fieldName:"item_document_header_text",isRequired:!1,disabled:s,type:"text",placeholder:"Document Header Text"}),a.jsx(l,{fieldLabel:"Document Date",fieldName:"item_document_date",isRequired:!1,disabled:s,type:"date",placeholder:"enter your Document Date"}),a.jsx(l,{fieldLabel:"Due On",fieldName:"item_due_on",isRequired:!1,disabled:s,type:"date",placeholder:"enter your Due On"}),a.jsx(l,{fieldLabel:"text",fieldName:"item_text_cash_advance",isRequired:!1,disabled:s,type:"text",placeholder:"enter your text"})]})]}),a.jsx("div",{className:"card-footer",children:a.jsx(ae,{type:"button",variant:"contained",className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-all",onClick:async()=>await K(),children:"Add Item"})})]}),a.jsx(se,{sx:{width:"100%",overflowX:"auto",marginTop:"1rem"},children:a.jsx("div",{className:"lg:col-span-2",children:a.jsx("div",{className:"grid",children:a.jsx("div",{className:"card card-grid h-full min-w-full",children:a.jsx("div",{className:"card-body",children:a.jsx("div",{"data-datatable":"true",children:a.jsx("div",{className:"scrollable-x-auto",children:a.jsx(re,{columns:[...s?[]:J,...te],rows:W,hideFooterPagination:!0})})})})})})})})]})};export{Pe as default};
