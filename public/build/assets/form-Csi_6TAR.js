import{r as v,u as k,j as e}from"./app-CM3a6AMx.js";import{d as B,F as i,a as n,b as d,c}from"./form-C7dK1lvL.js";import{z as s,t as U}from"./index-1rkLDSpP.js";import{B as Y}from"./button-DSj1dE-z.js";import{u as z,b as $}from"./index.esm-CyL4HeOh.js";import{S as H}from"./scroll-area-D-RY_byD.js";import{S as x,a as h,b as p,c as j,d as o}from"./select-DcXw8vm_.js";import{I as g}from"./input-dkEhNxwo.js";import{a as b}from"./axiosInstance-DNBZQMNr.js";import{M as J}from"./MultiSelect-BLdr5hih.js";import{F as u}from"./utils-D9cQCQE5.js";import{F as y}from"./formDropdown-BtEKq3m5.js";import{u as C}from"./getDropdown-JLTaLmuZ.js";import"./app-DQK4SJPx.js";import"./index-Dwwa6c3M.js";import"./index-B4No1jTG.js";import"./index-BhoK6Rbq.js";import"./index-Bb4qSo10.js";import"./index-BvQZoS64.js";import"./index-g0vlDlbq.js";import"./index-ByKLJkfo.js";import"./index-ZoMH47jF.js";import"./Combination-DX63lx9B.js";import"./index-glVq3Kuk.js";import"./index-BLceM0nB.js";import"./index-BGDdWDtd.js";import"./checkbox-CRiISz8l.js";import"./TextField-CszGyKbI.js";import"./createSvgIcon-Basgfq6T.js";import"./DefaultPropsProvider-c1JEsdsa.js";import"./useSlot-C64eCYFR.js";import"./createSimplePaletteValueFilter-DDZkRvI6.js";import"./useControlled-D2LMQn40.js";import"./FormHelperText-DIvsH4dd.js";var K=(l=>(l[l.create=0]="create",l[l.edit=1]="edit",l[l.update=2]="update",l))(K||{});function Fe({onSuccess:l,type:m=u.create,detailUrl:N,id:P,listCurrency:S,listAllowanceCategory:q,listGrade:M,createUrl:V,editUrl:F}){const D=s.object({code:s.string().min(1,"Code is required"),name:s.string().min(1,"Name is required"),type:s.string().min(1,"Type is required"),material_number:s.string().min(1,"Material number required"),material_group:s.string().min(1,"Material Group required"),currency_id:s.string().min(1,"Currency is required"),allowance_category_id:s.string().min(1,"Allowance Category is required"),request_value:s.string().min(1,"Required"),grade_option:s.string().min(1,"Grade must be selected"),grade_all_price:s.string().optional(),grades:s.array(s.object({grade:s.string(),id:s.number(),plafon:s.string()}))});v.useState([]),v.useState("");const G={code:"",name:"",type:"",currency_id:"",allowance_category_id:"",request_value:"unlimited",grade_option:"all",grade_all_price:"0",grades:[]},t=z({resolver:U(D),defaultValues:G}),{dataDropdown:I,getDropdown:A}=C(),{dataDropdown:R,getDropdown:f}=C();async function L(){try{const a=await b.get(N??""),r=a.data.data.allowance;console.log(r),f("",{name:"material_description",id:"material_number",tabel:"master_materials",attribut:r.material_group,isMapping:!0,where:{key:"material_group",parameter:r.material_group}});const _=a.data.data.grades;t.reset({code:r.code,name:r.name,type:r.type,material_number:r.material_number,material_group:r.material_group,currency_id:r.currency_id,allowance_category_id:r.allowance_category_id,grade_option:r.grade_option,grade_all_price:r.grade_all_price,grades:_}),t.setValue("request_value",r.request_value)}catch{}}const{fields:O}=$({control:t.control,name:"grades"}),{showToast:w}=k(),T=async a=>{try{if(console.log(a),m===u.create){const r=await b.post(V??"",a)}else if(m===u.edit){const r=await b.put(F??"",a)}w("success","success"),l==null||l(!0)}catch(r){r.response&&w(r.response.data.message,"error")}};v.useEffect(()=>{(m===u.detail||m===u.edit)&&L(),A("",{name:"material_group_desc",id:"material_group",tabel:"material_groups",idType:"string"})},[m]);const E=async a=>{f("",{name:"material_description",id:"material_number",tabel:"master_materials",attribut:a,isMapping:!0,where:{key:"material_group",parameter:a}})};return e.jsx(H,{className:"h-[600px] w-full",children:e.jsx(B,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(T),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(i,{control:t.control,name:"code",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(g,{type:"text",readOnly:m===u.edit,placeholder:"Insert code",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(i,{control:t.control,name:"name",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(g,{type:"text",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Type"}),e.jsx("td",{children:e.jsx(i,{control:t.control,name:"type",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(x,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(h,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select type"})}),e.jsxs(j,{children:[e.jsx(o,{value:"daily",children:"DAILY"},"DAILY"),e.jsx(o,{value:"total",children:"Total"},"TOTAL")]})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(y,{fieldLabel:"",options:I,fieldName:"material_group",isRequired:!0,disabled:!1,placeholder:"Select Material Group",classNames:"mt-2 w-full",onChangeOutside:async(a,r)=>{await E(a)}})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(y,{fieldLabel:"",options:R,fieldName:"material_number",isRequired:!1,disabled:!1,placeholder:"Material number",classNames:"mt-2 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Currency"}),e.jsx("td",{children:e.jsx(i,{control:t.control,name:"currency_id",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(x,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(h,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Currency"})}),e.jsx(j,{children:S.map(r=>e.jsxs(o,{value:r.code,children:[r.name," ",r.code]},r.code))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Allowance Category"}),e.jsx("td",{children:e.jsx(i,{control:t.control,name:"allowance_category_id",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(x,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(h,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Allowance Category"})}),e.jsx(j,{children:q.map(r=>e.jsx(o,{value:r.id.toString(),children:r.name},r.id))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{className:"gap-4",children:[e.jsx(i,{control:t.control,name:"grade_option",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(x,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(h,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Request Value"})}),e.jsxs(j,{children:[e.jsx(o,{value:"all",children:"All"},"all"),e.jsx(o,{value:"grade",children:"grade"},"grade")]})]})}),e.jsx(c,{})]})}),t.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(i,{control:t.control,name:"grade_all_price",render:({field:a})=>e.jsx(n,{children:e.jsx(d,{children:e.jsx(g,{...a})})})})}):e.jsx("div",{children:e.jsx(J,{label:"grade",id:"id",options:M,value:t.getValues("grades").map(a=>a.id),onSelect:a=>{t.setValue("grades",a.map(r=>({id:r.id,grade:r.grade,plafon:""})))}})}),t.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:O.map((a,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Grade ",a.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(i,{control:t.control,name:`grades.${r}.plafon`,render:({field:_})=>e.jsx(n,{children:e.jsx(d,{children:e.jsx(g,{..._})})})})})})]},a))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request Value"}),e.jsx("td",{children:e.jsx(i,{control:t.control,name:"request_value",render:({field:a})=>e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(x,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(h,{className:"w-[200px]",children:e.jsx(p,{placeholder:"Select Request Value"})}),e.jsxs(j,{children:[e.jsx(o,{value:"unlimited",children:"Unlimited"},"unlimited"),e.jsx(o,{value:"up to max value",children:"Up to Max Value"},"up to max value"),e.jsx(o,{value:"fixed value",children:"Fixed Value"},"fixed value")]})]})}),e.jsx(c,{})]})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(Y,{type:"submit",children:"Save"})})]})})})}export{K as AllowanceType,Fe as default};
