import{q as y,u as w,r as n,j as e,a as v}from"./app-DTcxNK3y.js";import{L as f}from"./logo-HtzTG1e0.js";import{a as b}from"./axiosInstance-BRV2EWJS.js";import{L as k}from"./Loading-SfH9Tlzf.js";import"./app-DQK4SJPx.js";import"./index-DdUz9uuq.js";const _=s=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center size-8 bg-success-light rounded-full border border-success-clarity",children:e.jsx("i",{className:`ki-filled ${s.is_read?" ki-check text-success":"ki-information-1 text-warning"}  text-lg `})}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{className:"text-2sm font-medium mb-px",children:e.jsx(v,{className:"hover:text-primary-active text-gray-900 font-semibold",href:s.url_redirect,children:s.message})}),e.jsx("span",{className:"flex items-center text-2xs font-medium text-gray-500",children:E(s.created_at)})]})]}),E=s=>{const l=new Date,c=new Date(s),r=Math.floor((l.getTime()-c.getTime())/1e3);let a=Math.floor(r/31536e3);return a>1?`${a} years ago`:(a=Math.floor(r/2592e3),a>1?`${a} months ago`:(a=Math.floor(r/86400),a>1?`${a} days ago`:(a=Math.floor(r/3600),a>1?`${a} hours ago`:(a=Math.floor(r/60),a>1?`${a} minutes ago`:`${r} seconds ago`))))};function D(){var h,u,p;const{auth:s}=y().props,{showToast:l}=w(),[c,r]=n.useState([]),[a,j]=n.useState(!1),[N,o]=n.useState(!1),m=async()=>{o(!0);try{const t=await b.get("/notifikasi"),i=t.data.data,d=t.data.data.filter(x=>!x.is_read);j(d.length!==0),r(i)}catch(t){console.error("Error fetching notifications:",t)}finally{o(!1)}},g=async t=>{o(!0);try{const i=await b.get(t);l(i.data.message),await m()}catch(i){console.error("Error marking notification as read:",i)}finally{o(!1)}};return n.useEffect(()=>{var d;const t=`App.Models.User.${(d=s==null?void 0:s.user)==null?void 0:d.id}`,i=async x=>{l(x.message.message),await m()};return window.Echo.private(t).listen("NotifikasiUsers",i),()=>{window.Echo.leave(t)}},[(h=s==null?void 0:s.user)==null?void 0:h.id]),n.useEffect(()=>{m()},[]),e.jsxs(e.Fragment,{children:[e.jsx(k,{isLoading:N}),e.jsx("header",{className:"header fixed top-0 z-10 left-0 right-0 flex items-stretch shrink-0 bg-[--tw-page-bg] dark:bg-[--tw-page-bg-dark]","data-sticky":"true","data-sticky-className":"shadow-sm","data-sticky-name":"header",id:"header",children:e.jsxs("div",{className:"container-fixed flex justify-end items-stretch lg:gap-4",id:"header_container",children:[e.jsxs("div",{className:"flex gap-1 lg:hidden items-center -ml-1",children:[e.jsx("a",{className:"shrink-0",href:"/",children:e.jsx("img",{className:"max-h-[25px] w-full",src:f})}),e.jsx("div",{className:"flex items-center",children:e.jsx("button",{className:"btn btn-icon btn-light btn-clear btn-sm","data-drawer-toggle":"#sidebar",children:e.jsx("i",{className:"ki-filled ki-menu"})})})]}),e.jsx("div",{className:"menu flex-col lg:flex-row gap-5 lg:gap-7.5 p-5 lg:p-0",children:window.location.pathname!=="/portal"&&e.jsx("div",{className:"menu-item",children:e.jsx("a",{className:"btn bg-blue-500 border px-4 py-2 my-4 border-solid border-white text-white rounded-full menu-link text-sm text-gray-700 font-medium menu-item-show:text-primary",href:"/portal",children:e.jsx("div",{className:"menu-title text-nowrap",children:"Portal"})})})}),e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3.5",children:[e.jsxs("div",{className:"dropdown","data-dropdown":"true","data-dropdown-offset":"70px, 10px","data-dropdown-placement":"bottom-end","data-dropdown-trigger":"click|lg:click",children:[e.jsxs("button",{className:"dropdown-toggle btn btn-icon btn-icon-lg relative cursor-pointer size-9 rounded-full hover:bg-primary-light hover:text-primary dropdown-open:bg-primary-light dropdown-open:text-primary text-gray-500",children:[e.jsx("i",{className:"ki-filled ki-notification-on"}),a&&e.jsx("span",{className:"badge badge-dot badge-success size-[5px] absolute top-0.5 right-0.5 transform translate-y-1/2"})]}),e.jsxs("div",{className:"dropdown-content light:border-gray-300 w-full max-w-[460px]",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2.5 text-sm text-gray-900 font-semibold px-5 py-2.5 border-b border-b-gray-200",id:"notifications_header",children:["Notifications",e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-clear shrink-0","data-dropdown-dismiss":"true",children:e.jsx("i",{className:"ki-filled ki-cross"})})]}),e.jsx("div",{className:"tabs justify-between px-5 mb-2","data-tabs":"true",id:"notifications_tabs"}),e.jsx("div",{className:"grow",id:"notifications_tab_all",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"scrollable-y-auto","data-scrollable":"true","data-scrollable-dependencies":"#header","data-scrollable-max-height":"auto","data-scrollable-offset":"200px",children:e.jsx("div",{className:"flex flex-col gap-5 pt-3 pb-4 divider-y divider-gray-200",children:c.map((t,i)=>e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex grow gap-2.5 px-5",children:_(t)},i),e.jsx("div",{className:"border-b border-b-gray-200"})]}))})}),e.jsx("div",{className:"border-b border-b-gray-200"}),e.jsxs("div",{className:"grid grid-cols-2 p-5 gap-2.5",id:"notifications_all_footer",children:[e.jsx("button",{onClick:t=>g("/notifikasi/delete"),className:"btn btn-sm btn-light justify-center",children:"Delete all"}),e.jsx("button",{onClick:t=>g("/notifikasi/read"),className:"btn btn-sm btn-light justify-center",children:"Mark all as read"})]})]})})]})]}),e.jsx("div",{className:"menu","data-menu":"true",children:e.jsxs("div",{className:"menu-item","data-menu-item-offset":"20px, 10px","data-menu-item-placement":"bottom-end","data-menu-item-toggle":"dropdown","data-menu-item-trigger":"click|lg:click",children:[e.jsx("div",{className:"menu-toggle btn btn-icon rounded-full",children:e.jsx("img",{alt:"",className:"size-10 rounded-full border-2 border-success shrink-0",src:f})}),e.jsxs("div",{className:"menu-dropdown menu-default light:border-gray-300 w-screen max-w-[250px]",children:[e.jsx("div",{className:"flex items-center justify-between px-5 py-1.5 gap-1.5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{alt:"",className:"size-9 rounded-full border-2 border-success",src:f}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-sm text-gray-800 font-semibold leading-none",children:(u=s==null?void 0:s.user)==null?void 0:u.name}),e.jsx("a",{className:"text-xs text-gray-600 hover:text-primary font-medium leading-none",href:"html/demo1/account/home/get-started.html",children:(p=s==null?void 0:s.user)==null?void 0:p.email})]})]})}),e.jsx("div",{className:"menu-separator"}),e.jsx("div",{className:"flex flex-col"}),e.jsx("div",{className:"menu-separator"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"menu-item px-4 py-1.5",children:e.jsx("a",{className:"btn btn-sm btn-light justify-center",href:"/logout",children:"Log out"})})})]})]})})]})]})})]})}export{D as default};
