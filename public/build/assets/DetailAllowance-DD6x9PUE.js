import{j as e,r as $}from"./app-Bycr8tKQ.js";import{F as m,a as h,b as j,I as u,c as g}from"./form-XnnTtyJM.js";import{B as C}from"./button-hBtzT_BA.js";import{c as v}from"./index.esm-DDhve534.js";/* empty css              */import{h as F}from"./moment-C5S46NFB.js";import{f as y}from"./rupiahCurrencyFormat-D0mkqwcl.js";import{C as D}from"./chevrons-up-down-CifDLU0o.js";import"./app-ffJwujpg.js";import"./utils-cye-aCGy.js";import"./index-CMf0X1kI.js";import"./index-DM1k6IFn.js";import"./index-Bw2ZQJPq.js";import"./index-DIbprYit.js";import"./createLucideIcon-1jYmlixx.js";function w({form:i,destinationIndex:t,allowanceField:a,type:r,btClone:p}){return e.jsx("table",{className:"w-full allowance-table",children:a.map((o,d)=>e.jsx(R,{form:i,allowance:o,destinationIndex:t,allowanceIndex:d,type:r,btClone:p}))})}function R({form:i,allowance:t,destinationIndex:a,allowanceIndex:r,type:p,btClone:o}){const[d,f]=$.useState(!1),A=s=>{f(l=>!l)},N=v({control:i.control,name:`destinations.${a}.allowances.${r}.detail.0.request_price`}),c=v({control:i.control,name:`destinations.${a}.allowances.${r}.detail`}),b=()=>{if(t.type==="total")return parseFloat(N||0)*1;{let s=0;return c==null||c.forEach(l=>{const n=parseFloat(l.request_price||0);s+=n}),s}},x=s=>l=>{const n=parseFloat(l.target.value)||0;t.request_value==="unlimited"?s.onChange(l):t.request_value==="up to max value"?n<=t.subtotal?s.onChange(l):alert(`Value cannot exceed the subtotal of IDR ${t.subtotal}`):t.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:t.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{control:i.control,name:`destinations.${a}.allowances.${r}.detail.0.request_price`,render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(u,{value:s.value,onChange:x(s)})}),e.jsx(g,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",t.detail.length," Days * ",y(t.subtotal)," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",y(b())]})})}),t.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>A(),children:e.jsxs(C,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},t.id),d&&e.jsx(e.Fragment,{children:t.detail.map((s,l)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:F(s.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(m,{control:i.control,name:`destinations.${a}.allowances.${r}.detail.${l}.request_price`,render:({field:n})=>e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(u,{value:n.value,onChange:x(n)})}),e.jsx(g,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},s.id))})]})}export{R as AllowanceRowInput,w as DetailAllowance};
