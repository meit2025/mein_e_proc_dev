import{r as E,u as $,j as e}from"./app-DNuiccyu.js";import{F as B,a as o,b as l,c as n,d as c,e as y}from"./form-BFacE67e.js";import{z as t,t as Y}from"./zod-D9eZXHnj.js";import{B as q}from"./button-D8tf04qm.js";import{u as O,b as z}from"./index.esm-BcJX4rF5.js";import{S as k}from"./scroll-area-Bn5SUfz7.js";import{S as p,a as g,b as _,c as b,d as u}from"./select-Dy9DsFSZ.js";import{I as m}from"./input-B47TkicD.js";import{a as f}from"./axiosInstance-D0MU2t6I.js";import{F as x}from"./index-BkbGbtK4.js";import{M as H}from"./MultiSelect-CDKljY3L.js";import{R as J,a as N}from"./radio-group-CmeCCIN8.js";import{u as w}from"./getDropdown-Do9UK5kC.js";import{L as K}from"./Loading-Y5sLJIQ9.js";const j="/api/master/reimburse-type",je=`${j}/`,Q=`${j}/create`,he=d=>`${j}/edit/${d}`,ue=d=>`${j}/update/${d}`,pe=`${j}/delete`;function W({onSuccess:d,type:h=x.create,listGrades:C,editURL:I,updateURL:R,id:X}){const F=t.object({code:t.string().min(1,"Code is required"),name:t.string().min(1,"Name is required"),is_employee:t.boolean(),limit:t.number().min(1,"Limit Number Must input >= 1"),material_group:t.string().min(1,"Material group required"),material_number:t.string().min(1,"Material number required"),grade_option:t.string().min(1,"Grade must be selected"),grade_all_price:t.string().optional(),grades:t.array(t.object({grade:t.string(),id:t.number(),plafon:t.string()}))}),{dataDropdown:M,getDropdown:T}=w(),{dataDropdown:D,getDropdown:V}=w(),[L,v]=E.useState(!1),P={code:"",name:"",is_employee:!0,grade_option:"all",grade_all_price:"0",grades:[]},s=O({resolver:Y(F),defaultValues:P});async function A(){try{const r=(await f.get(I)).data.data[0];s.reset({code:r.code.toString(),name:r.name.toString(),limit:r.limit.toString(),is_employee:r.is_employee.toString(),material_group:r.material_group.toString(),material_number:r.material_number.toString(),grade_option:r.grade_option.toString(),grade_all_price:r.grade_all_price.toString(),grades:r.grades})}catch{}}const{fields:G}=z({control:s.control,name:"grades"}),{showToast:S}=$(),U=async a=>{var r;v(!0);try{let i;h===x.edit?i=await f.put(R??"",a):i=await f.post(Q??"",a),d&&d(!0),S((r=i==null?void 0:i.data)==null?void 0:r.message,"success")}catch(i){d&&d(!1),S(i.message,"error")}v(!1)};return E.useEffect(()=>{T("",{name:"material_group_desc",id:"material_group",tabel:"material_groups"}),V("",{name:"material_number",id:"material_number",tabel:"master_materials"}),h===x.edit&&A()},[]),e.jsxs(k,{className:"h-[600px] w-full",children:[e.jsx(K,{isLoading:L}),e.jsx(B,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(U),children:[e.jsxs("table",{className:"text-xs mt-4 table font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(o,{control:s.control,disabled:h===x.edit,name:"code",render:({field:a})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(m,{type:"text",placeholder:"Insert code",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Name"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"name",render:({field:a})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(m,{type:"text",...a,value:a.value||"",onChange:r=>a.onChange(r.target.value)})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"For"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"is_employee",render:({field:a})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(p,{onValueChange:r=>a.onChange(r==="true"),value:a.value?"true":"false",children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(_,{placeholder:"-"})}),e.jsxs(b,{children:[e.jsx(u,{value:"true",children:"Employee"},"is_employee"),e.jsx(u,{value:"false",children:"Family"},"is_employee")]})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Limit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("td",{children:e.jsx(o,{control:s.control,disabled:h==x.edit,name:"limit",render:({field:a})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(m,{onChange:r=>a.onChange(Number(r.target.value)),value:a.value})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Grade"}),e.jsxs("td",{children:[e.jsx(o,{control:s.control,name:"grade_option",render:({field:a})=>e.jsx(l,{children:e.jsx(n,{children:e.jsxs(J,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex space-x-1",children:[e.jsxs(l,{className:"flex text-xs items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(N,{value:"all"})}),e.jsx(y,{className:"text-xs",children:"All"})]}),e.jsxs(l,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(n,{children:e.jsx(N,{value:"grade"})}),e.jsx(y,{className:"text-xs",children:"Grade"})]})]})})})}),s.getValues("grade_option")==="all"?e.jsx("div",{children:e.jsx(o,{control:s.control,name:"grade_all_price",render:({field:a})=>e.jsx(l,{children:e.jsx(n,{children:e.jsx(m,{...a})})})})}):e.jsx("div",{children:e.jsx(H,{label:"grade",id:"id",options:C,value:s.getValues("grades").map(a=>a.id),onSelect:a=>{s.setValue("grades",a.map(r=>({id:r.id,grade:r.grade,plafon:0})))}})}),s.getValues("grade_option")==="grade"?e.jsx("div",{className:"mt-4",children:e.jsx("table",{children:G.map((a,r)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["Grade ",a.grade]}),e.jsx("td",{children:":"}),e.jsx("td",{children:e.jsx("div",{children:e.jsx(o,{control:s.control,name:`grades.${r}.plafon`,render:({field:i})=>e.jsx(l,{children:e.jsx(n,{children:e.jsx(m,{...i})})})})})})]},a))})}):null]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Group"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"material_group",render:({field:a})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(p,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(_,{placeholder:"-"})}),e.jsx(b,{children:M.map(r=>e.jsx(u,{value:r.value,children:r.label},r.id))})]})}),e.jsx(c,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Material Number"}),e.jsx("td",{children:e.jsx(o,{control:s.control,name:"material_number",render:({field:a})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(p,{onValueChange:r=>a.onChange(r),value:a.value,children:[e.jsx(g,{className:"w-[200px]",children:e.jsx(_,{placeholder:"-"})}),e.jsx(b,{children:D.map(r=>e.jsx(u,{value:r.value,children:r.label},r.value))})]})}),e.jsx(c,{})]})})})]})]}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(q,{type:"submit",children:"Save"})})]})})]})}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{pe as D,he as E,je as L,W as R,ue as U,ge as f};
