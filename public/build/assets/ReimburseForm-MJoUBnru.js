import{j as e,r as D,u as ze,q as Oe}from"./app-BxXg7OWH.js";import{B as We}from"./button-BH2O7qM4.js";import{h as me}from"./moment-C5S46NFB.js";import{z as p,t as Ze}from"./index-BgHw2fOV.js";import{f as B}from"./rupiahCurrencyFormat-CP-6egij.js";import{d as Je,F as w,a as v,b as C,c as N,f as He,e as Ke}from"./form-chO2lQfC.js";import{u as Xe,b as Qe}from"./index.esm-cWnqD4_H.js";import{T as de}from"./textarea-CIiBFGqy.js";/* empty css                  */import{S as Ue}from"./scroll-area-CpDjYqng.js";import{a as T}from"./axiosInstance-DHkne9vR.js";import{S as pe}from"./separator-DYHcu8ni.js";import{T as et,a as tt,b as st,c as rt}from"./tabs-CPBWtjge.js";import{S as M,a as V,b as P,c as G,d as Y}from"./select-DgFh8gvZ.js";import{F as J}from"./formDropdown-BsHTgNpO.js";import{C as ue}from"./CustomDatePicker-OIl_ENWn.js";import{I as he}from"./input-Dc8FMEwm.js";import{ReimburseFormType as j}from"./listModel-Dw7-1eoi.js";import{u as z}from"./getDropdown-BepfNWPr.js";import{G as at,a as fe,b as nt}from"./api-DXF7erOJ.js";import{L as ot}from"./LoadingSpin-DSp9IHfB.js";import{W as it}from"./WorkflowComponent-DuJypbRd.js";import{C as lt}from"./CustomStatus-CQvh24hk.js";import{B as ct}from"./Button-CQcz7xL8.js";import"./app-DQK4SJPx.js";import"./index-D50HzkVz.js";import"./index-Bb4qSo10.js";import"./utils-CIoeVQh9.js";import"./createLucideIcon-URoT3vKD.js";import"./index-Dxcvm7A0.js";import"./index-CEy_CfZ0.js";import"./index-CXTyDg5P.js";import"./index-D_4RQDeC.js";import"./index-v_NeBFhD.js";import"./index-BeuIeQ49.js";import"./index-AR5nKuat.js";import"./index-BJ5omF_t.js";import"./index-BwE5Q-Q3.js";import"./Combination-CMwGYy5E.js";import"./index-1O7qRj8B.js";import"./TextField-CJgoFshi.js";import"./createSvgIcon-Cp_1gLXT.js";import"./DefaultPropsProvider-B9_eXHjt.js";import"./useSlot-Bc0rmCJS.js";import"./createSimplePaletteValueFilter-Ca6slGs0.js";import"./useControlled-nlckp0PW.js";import"./FormHelperText-B_Oyem8J.js";function mt({isLoading:H=!1,children:K}){return e.jsx("div",{className:"",children:H?e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-64 w-full flex justify-center items-center",children:e.jsx(ot,{})})}):K})}const is=({onSuccess:H,currencies:K,taxDefaultValue:ee,uomDefaultValue:te,categories:dt,users:pt,edit_url:ge,update_url:je,store_url:_e,type:h,currentUser:E})=>{const[xe,be]=D.useState("form1"),{showToast:q}=ze();Oe().props;const{dataDropdown:ye,getDropdown:se}=z(at),{dataDropdown:we,getDropdown:ve}=z(),{dataDropdown:Ce,getDropdown:Ne}=z(),{dataDropdown:Se,getDropdown:re}=z("api/master-pr/purchasing-group/dropdown-list"),{dataDropdown:De,getDropdown:ae}=z("api/master/cost-center/dropdown-list"),[A,ne]=D.useState([]),[Fe,X]=D.useState([]),[F,Ie]=D.useState(!1),[oe,Ee]=D.useState(!1),[Re,O]=D.useState(!1),[g,k]=D.useState([]),[L,Te]=D.useState({approvalRequest:[],approvalFrom:[],acknowledgeFrom:[],approvalFromStatusRoute:[]}),qe=1*1024*1024,ke=["image/jpeg","image/png","application/pdf","image/heic","image/heif"],$e=p.object({formCount:p.string().min(1,"total form must be have value"),remark_group:p.string().optional(),cost_center:p.string().min(1,"cost center required"),requester:p.string().min(1,"requester required"),value:p.number().optional(),user_id:p.string().optional(),forms:p.array(p.object({reimburseId:p.string().optional(),for:p.string().optional(),group:p.string().optional(),reimburse_type:p.string().min(1,"reimburse type is required"),short_text:p.string().min(1,"remarks is required"),balance:p.string(),currency:p.string().min(1,"currency required"),tax_on_sales:p.string().min(1,"tax required"),purchase_requisition_unit_of_measure:p.string().min(1,"uom required"),purchasing_group:p.string().min(1,"Purchasing Group required"),type:p.any(),item_delivery_data:p.date(),claim_date:p.date(),attachment:p.array(p.instanceof(File).refine(s=>ke.includes(s.type),{message:"File type must be JPG, JPEG, PNG, HEIC, or PDF"}).refine(s=>s.size<=qe,{message:"File size must be less than 1MB"})).min(h===j.create?1:0,"Attachment is required")}))});D.useEffect(()=>{Ne("",{name:"mwszkz",id:"id",tabel:"pajaks",where:{key:"mwszkz",parameter:"V0"}}),ve("",{name:"unit_of_measurement_text",id:"id",tabel:"uoms",where:{key:"iso_code",parameter:"PCE"}}),re("",{name:"purchasing_group_desc",id:"id",tabel:"purchasing_groups",idType:"string"}),ae("",{name:"cost_center",id:"id",tabel:"master_cost_centers",idType:"string"}),se("",{name:"name",id:"nip",tabel:"users"}),n.getValues("requester")!==""&&W(0)},[]);const Ae={formCount:"1",remark_group:"test",cost_center:"",requester:String(E==null?void 0:E.is_admin)==="1"?"":E==null?void 0:E.nip,forms:[{reimburseId:"",for:"",group:"",reimburse_type:"",short_text:"",balance:"",currency:"IDR",tax_on_sales:ee,purchase_requisition_unit_of_measure:te,purchasing_group:"",type:"",item_delivery_data:new Date,claim_date:new Date,attachment:[]}]},n=Xe({resolver:Ze($e),defaultValues:Ae}),{fields:Q,update:_}=Qe({control:n.control,name:"forms"});async function Le(){n.setValue("forms",[]),O(!0);try{const s=await T.get(ge??""),t=s.data.data.group,o=s.data.data.forms;Ie(t.reimbursementStatus);const c=o.map(a=>({reimburseId:String(a.id),for:String(a.for),group:String(a.group),reimburse_type:a.reimburse_type.code,short_text:a.short_text,balance:h===j.edit?a.balance:"",currency:a.currency,tax_on_sales:String(a.tax_on_sales),purchase_requisition_unit_of_measure:String(a.purchase_requisition_unit_of_measure),purchasing_group:String(a.purchasing_group),type:a.type,item_delivery_data:new Date(a.item_delivery_data),claim_date:new Date(a.claim_date),attachment:[]}));n.setValue("formCount",o.length.toString()),n.setValue("remark_group",t.remark),n.setValue("cost_center",String(t.cost_center.id)),n.setValue("requester",t.requester);let m=0;for(const a of o)await W(m,{reimburse_type:a.reimburse_type.code}),await ie(m,{type:a.type,reimburse_type:a.reimburse_type.code}),await U(m,{reimburse_type:a.reimburse_type.code}),m++;n.setValue("forms",c),O(!1)}catch{O(!1)}}D.useEffect(()=>{(h===j.edit||h===j.clone)&&(O(!0),Le())},[h]);const Be=async s=>{s.length>0&&se("",{name:"name",id:"nip",tabel:"users"})},W=async(s,t=null)=>{const o=await T.get(fe,{params:{user:n.getValues("requester"),hasValue:t!=null?t.reimburse_type:null},headers:{"Content-Type":"application/json"}});ne(c=>{const m=[...c];return m[s]=o.data.data,m})},Me=async(s,t)=>{if(s&&s.length>0)try{const o=await T.get(fe,{params:{search:s,user:n.getValues("requester")}});ne(c=>{const m=[...c];return m[t]=o.data.data,m})}catch(o){console.error("Error searching reimburse types:",o)}},ie=async(s,t)=>{const o=await T.get(nt,{params:{user:n.getValues("requester"),familyRelationship:t.type=="Family"?"0":"1",reimburseType:t.reimburse_type},headers:{"Content-Type":"application/json"}});X(c=>{const m=[...c];return m[s]=o.data.data,m})},Ve=s=>{for(let t=0;t<Q.length;t++)W(t);if(s==null)for(let t=0;t<Q.length;t++)n.setValue(`forms.${t}.reimburse_type`,""),n.setValue(`forms.${t}.for`,"");k([]),X([])};function Pe(s){const t=[...n.getValues("forms")];for(let o=0;o<parseInt(s);o++)if(o+1>t.length){W(o);const c={reimburseId:"",for:"",group:"",reimburse_type:"",short_text:"",balance:"",currency:"IDR",tax_on_sales:ee,purchase_requisition_unit_of_measure:te,purchasing_group:"",type:"",item_delivery_data:new Date,claim_date:new Date,attachment:[]};t.push(c)}n.setValue("forms",t)}const le=s=>{be(s)},Ge=async s=>{var o,c,m,a,r;if(g)for(let i=0;i<g.length;i++){if(s.forms.length==0||s.forms.length-1,((o=g[i])==null?void 0:o.type_limit)!=="Unlimited"&&parseInt((c=g[i])==null?void 0:c.limit)==0){q("Claim Limit for form "+(i+1)+" is Empty, Please Contact the Admin","error");return}if(s.forms[i].balance==""||parseInt(s.forms[i].balance)==0){q("Claim Balance for form "+(i+1)+" cannot be 0","error");return}if(parseInt(((m=g[i])==null?void 0:m.balance)??0)<parseInt(s.forms[i].balance??0)){q("Please check your balance input for forms "+(i+1)+"  is not must be above "+((a=g[i])==null?void 0:a.balance),"error");return}s.forms=s.forms.map(d=>({...d,claim_date:me(d.claim_date).format("YYYY-MM-DD"),item_delivery_data:me(d.item_delivery_data).format("YYYY-MM-DD")}))}const t=s.forms.reduce((i,d)=>i+parseInt(d.balance)||0,0);s.value=t,s.user_id=(s==null?void 0:s.requester)||"0";try{let i;h===j.edit?i=await T.put(je??"",s,{headers:{"Content-Type":"multipart/form-data"}}):i=await T.post(_e??"",s,{headers:{"Content-Type":"multipart/form-data"}}),q((r=i==null?void 0:i.data)==null?void 0:r.data,"success"),H()}catch{}};async function U(s,t=null){var m,a;const o=n.getValues(`forms.${s}`),c={user:n.getValues("requester"),reimbuse_type:t!=null?t.reimburse_type:o.reimburse_type};try{const r=await T.get("reimburse/data-limit-and-balance",{params:c});k(i=>{const u=n.getValues("forms").filter((y,x)=>x!==s&&y.reimburse_type===o.reimburse_type),l=u.reduce((y,x)=>y+parseInt(x.balance)||0,0),S=[...i];return S[s]={...r.data.data,balance:r.data.data.balance-l,limit:r.data.data.type_limit=="Unlimited"?r.data.data.type_limit:Math.max(0,r.data.data.limit-u.length)},S})}catch(r){q((a=(m=r==null?void 0:r.response)==null?void 0:m.data)==null?void 0:a.message,"error")}}const ce=async()=>{var s,t,o,c,m,a,r,i,d,u,l,S;try{const x=n.getValues("forms").map((f,I)=>({index:I,value:f.balance?parseInt(f.balance):0}));if(x.some(f=>f.value===0)){const f=x.findIndex(I=>I.value===0);q(`Please fill the balance for form ${f+1}`,"error");return}const b=await T.get("/check-approval",{params:{value:x==null?void 0:x[0].value,requester:n.getValues("requester"),type:"REIM"}});if(b.data.status_code===200){const f=(t=(s=b.data)==null?void 0:s.data)==null?void 0:t.approval.map(R=>(R==null?void 0:R.division_name)||null),I=(c=(o=b.data)==null?void 0:o.data)==null?void 0:c.approval.map(R=>(R==null?void 0:R.name)||null),$=[];(a=(m=b.data)==null?void 0:m.data)!=null&&a.hr&&$.push((d=(i=(r=b.data)==null?void 0:r.data)==null?void 0:i.hr)==null?void 0:d.name);const Ye=(((u=b.data.data)==null?void 0:u.approval)??[]).map(R=>({status:"",name:R.name,dateApproved:""}));Te({approvalRequest:f,approvalFrom:I,acknowledgeFrom:$,approvalFromStatusRoute:Ye}),Ee(!0)}}catch(y){q((S=(l=y==null?void 0:y.response)==null?void 0:l.data)==null?void 0:S.message,"error")}};return D.useEffect(()=>{n.getValues("forms").reduce((o,c)=>o+parseInt(c.balance)||0,0)>0&&oe===!0&&ce()},[n.watch("forms"),n.watch("requester")]),e.jsx(Ue,{className:"h-[600px] w-full",children:e.jsx(mt,{isLoading:Re,children:e.jsx(Je,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(Ge),children:[e.jsx("table",{className:"text-xs mt-4 reimburse-form-table font-thin w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Request Status"}),e.jsx("td",{children:F&&e.jsx(lt,{name:F==null?void 0:F.name,className:F==null?void 0:F.classname,code:F==null?void 0:F.code})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Remark"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:"remark_group",render:({field:s})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsx(de,{placeholder:"Insert remark",...s})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Cost Center"}),e.jsx("td",{children:e.jsx(J,{fieldLabel:"",options:De,fieldName:"cost_center",disabled:h===j.edit,placeholder:"Cost Center",classNames:"mt-2 w-full",onChangeOutside:async(s,t)=>{s.length>0&&s!==(t==null?void 0:t.value)&&ae(s,{name:"cost_center",id:"id",tabel:"master_cost_centers",idType:"string",search:s})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Employee"}),e.jsx("td",{children:e.jsx(J,{options:ye,fieldName:"requester",isRequired:!0,disabled:String(E==null?void 0:E.is_admin)==="0"||h===j.edit,placeholder:"Select Employee",onSearch:Be,onChangeOutside:s=>Ve(s),classNames:"mt-2 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Number of Forms"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:"formCount",render:({field:s})=>{var t;return e.jsxs(v,{children:[e.jsx(C,{children:e.jsxs(M,{disabled:h===j.edit,onValueChange:o=>{s.onChange(o),Pe(o),le(`form${parseInt(o)}`);const c=n.getValues("forms");if(c.length>parseInt(o)){const m=c.slice(0,parseInt(o));n.setValue("forms",m),k(a=>{let r=[...a];return r=r.slice(0,parseInt(o)),r})}},value:(t=s.value)==null?void 0:t.toString(),children:[e.jsx(V,{className:"w-[200px]",children:e.jsx(P,{placeholder:"Select number of forms"})}),e.jsx(G,{children:Array.from({length:3},(o,c)=>c+1).map(o=>e.jsx(Y,{value:o.toString(),children:o},o))})]})}),e.jsx(N,{})]})}})})]})]})}),e.jsx(pe,{className:"my-4"}),e.jsxs(et,{value:xe,onValueChange:le,className:"w-full",children:[e.jsxs(tt,{className:"flex items-center justify-start space-x-4",children:[" ",Array.from({length:n.watch("formCount")||1}).map((s,t)=>e.jsxs(st,{value:`form${t+1}`,children:["Form ",t+1]},t))]}),Q.map((s,t)=>{var o,c,m;return e.jsxs(rt,{value:`form${t+1}`,children:[e.jsx(w,{control:n.control,name:`forms.${t}.reimburseId`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsx(he,{className:"sr-only",value:s.reimburseId,onChange:a.onChange})}),e.jsx(N,{})]})}),e.jsx("div",{children:e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Type of Reimbursement "}),e.jsx("td",{className:"flex items-center space-x-3",children:e.jsx(J,{options:A[t],fieldName:`forms.${t}.reimburse_type`,isRequired:!0,disabled:n.getValues("requester")==""||h===j.edit,placeholder:"Select Reimburse Type",onChangeOutside:(a,r)=>{const i=n.getValues("requester");if(a!==(r==null?void 0:r.value)&&i!==""&&Me(a,t),r!=null&&r.value){let d=A[t].filter(u=>u.value==r.value)[0];_(t,{...s,reimburse_type:r==null?void 0:r.value,type:d.is_employee===1?"Employee":"Family"}),d.is_employee===1?U(t):(k(u=>{const l=[...u];return l[t]=[],l}),n.setValue(`forms.${t}.balance`,""),ie(t,{type:"Family",reimburse_type:r==null?void 0:r.value}))}else{k(u=>{const l=[...u];return l[t]=[],l}),_(t,{...s,balance:""}),n.setValue(`forms.${t}.for`,""),X(u=>{const l=[...u];return l[t]=[],l});const d=n.getValues("forms");d.forEach((u,l)=>{var S,y;if(l>t&&d[l].reimburse_type===s.reimburse_type){const x=((S=g[l])==null?void 0:S.balance)||0,Z=((y=g[l])==null?void 0:y.limit)||0;k(b=>{var I;const f=[...b];return f[l]={...f[l],balance:x+parseInt(s.balance||"0")},((I=g[l])==null?void 0:I.type_limit)!=="Unlimited"&&(f[l]={...f[l],limit:Z+1}),f}),n.setValue(`forms.${l}.balance`,"")}})}},classNames:"mt-2 w-full"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Family"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:`forms.${t}.for`,render:({field:a})=>{var r,i,d,u;return e.jsxs(v,{children:[e.jsx(C,{children:e.jsxs(M,{disabled:((d=(i=(r=A==null?void 0:A[t])==null?void 0:r.filter(l=>(l==null?void 0:l.value)==n.getValues(`forms.${t}.reimburse_type`)))==null?void 0:i[0])==null?void 0:d.is_employee)===1||h===j.edit,onValueChange:l=>{_(t,{...s,for:l}),U(t,{reimburse_type:n.getValues(`forms.${t}.reimburse_type`)})},defaultValue:s==null?void 0:s.for,value:s.for,children:[e.jsx(V,{className:"w-[200px]",children:e.jsx(P,{placeholder:"-"})}),e.jsx(G,{children:(u=Fe[t])==null?void 0:u.map(l=>e.jsx(Y,{value:l.value.toString(),children:l.label},l.value))})]})}),e.jsx(N,{})]})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Purchasing Group"}),e.jsx("td",{children:e.jsx(J,{fieldLabel:"",options:Se,fieldName:`forms.${t}.purchasing_group`,disabled:h===j.edit,placeholder:"Puchasing Group",classNames:"mt-2 w-full",onChangeOutside:async(a,r)=>{a.length>0&&a!==(r==null?void 0:r.value)&&await re(a,{name:"purchasing_group_desc",id:"id",tabel:"purchasing_groups",idType:"string",search:a}),r!=null&&r.value&&_(t,{...s,purchasing_group:r==null?void 0:r.value})}})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Tax"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:`forms.${t}.tax_on_sales`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsxs(M,{disabled:!0,onValueChange:r=>{_(t,{...s,tax_on_sales:r})},defaultValue:s.tax_on_sales,children:[e.jsx(V,{className:"w-[200px]",children:e.jsx(P,{placeholder:"-"})}),e.jsx(G,{children:(Ce??[]).map((r,i)=>e.jsxs(Y,{value:r.value.toString(),children:[r.description," - ",r.label]},r.value))})]})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Uom"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:`forms.${t}.purchase_requisition_unit_of_measure`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsxs(M,{disabled:!0,onValueChange:r=>{_(t,{...s,purchase_requisition_unit_of_measure:String(r)})},defaultValue:s.purchase_requisition_unit_of_measure,children:[e.jsx(V,{className:"w-[200px]",children:e.jsx(P,{placeholder:"-"})}),e.jsx(G,{children:(we??[]).map((r,i)=>e.jsx(Y,{value:r.value.toString(),children:`${r.label} - ${r.iso_code}`},r.value))})]})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Remark"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:`forms.${t}.short_text`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsx(de,{placeholder:"Insert remark",onChange:r=>{_(t,{...s,short_text:r.target.value})},defaultValue:s.short_text})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Current Balance"}),e.jsx("td",{children:e.jsx("span",{className:"font-bold",children:((o=g[t])==null?void 0:o.balance)&&B((c=g[t])==null?void 0:c.balance)})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Limit Claim"}),e.jsxs("td",{children:[e.jsx("span",{className:"font-bold",children:(m=g[t])==null?void 0:m.limit})," "]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Receipt Date"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:`forms.${t}.item_delivery_data`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsx(ue,{disabled:h===j.edit,initialDate:a.value instanceof Date?a.value:new Date(a.value),onDateChange:r=>{a.onChange(r),_(t,{...s,item_delivery_data:r})}})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Claim Date"}),e.jsx("td",{children:e.jsx(w,{control:n.control,name:`forms.${t}.claim_date`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsx(ue,{disabled:h===j.edit,initialDate:a.value instanceof Date?a.value:new Date(a.value),onDateChange:r=>{a.onChange(r),_(t,{...s,claim_date:r})}})}),e.jsx(N,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"Reimburse Cost"}),e.jsxs("td",{className:"w-full grid grid-cols-7 gap-x-4",children:[e.jsx("div",{className:"col-span-3",children:e.jsx(w,{control:n.control,name:`forms.${t}.currency`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(C,{children:e.jsxs(M,{disabled:h===j.edit,onValueChange:r=>{_(t,{...s,currency:r})},defaultValue:s.currency,children:[e.jsx(V,{className:"w-[200px]",children:e.jsx(P,{placeholder:"-"})}),e.jsx(G,{children:K.map(r=>e.jsxs(Y,{value:r.code,children:[r.name," (",r.code,")"]},r.code))})]})}),e.jsx(He,{className:"h-6"}),e.jsx(N,{})]})})}),e.jsx("div",{className:"col-span-4",children:e.jsx(w,{control:n.control,name:`forms.${t}.balance`,render:({field:a})=>{var r;return e.jsxs(v,{children:[e.jsx(C,{children:e.jsx(he,{type:"text",placeholder:"0",onChange:i=>{var x;const d=i.target.value.replace(/[^0-9]/g,""),u=B(d,!1),l=parseInt(d)||0,S=((x=g[t])==null?void 0:x.balance)||0;if(l>S){i.target.value=B(d.slice(0,-1),!1);return}_(t,{...s,balance:d}),i.target.value=u,n.getValues("forms").forEach((Z,b)=>{if(b>t&&Z.reimburse_type===s.reimburse_type){const f=S-l;k(I=>{const $=[...I];return $[b]={...$[b],balance:f},$}),_(b,{...s,balance:""})}})},defaultValue:B(s.balance,!1),value:B(s.balance,!1),disabled:typeof g[t]>"u"||((r=g[t])==null?void 0:r.length)===0||h===j.edit})}),e.jsx(N,{})]})}})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4",children:"File Attachment"}),e.jsxs("td",{children:[e.jsx(w,{control:n.control,name:`forms.${t}.attachment`,render:({field:a})=>e.jsxs(v,{children:[e.jsx(Ke,{className:"text-xs text-gray-500 font-extralight mb-1",children:"Max File: 1000KB, Extension : jpg,jpeg,png,pdf,heic"}),e.jsx(C,{children:e.jsx("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-xs shadow-sm transition-colors file:border-0 file:bg-transparent file:text-xs file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",type:"file",multiple:!0,accept:"image/*,.pdf,.heic",onChange:r=>{const i=r.target.files;if(i){const d=[...s.attachment],u=Array.from(i);d.push(...u),_(t,{...s,attachment:d})}}})}),e.jsx(N,{})]})}),e.jsx("div",{className:"mt-2",children:s.attachment&&s.attachment.length>0&&e.jsx("ul",{children:s.attachment.map((a,r)=>e.jsxs("li",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:a.name}),e.jsx("button",{type:"button",className:"text-red-500 ml-2",onClick:()=>{const i=s.attachment.filter((d,u)=>u!==r);_(t,{...s,attachment:i})},children:"Delete"})]},r))})})]})]})]})})})]},t)})]}),e.jsx(ct,{onClick:async()=>await ce(),variant:"contained",color:"primary",type:"button",children:"Check Approval"}),e.jsx("div",{className:"my-2",children:oe&&e.jsx(it,{workflowApproval:{approvalRequest:L.approvalRequest,approvalFrom:L.approvalFrom,acknowledgeFrom:L.acknowledgeFrom},workflowApprovalStep:L.approvalFromStatusRoute,workflowApprovalDiagram:L.approvalFrom})}),e.jsx(pe,{className:"my-4"}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(We,{type:"submit",className:"w-32",children:"Save"})})]})})})})};export{is as ReimburseForm};
