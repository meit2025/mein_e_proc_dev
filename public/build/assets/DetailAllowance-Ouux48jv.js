import{j as e,r as b}from"./app-D29rfeOn.js";import{F as m,a as h,b as u,c as j}from"./form-bmKmrvt5.js";import{B as F}from"./button-DjRXmiG1.js";import{c as g}from"./index.esm-CpkvjiPo.js";/* empty css              */import{I as v}from"./input-BOk0TzHt.js";import{h as C}from"./moment-C5S46NFB.js";import{f}from"./rupiahCurrencyFormat-CnMdu_8N.js";import{C as q}from"./chevrons-up-down-Da-nfAsB.js";import"./app-HlhieNAw.js";import"./index-B_eBcZZD.js";import"./utils-eSIEr-wj.js";import"./index-Bb4qSo10.js";import"./createLucideIcon-CF_GU2c3.js";function W({form:a,destinationIndex:s,allowanceField:i,type:r,btEdit:d}){return e.jsx("table",{className:"w-full allowance-table",children:i.map((c,p)=>e.jsx(D,{form:a,allowance:c,destinationIndex:s,allowanceIndex:p,type:r,btEdit:d}))})}function D({form:a,allowance:s,destinationIndex:i,allowanceIndex:r,type:d,btEdit:c}){const[p,y]=b.useState(!1),$=t=>{y(l=>!l)},A=g({control:a.control,name:`destinations.${i}.allowances.${r}.detail.0.request_price`}),o=g({control:a.control,name:`destinations.${i}.allowances.${r}.detail`}),N=()=>{if(s.type==="total")return parseFloat(A||0)*1;{let t=0;return o==null||o.forEach(l=>{const n=parseFloat(l.request_price||0);t+=n}),t}},x=t=>l=>{const n=parseFloat(l.target.value)||0;s.request_value==="unlimited"?t.onChange(l):s.request_value==="up to max value"?n<=s.subtotal?t.onChange(l):alert(`Value cannot exceed the subtotal of IDR ${s.subtotal}`):s.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:s.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:s.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:s.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{control:a.control,name:`destinations.${i}.allowances.${r}.detail.0.request_price`,render:({field:t})=>e.jsxs(h,{children:[e.jsx(u,{children:e.jsx(v,{value:t.value,disabled:d==c?!!a.watch(`destinations.${i}.allowances.${r}.detail.0.request_price`):!1,onChange:x(t)})}),e.jsx(j,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",s.detail.length," Days * ",f(s.subtotal)," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",f(N())]})})}),s.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>$(),children:e.jsxs(F,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},s.id),p&&e.jsx(e.Fragment,{children:s.detail.map((t,l)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:C(t.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(m,{control:a.control,name:`destinations.${i}.allowances.${r}.detail.${l}.request_price`,render:({field:n})=>e.jsxs(h,{children:[e.jsx(u,{children:e.jsx(v,{value:n.value,disabled:d==c?!!a.watch(`destinations.${i}.allowances.${r}.detail.${l}.request_price`):!1,onChange:x(n)})}),e.jsx(j,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},t.id))})]})}export{D as AllowanceRowInput,W as DetailAllowance};
