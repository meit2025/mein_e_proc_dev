import{j as e,r as D,u as te,b as se}from"./app-D7tOFeiK.js";import{F as ae,a as g,b as f,c as b,d as v,e as ne}from"./form-YgE4QZVI.js";import{z as l,t as re}from"./index-CJ4IMaHL.js";import{d as Z}from"./index-DPp1w75L.js";import{B as Q}from"./button-BzfhGyPk.js";import{a as le,C as ie,u as ce,b as X,c as P}from"./index.esm-Bj2-3Pon.js";import{T as oe}from"./textarea-XJo4JjTM.js";/* empty css              */import{S as de}from"./scroll-area-DmkIGlQm.js";import{S as he}from"./separator--qXwSJjB.js";import{T as pe,a as xe,b as ue,c as je}from"./tabs-DflSMJJJ.js";import{h as N}from"./moment-C5S46NFB.js";import{S as Y,a as F,b as q,c as V,d as $}from"./select-DLRybY4K.js";import{C as ee}from"./CustomDatePicker-CnVPI_xP.js";import{I as T}from"./input-B01Y93lo.js";import{G as me}from"./api-BEQetkWJ.js";import{a as _e}from"./axiosInstance-ByL1Qtcd.js";import{BusinessTripType as O}from"./models-Bi0O9Kr-.js";import{C as ge,E as fe,b as be}from"./api-B9TTe-Ow.js";import{S as ve}from"./Switch-DXqVblNH.js";import{F as we}from"./FormHelperText-DHTc-4Hw.js";import{C as ye}from"./chevrons-up-down-DDFEc2bR.js";import"./app-HlhieNAw.js";import"./index-CKLjn7lJ.js";import"./utils-Ci_pVK7b.js";import"./index-BQUP8U2k.js";import"./index-qBVc6WCx.js";import"./index-DgTflWDd.js";import"./index-Csdh3Mh4.js";import"./index-DaQaxukN.js";import"./index-CQXlmT_x.js";import"./Combination-CqVDp1AZ.js";import"./index-CBvyvxOt.js";import"./popover-CGF0kln9.js";import"./createLucideIcon-BeihAPjx.js";import"./CustomStatus-BSKEwVhL.js";import"./createSimplePaletteValueFilter-vcrYcaT7.js";import"./extends-CF3RwP-h.js";import"./SwitchBase-D7Q05fI7.js";const Ce=({fieldLabel:s,fieldName:t,isRequired:i=!1,disabled:m=!1,style:w,requiredMessage:x,classNames:u,defaultChecked:n=!1,note:h,onChanges:y})=>{var S;const{control:C,formState:{errors:_}}=le();return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[s&&e.jsxs("label",{className:"form-label max-w-32",children:[s," ",e.jsxs("span",{className:"text-red-700",children:[" ",i?"*":""]})]}),e.jsx(ie,{name:t,control:C,rules:{required:i?x??`${s} is required`:!1},render:({field:o})=>e.jsx("div",{style:w,className:u,children:e.jsx(ve,{...o,checked:!!(o.value??n),onChange:E=>{o.onChange(E),y&&y(E)},disabled:m})})}),e.jsx("span",{children:h})]}),e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label max-w-32",children:""}),_[t]&&e.jsx(we,{error:!0,children:String((S=_[t])==null?void 0:S.message)})]})]})};l.object({remark:l.string().min(1).max(50),reimburse_cost:l.number()});const _t=({users:s,listPurposeType:t,pajak:i,costcenter:m,purchasingGroup:w,type:x,id:u,isAdmin:n,idUser:h,listDestination:y=[]})=>{const C=l.object({purpose_type_id:l.string().min(1,"Purpose type required"),request_for:l.string().min(1,"Request is required"),cost_center_id:l.string().min(1,"Cost Center is required"),remark:l.string().min(1,"Remark is required"),attachment:l.instanceof(File).nullable().optional(),total_destination:l.number().min(1,"Total Destinantion Required"),destinations:l.array(l.object({destination:l.string().min(1,"Destinantion is Required"),pajak_id:l.string().min(1,"Pajak is required"),purchasing_group_id:l.string().min(1,"Purchasing Group is required"),cash_advance:l.boolean().nullable().optional(),reference_number:l.string().nullable().optional(),total_percent:l.string().nullable().optional(),total_cash_advance:l.string().nullable().optional(),business_trip_start_date:l.date().optional(),business_trip_end_date:l.date().optional(),detail_attedances:l.array(l.object({date:l.date().optional(),shift_code:l.string().optional(),shift_start:l.string().optional(),shift_end:l.string().optional(),start_time:l.string().optional(),end_time:l.string().optional()})),allowances:l.array(l.object({name:l.string().optional(),code:l.string().optional(),default_price:l.number().optional(),type:l.string().optional(),subtotal:l.number().optional(),currency:l.string().optional(),detail:l.array(l.object({date:l.date().nullish(),request_price:l.any().optional()}))}))}))}),[_,S]=D.useState("1");console.log("list destiantion",y);const o=ce({resolver:re(C),defaultValues:{purpose_type_id:"",request_for:"",cost_center_id:"",remark:"",attachment:null,total_destination:1,destinations:[{detail_attedances:[],allowances:[],destination:"",pajak_id:"",purchasing_group_id:"",cash_advance:!1,reference_number:"",total_percent:"",total_cash_advance:"0",business_trip_start_date:new Date,business_trip_end_date:new Date}]}});async function E(){const c=be(u);o.setValue("destinations",[]);try{const r=(await se.get(c)).data.data;console.log(r," Response Detailxxxx"),o.setValue("purpose_type_id",r.purpose_type_id),o.setValue("request_for",r.request_for.id),o.setValue("cost_center_id",r.cost_center_id),o.setValue("remark",r.remarks),o.setValue("total_destination",r.total_destination),console.log(r.destinations," data.destinations"),o.setValue("destinations",r.destinations.map(j=>({destination:j.destination,pajak_id:j.pajak_id,purchasing_group_id:j.purchasing_group_id,cash_advance:j.cash_advance,reference_number:j.reference_number,total_percent:j.total_percent,total_cash_advance:j.total_cash_advance,business_trip_start_date:new Date(j.business_trip_start_date),business_trip_end_date:new Date(j.business_trip_end_date),detail_attedances:j.detail_attedances,allowances:j.allowances})))}catch{}}const[L,z]=D.useState([]),[U,H]=D.useState(n==="0"?h.toString():"");async function W(c){o.setValue("purpose_type_id",c||"");const a=n=="0"?h||"":U||"";console.log(a," ---- ");const r=me(c,a);try{const j=await _e.get(r);z(j.data.data)}catch(j){console.log(j)}}const R=c=>{o.setValue("total_destination",parseInt(c,10)),S(c),B()},{showToast:k}=te(),M=async c=>{try{const a=new FormData;a.append("purpose_type_id",c.purpose_type_id??""),a.append("request_for",c.request_for??""),a.append("cost_center_id",c.cost_center_id??""),a.append("remark",c.remark??""),a.append("attachment",c.attachment??""),a.append("total_destination",`${c.total_destination}`),c.destinations.forEach((r,j)=>{const G={...r,business_trip_start_date:N(r.business_trip_start_date).format("YYYY-MM-DD"),business_trip_end_date:N(r.business_trip_end_date).format("YYYY-MM-DD"),detail_attedances:r.detail_attedances.map(A=>({...A,date:N(A.date).format("YYYY-MM-DD")})),allowances:r.allowances.map(A=>({...A,detail:A.detail.map(I=>({...I,date:(I==null?void 0:I.date)!=null?N(I.date).format("YYYY-MM-DD"):null}))}))};a.append(`destinations[${j}]`,JSON.stringify(G))}),console.log(a," test"),x==O.create?(await Z.Inertia.post(ge,a,{headers:{"Content-Type":"multipart/form-data"}}),k("succesfully created data","success")):(await Z.Inertia.put(`${fe}/${u}`,a,{headers:{"Content-Type":"multipart/form-data"}}),k("succesfully updated data","success"))}catch(a){console.log(a)}};function B(){const c=[],a=parseInt(_);for(let r=0;r<a;r++)c.push({destination:"",business_trip_start_date:new Date,business_trip_end_date:new Date,pajak_id:"",purchasing_group_id:"",cash_advance:!1,total_percent:"",total_cash_advance:"0",allowances:[],detail_attedances:[]});o.setValue("destinations",c)}const{fields:J,append:K,remove:p,update:d}=X({control:o.control,name:"destinations"});return D.useEffect(()=>{u&&x==O.edit&&E()},[]),D.useEffect(()=>{x==O.create&&B()},[_,L,u,x,n,h]),e.jsx(de,{className:"h-[600px] w-full ",children:e.jsx(ae,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(M),children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-table font-thin",children:[e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request No."}),e.jsx("td",{children:"ODR-YYYY-MM-XXXXXXXX"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Request For"}),e.jsx("td",{children:e.jsx(g,{control:o.control,name:"request_for",render:({field:c})=>(n==="0"&&!c.value&&c.onChange(h.toString()),e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{onValueChange:a=>{H(a),c.onChange(a)},value:c.value,disabled:n==="0",children:[e.jsx(F,{className:"w-[200px] py-2",children:e.jsx(q,{placeholder:"-- Select Business Purpose Type --"})}),e.jsx(V,{children:n==="1"?s.map(a=>e.jsx($,{value:a.id.toString(),children:a.name},a.id)):s.filter(a=>a.id===h).map(a=>e.jsx($,{value:a.id.toString(),children:a.name},a.id))})]})}),e.jsx(v,{})]}))})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussiness Trip Purpose Type"}),e.jsxs("td",{children:[" ",e.jsx(g,{control:o.control,name:"purpose_type_id",render:({field:c})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{onValueChange:a=>W(a),value:c.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Bussiness Purpose Type --"})}),e.jsx(V,{children:t.map(a=>e.jsx($,{value:a.id.toString(),children:a.name}))})]})}),e.jsx(v,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Cost Center"}),e.jsxs("td",{children:[" ",e.jsx(g,{control:o.control,name:"cost_center_id",render:({field:c})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{onValueChange:a=>c.onChange(a),value:c.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Cost Center --"})}),e.jsx(V,{children:m.map(a=>e.jsx($,{value:a.id.toString(),children:a.cost_center}))})]})}),e.jsx(v,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Remark"}),e.jsx("td",{children:e.jsx(g,{control:o.control,name:"remark",render:({field:c})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(oe,{placeholder:"Insert remark",...c,rows:4,className:"w-[300px]"})}),e.jsx(v,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Attachment"}),e.jsx("td",{children:e.jsx(g,{control:o.control,name:"attachment",render:({field:c})=>e.jsxs(f,{children:[e.jsx(ne,{className:"text-xs text-gray-500 font-extralight mb-1",children:"Max File: 1000KB"}),e.jsx(b,{children:e.jsx("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-xs shadow-sm transition-colors file:border-0 file:bg-transparent file:text-xs file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",type:"file",onChange:a=>{var j;const r=(j=a.target.files)==null?void 0:j[0];r?c.onChange(r):c.onChange(null)}})}),e.jsx(v,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"File Extension"}),e.jsx("td",{className:"text-gray-500 text-xs font-extralight",children:"doc,jpg,ods,png,txt,pdf"})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Total Destination"}),e.jsxs("td",{children:[" ",e.jsx(g,{control:o.control,name:"total_destination",render:({field:c})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{value:c.value.toString(),onValueChange:R,children:[e.jsx(F,{className:"w-[200px] py-2",children:e.jsx(q,{placeholder:"-- Select Bussiness Trip --"})}),e.jsx(V,{children:Array.from({length:5},(a,r)=>e.jsxs($,{value:(r+1).toString(),children:[" ",r+1," "]}))})]})}),e.jsx(v,{})]})})]})]})]}),e.jsx(he,{className:"my-4"}),e.jsx(Se,{updateDestination:d,destinationField:J,listDestination:y,form:o,listAllowances:L,totalDestination:o.getValues("total_destination").toString(),pajak:i,purchasingGroup:w,typeEdit:x}),e.jsx(Q,{type:"submit",children:"submit"})]})})})};function Se({totalDestination:s,listAllowances:t,destinationField:i,form:m,updateDestination:w,listDestination:x=[],pajak:u,purchasingGroup:n,typeEdit:h}){return D.useState(),D.useState(),D.useState(0),e.jsxs(pe,{defaultValue:"destination1",className:"w-full",children:[e.jsx(xe,{className:"flex items-center justify-start space-x-4",children:i.map((y,C)=>e.jsxs(ue,{value:`destination${C+1}`,children:["Destination ",C+1]}))}),i.map((y,C)=>e.jsx(De,{listAllowances:t,updateDestination:w,destination:y,form:m,index:C,listDestination:x,pajak:u,purchasingGroup:n,typeEdit:h}))]})}function De({form:s,index:t,destination:i,updateDestination:m,listAllowances:w,listDestination:x,pajak:u,purchasingGroup:n,typeEdit:h}){const{fields:y,update:C,append:_,remove:S}=X({control:s.control,name:`destinations.${t}.detail_attedances`}),{fields:o,update:E,append:L,remove:z,replace:U}=X({control:s.control,name:`destinations.${t}.allowances`});function H(){let p=N(i.business_trip_start_date).startOf("day");const d=N(i.business_trip_end_date).startOf("day");for(S(),z();p.isBefore(d)||p.isSame(d);){const r={date:p.toDate(),shift_code:"SHIFTREGULAR",shift_start:"08:00",shift_end:"17:00",end_time:"17:00",start_time:"08:00"};_(r),p=p.add(1,"days")}function c(r){let j=N(i.business_trip_start_date).startOf("day");const G=N(i.business_trip_end_date).startOf("day"),A=[];for(;j.isBefore(G)||j.isSame(G);)A.push({date:j.toDate(),request_price:r}),j=j.add(1,"days");return A}const a=w.map(r=>({name:r.name,code:r.code,default_price:parseInt(r.grade_price),type:r.type,subtotal:parseInt(r.grade_price),currency:r.currency_id,request_value:r.request_value,detail:r.type.toLowerCase()=="total"?[{date:null,request_price:parseInt(r.grade_price)}]:c(r.grade_price)}));U(a)}const[W,R]=D.useState(!1),k=p=>{R(p)},M=P({control:s.control,name:`destinations.${t}.total_percent`}),[B,J]=D.useState(0),K=B;return D.useEffect(()=>{h==O.edit&&R(s.getValues(`destinations.${t}.cash_advance`));const d=parseFloat((M||"0").toString())/100*K;s.setValue(`destinations.${t}.total_cash_advance`,d.toFixed(0))},[M,K]),e.jsxs(je,{value:`destination${t+1}`,children:[e.jsxs("div",{children:[e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsxs("tr",{children:[e.jsxs("td",{width:200,children:["Destination ",i.destination]}),e.jsx("td",{children:e.jsx(g,{control:s.control,name:`destinations.${t}.destination`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{onValueChange:d=>{m(t,{...i,destination:d})},defaultValue:i.destination,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"Destination"})}),e.jsx(V,{children:x.map(d=>e.jsx($,{value:d.destination,className:"uppercase",children:d.destination}))})]})}),e.jsx(v,{})]})})})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Pajak"}),e.jsxs("td",{children:[" ",e.jsx(g,{control:s.control,name:`destinations.${t}.pajak_id`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{onValueChange:d=>p.onChange(d),value:p.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Pajak --"})}),e.jsx(V,{children:u.map(d=>e.jsx($,{value:d.id,children:d.mwszkz}))})]})}),e.jsx(v,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Purchasing Group"}),e.jsxs("td",{children:[" ",e.jsx(g,{control:s.control,name:`destinations.${t}.purchasing_group_id`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{onValueChange:d=>p.onChange(d),value:p.value,children:[e.jsx(F,{className:"w-[200px]",children:e.jsx(q,{placeholder:"-- Select Purchasing Group --"})}),e.jsx(V,{children:n.map(d=>e.jsx($,{value:d.id,children:d.purchasing_group}))})]})}),e.jsx(v,{})]})})]})]}),e.jsxs("tr",{children:[e.jsx("td",{width:200,children:"Bussines Trip Date"}),e.jsxs("td",{className:"flex space-x-2 items-center",children:[e.jsx(g,{control:s.control,name:`destinations.${t}.business_trip_start_date`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(ee,{initialDate:i.business_trip_start_date,onDateChange:d=>{m(t,{...i,business_trip_start_date:d})}})}),e.jsx(v,{})]})}),e.jsx("span",{children:"To"}),e.jsx(g,{control:s.control,name:`destinations.${t}.business_trip_end_date`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(ee,{initialDate:i.business_trip_end_date,onDateChange:d=>{console.log("end date",d),m(t,{...i,business_trip_end_date:d})}})}),e.jsx(v,{})]})}),e.jsx(Q,{type:"button",onClick:()=>H(),children:"Get Detail"})]})]})]}),e.jsx(Te,{detailAttedanceFields:y,form:s,updateAttedanceFields:C,destinationIndex:t}),e.jsx("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm",children:"Detail Bussines Trip Allowance:"}),e.jsx("td",{})]})}),e.jsx(Ae,{allowanceField:o,destinationIndex:t,form:s})]},t),e.jsx(Ne,{allowanceField:o,destinationIndex:t,form:s,setTotalAllowance:J}),e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Cash Advance"}),e.jsx("td",{className:"w-[50%] pb-0",children:e.jsx(Ce,{fieldName:`destinations.${t}.cash_advance`,isRequired:!1,disabled:!1,onChanges:p=>k(p.target.checked)})})]}),W&&e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"w-[50%]",children:"Total Percent"}),e.jsxs("td",{className:"w-[50%]",children:[e.jsx(g,{control:s.control,name:`destinations.${t}.reference_number`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{value:p.value||"",onChange:d=>p.onChange(d.target.value),className:"w-[50%] mb-2",placeholder:"Reference Number"})}),e.jsx(v,{})]})}),e.jsx(g,{control:s.control,name:`destinations.${t}.total_percent`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(Y,{value:p.value||void 0,onValueChange:d=>p.onChange(d),children:[e.jsx(F,{className:"w-[50%] mb-2",children:e.jsx(q,{placeholder:"-- Select Total Percent --"})}),e.jsxs(V,{children:[e.jsx($,{value:"10",children:"10%"}),e.jsx($,{value:"25",children:"25%"}),e.jsx($,{value:"50",children:"50%"})]})]})}),e.jsx(v,{})]})}),e.jsx(g,{control:s.control,name:`destinations.${t}.total_cash_advance`,render:({field:p})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{value:p.value||"",readOnly:!0,className:"w-[50%]"})}),e.jsx(v,{})]})})]})]})})]})]})}function Ne({allowanceField:s,destinationIndex:t,form:i,setTotalAllowance:m}){const[w,x]=D.useState(0);D.useEffect(()=>{const n=s.reduce((h,y,C)=>{const _=i.getValues(`destinations.${t}.allowances.${C}.detail`),S=u(y,_);return h+S},0);x(n),m(n)},[s,i.watch()]);const u=(n,h)=>{var y;return n.type==="total"?parseFloat(((y=h==null?void 0:h[0])==null?void 0:y.request_price)||0):h==null?void 0:h.reduce((C,_)=>C+parseFloat(_.request_price||0),0)};return e.jsx(e.Fragment,{children:e.jsxs("table",{className:"w-full text-sm mt-10",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-[50%]",children:"Item"}),e.jsx("th",{className:"w-[50%]",children:"Sub Total"})]})}),e.jsx("tbody",{children:s.map((n,h)=>e.jsx($e,{allowance:n,destinationIndex:t,form:i,allowanceIndex:h}))}),e.jsx("tfoot",{className:"mt-4",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{children:e.jsx("i",{children:"Total Allowance"})}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:e.jsx("i",{children:"IDR"})}),e.jsx("span",{children:e.jsx("i",{children:w})})]})]})})]})})}function $e({allowance:s,destinationIndex:t,form:i,allowanceIndex:m}){const w=P({control:i.control,name:`destinations.${t}.allowances.${m}.detail.0.request_price`}),x=P({control:i.control,name:`destinations.${t}.allowances.${m}.detail`}),u=()=>{if(s.type==="total")return parseFloat(w||0)*1;{let n=0;return x==null||x.forEach(h=>{const y=parseFloat(h.request_price||0);n+=y}),n}};return e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsxs("td",{className:"flex justify-between pr-4",children:[e.jsx("span",{children:"IDR"}),e.jsx("span",{children:u()})]})]},s.id)}function Te({form:s,destinationIndex:t,detailAttedanceFields:i,updateAttedanceFields:m}){const w=s.watch(`destinations.${t}.detail_attedances`);return D.useEffect(()=>{},[w]),D.useEffect(()=>{},[i]),e.jsxs("table",{className:"text-xs mt-4 reimburse-form-detail font-thin",children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsx("div",{className:"mb-4 text-sm",children:"Detail Attedance: "})})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("table",{className:"detail-attedance text-xs",children:[e.jsxs("thead",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Shift code"}),e.jsx("th",{children:"Shift Start"}),e.jsx("th",{children:"Shift End"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"})]}),e.jsx("tbody",{children:i.map((x,u)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[N(x.date).format("DD/MM/YYYY"),e.jsx(g,{control:s.control,name:`destinations.${t}.detail_attedances.${u}.date`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{defaultValue:N(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(v,{})]})})]}),e.jsxs("td",{children:[x.shift_code,e.jsx(g,{control:s.control,name:`destinations.${t}.detail_attedances.${u}.shift_code`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{defaultValue:N(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(v,{})]})})]}),e.jsxs("td",{children:[x.shift_start,e.jsx(g,{control:s.control,name:`destinations.${t}.detail_attedances.${u}.shift_start`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{defaultValue:N(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(v,{})]})})]}),e.jsxs("td",{children:[x.shift_end,e.jsx(g,{control:s.control,name:`destinations.${t}.detail_attedances.${u}.shift_end`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{defaultValue:N(n.value).format("YYYY-MM-DD"),onChange:n.onChange,type:"hidden"})}),e.jsx(v,{})]})})]}),e.jsx("td",{children:e.jsx(g,{control:s.control,name:`destinations.${t}.detail_attedances.${u}.start_time`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(v,{})]})})}),e.jsx("td",{children:e.jsx(g,{control:s.control,name:`destinations.${t}.detail_attedances.${u}.end_time`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{defaultValue:n.value,onChange:n.onChange})}),e.jsx(v,{})]})})})]},x.index))})]})})})]})}function Ae({form:s,destinationIndex:t,allowanceField:i}){return e.jsx("table",{className:"w-full allowance-table",children:i.map((m,w)=>e.jsx(Ye,{form:s,allowance:m,destinationIndex:t,allowanceIndex:w}))})}function Ye({form:s,allowance:t,destinationIndex:i,allowanceIndex:m}){const[w,x]=D.useState(!1),u=_=>{x(S=>!S)},n=P({control:s.control,name:`destinations.${i}.allowances.${m}.detail.0.request_price`}),h=P({control:s.control,name:`destinations.${i}.allowances.${m}.detail`}),y=()=>{if(t.type==="total")return parseFloat(n||0)*1;{let _=0;return h==null||h.forEach(S=>{const o=parseFloat(S.request_price||0);_+=o}),_}},C=_=>S=>{const o=parseFloat(S.target.value)||0;t.request_value==="unlimited"?_.onChange(S):t.request_value==="up to max value"?o<=t.subtotal?_.onChange(S):alert(`Value cannot exceed the subtotal of IDR ${t.subtotal}`):t.request_value==="fixed value"&&alert("This value is fixed and cannot be changed.")};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{width:220,style:{verticalAlign:"middle"},className:"text-sm",children:t.name}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="total"?e.jsx("span",{className:"text-sm",children:"IDR"}):e.jsx("span",{})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:t.type=="total"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{control:s.control,name:`destinations.${i}.allowances.${m}.detail.0.request_price`,render:({field:_})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{value:_.value,onChange:C(_)})}),e.jsx(v,{})]})}),e.jsx("span",{className:"text-sm",children:"* 100%"})]}):e.jsxs("span",{className:"text-sm",children:[" ",t.detail.length," Days * ",t.subtotal," * 100%"]})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm",style:{padding:"2px 5px"},children:["= IDR ",y()]})})}),t.type=="total"?e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}):e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},onClick:()=>u(),children:e.jsxs(Q,{variant:"ghost",type:"button",size:"sm",className:"w-9 p-0",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})]},t.id),w&&e.jsx(e.Fragment,{children:t.detail.map((_,S)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"text-end",style:{verticalAlign:"middle"},children:[e.jsx("span",{className:"text-sm",children:N(_.date).format("DD/MM/YYYY")})," "]}),e.jsx("td",{style:{padding:"8px 2px",verticalAlign:"middle"},children:":"}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("span",{className:"text-sm",children:"IDR"})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"},children:e.jsx("div",{className:"flex mt-1 text-sm justify-between items-center",children:e.jsx(g,{control:s.control,name:`destinations.${i}.allowances.${m}.detail.${S}.request_price`,render:({field:o})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{value:o.value,onChange:C(o)})}),e.jsx(v,{})]})})})}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}}),e.jsx("td",{style:{verticalAlign:"middle",padding:"2px 5px"}})]},_.id))})]})}function gt({form:s,type:t,allowanceIndex:i,destinationIndex:m}){const{fields:w}=X({control:s.control,name:`destinations.${m}.allowances.${i}.detail`});return e.jsx(e.Fragment,{children:w.map((x,u)=>e.jsx(g,{control:s.control,name:`destinations.${m}.allowances.${u}.detail.${u}.request_price`,render:({field:n})=>e.jsxs(f,{children:[e.jsx(b,{children:e.jsx(T,{value:n.value,onChange:n.onChange})}),e.jsx(v,{})]})}))})}export{gt as AllowanceInputForm,Ye as AllowanceRowInput,Se as BussinesTripDestination,De as BussinessDestinationForm,_t as BussinessTripFormV1,Ae as DetailAllowance,Te as DetailAttedances,$e as ResultPerItem,Ne as ResultTotalItem};
